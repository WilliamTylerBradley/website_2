<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>William Tyler Bradley</title>
<link>https://www.williamtylerbradley.com/</link>
<atom:link href="https://www.williamtylerbradley.com/index.xml" rel="self" type="application/rss+xml"/>
<description>Website for W T Bradley</description>
<generator>quarto-1.6.32</generator>
<lastBuildDate>Sun, 01 Feb 2026 05:00:00 GMT</lastBuildDate>
<item>
  <title>Genuary 2026</title>
  <link>https://www.williamtylerbradley.com/posts/2026-02-01-genuary-2026/</link>
  <description><![CDATA[ 





<p>I participated in <a href="https://genuary.art/">Genuary</a> 2026 this year. I went with one prompt a week and kept the files <a href="https://github.com/WilliamTylerBradley/genuary2026">here</a>. I also focused on using SVGs for this run and kept all of them 100x100.</p>
<br>
<hr>
<center>
<h2 class="anchored">
JAN. 1: One color, one shape
</h2>
</center>
<hr>
<p>I used an arrow that followed the gradient from OpenSimplex noise. I created a base shape, copied it on to a hexagonal grid, then used transformations to rotate them.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2026-02-01-genuary-2026/Jan_01.svg" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Jan_01</figcaption>
</figure>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
JAN. 10: Polar coordinates
</h2>
</center>
<hr>
<p>This is a random walk through polar coordinates. The arc length is consistent so the change in theta is different based on the radius.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2026-02-01-genuary-2026/Jan_10.svg" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Jan_10</figcaption>
</figure>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
JAN. 17: Wallpaper group
</h2>
</center>
<hr>
<p>This is based on a herringbone pattern for group pg. The colors are based on RGB and modulo on row number.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2026-02-01-genuary-2026/Jan_17.svg" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Jan_17</figcaption>
</figure>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
JAN. 27: Lifeform. A shape or structure that behaves as if it’s alive or growing.
</h2>
</center>
<hr>
<p>Based on vegetation. This work uses cubic curves.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2026-02-01-genuary-2026/Jan_27.svg" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Jan_27</figcaption>
</figure>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
JAN. 29: Genetic evolution and mutation.
</h2>
</center>
<hr>
<p>This has three polygons that grow until one reaches the outer boundary. This is my least favorite out of all of them.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2026-02-01-genuary-2026/Jan_29.svg" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>Jan_29</figcaption>
</figure>
</div>



 ]]></description>
  <category>Python</category>
  <guid>https://www.williamtylerbradley.com/posts/2026-02-01-genuary-2026/</guid>
  <pubDate>Sun, 01 Feb 2026 05:00:00 GMT</pubDate>
  <media:content url="https://www.williamtylerbradley.com/posts/2026-02-01-genuary-2026/Jan_01.svg" medium="image" type="image/svg+xml"/>
</item>
<item>
  <title>Country Maps</title>
  <link>https://www.williamtylerbradley.com/posts/2025-10-18-country-maps/</link>
  <description><![CDATA[ 





<p>This post makes a set of flashcards for countries. I chose an <a href="https://en.wikipedia.org/wiki/Orthographic_map_projection">othrographic projection</a> so that the location and sizes would be right.</p>
<hr>
<center>
<h2 class="anchored">
Imports
</h2>
</center>
<hr>
<p><code>geopandas</code> is the main package for working with this geography data. It’s basically a <code>pandas</code> dataframe with an additional <code>geometry</code> column for plotting. I tried doing everything with only <code>geopandas</code> and <code>matplotlib</code>, but the plots would end up with odd artifacts. Using the <code>cartopy</code> package for plotting fixed them.</p>
<div id="57ab53d9" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> cartopy</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> cartopy.crs <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> ccrs</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> geopandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> gpd</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-5"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> mpl_toolkits.axes_grid1 <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> inset_locator</span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> pandas <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pd</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> shapely.geometry <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> box, Point</span></code></pre></div>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
Set up the data
</h2>
</center>
<hr>
<p>The data is saved from <a href="www.naturalearthdata.com">Natural Earth</a>. There are a lot of choices to make here. I wanted to use the <a href="https://en.wikipedia.org/wiki/ISO_3166-1">ISO 3166-1</a>, but there are a few extras I added, like Kosovo. Some countries span a large area that can’t be graphed well because of the size, like France with Clipperton Island. For those cases, I drop any very small locations. For naming, if it was a group, like the United Kingdom, I wanted to use the group name, <code>ADMIN</code>, else the <code>NAME_LONG</code> tended to provide better text. Lastly, all the geometries were combined together.</p>
<div id="2e6bdf4c" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Load the world map from geopandas's built-in dataset</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://www.naturalearthdata.com/downloads/110m-cultural-vectors/110m-admin-0-countries/</span></span>
<span id="cb2-3">world <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gpd.read_file(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ne_10m_admin_0_map_units.zip"</span>, encoding<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'utf-8'</span>)</span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Save all data for easier manual checking</span></span>
<span id="cb2-6">world_save <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame(world.drop(columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'geometry'</span>))</span>
<span id="cb2-7">world_save.to_csv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'world.csv'</span>, index<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>)</span>
<span id="cb2-8"></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fix some missing 'ISO_A3_EH'</span></span>
<span id="cb2-10">world.loc[(world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ISO_A3_EH'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-99'</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> (world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'TYPE'</span>].isin([<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Disputed'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Geo unit'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Sovereign country'</span>])), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ISO_A3_EH'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> world.loc[(world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ISO_A3_EH'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-99'</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> (world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'TYPE'</span>].isin([<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Disputed'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Geo unit'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Sovereign country'</span>])), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'GU_A3'</span>]</span>
<span id="cb2-11">world <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> world[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ADMIN'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'NAME_LONG'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ISO_A3_EH'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'geometry'</span>]]</span>
<span id="cb2-12"></span>
<span id="cb2-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># drop out very small dependencies, like clipperton island</span></span>
<span id="cb2-14">world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'area'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> world.area</span>
<span id="cb2-15">world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'area_percent'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'area'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> world.groupby(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ISO_A3_EH'</span>)[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'area'</span>].transform(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sum'</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span></span>
<span id="cb2-16">world <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> world.loc[world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'area_percent'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>]</span>
<span id="cb2-17"></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># use NAME_LONG for the name</span></span>
<span id="cb2-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># unless there's more than one row, then use ADMIN</span></span>
<span id="cb2-20">world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ISO_COUNT'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> world.groupby(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ISO_A3_EH'</span>)[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ISO_A3_EH'</span>].transform(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'size'</span>)</span>
<span id="cb2-21">world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'NAME'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'NAME_LONG'</span>]</span>
<span id="cb2-22">world.loc[world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ISO_COUNT'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'NAME'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> world.loc[world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ISO_COUNT'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ADMIN'</span>]</span>
<span id="cb2-23"></span>
<span id="cb2-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fix Falkland Islands / Malvinas for use as a file name</span></span>
<span id="cb2-25">world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'NAME'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'NAME'</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>.replace(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'/'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-'</span>)</span>
<span id="cb2-26"></span>
<span id="cb2-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># combine geometries together</span></span>
<span id="cb2-28">world <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> world.dissolve(by<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ISO_A3_EH'</span>).reset_index()</span>
<span id="cb2-29"></span>
<span id="cb2-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Save information for a file</span></span>
<span id="cb2-31">country_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span></code></pre></div>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
The Main Loop Part 1
</h2>
</center>
<hr>
<p>For each country, I needed to find a lat/long point to set the orthographic projection. This should be the center of the country. I first use a point on the bounding box to get close and estimate the <a href="https://en.wikipedia.org/wiki/Universal_Transverse_Mercator_coordinate_system">UTM</a> crs from there. Averaging the points on the bounding box or using <code>centroid</code> will fail on counties like Kiribati because it cross the International Date Line. An average of the bounding box wraps back around to the Atlantic Ocean instead of the center of the country in the Pacific Ocean. Therefore the multistep process of using UTM then <code>centroid</code> has to be done, instead of using <code>centroid</code> from the start. Also, Antarctica fails for estimating the UTM crs, so it is handled separately. Then after setting that point, the centroid of the country can be found and the projections can be set from there. Finally, some stats used for determining mapping options are saved.</p>
<div id="e1da6663" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> country_a3 <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ISO_A3_EH'</span>]:</span>
<span id="cb3-2">    country_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> world.loc[world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ISO_A3_EH'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> country_a3][<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'NAME'</span>].item()</span>
<span id="cb3-3">    <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>country_a3<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>country_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb3-4"></span>
<span id="cb3-5">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Skip over additional areas</span></span>
<span id="cb3-6">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> country_a3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'-99'</span>:</span>
<span id="cb3-7">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">continue</span></span>
<span id="cb3-8"></span>
<span id="cb3-9">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Antartica fails on estimate_utm_crs()</span></span>
<span id="cb3-10">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> country_a3 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ATA'</span>:</span>
<span id="cb3-11">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Find a starting point</span></span>
<span id="cb3-12">        location_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame({</span>
<span id="cb3-13">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'location'</span>: [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>],</span>
<span id="cb3-14">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>: <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb3-15">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>: <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span></span>
<span id="cb3-16">        })</span>
<span id="cb3-17">        geometry <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Point(xy) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> xy <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(location_data.x, location_data.y)]</span>
<span id="cb3-18">        location_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gpd.GeoDataFrame(location_data,</span>
<span id="cb3-19">                                         geometry<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>geometry,</span>
<span id="cb3-20">                                         crs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'EPSG:4326'</span>)</span>
<span id="cb3-21"></span>
<span id="cb3-22">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Now convert to ortho based on the correct point</span></span>
<span id="cb3-23">        crs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ccrs.Orthographic(central_latitude<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>,</span>
<span id="cb3-24">                                central_longitude<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb3-25">        crs_proj4 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> crs.proj4_init</span>
<span id="cb3-26"></span>
<span id="cb3-27">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb3-28">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Find a point to base everything on</span></span>
<span id="cb3-29">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Kiribati shows it needs to be bounds becase it crosses over the edge</span></span>
<span id="cb3-30">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># so using a centeroid fails because it averages out to the Atlantic</span></span>
<span id="cb3-31">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># instead of the pacific</span></span>
<span id="cb3-32">        country <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> world[world[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ISO_A3_EH'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> country_a3]</span>
<span id="cb3-33">        xmin, ymin, xmax, ymax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> country[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"geometry"</span>].total_bounds</span>
<span id="cb3-34">        location_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame({</span>
<span id="cb3-35">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'location'</span>: [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>],</span>
<span id="cb3-36">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>: [xmin],</span>
<span id="cb3-37">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>: [ymin]</span>
<span id="cb3-38">        })</span>
<span id="cb3-39">        geometry <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Point(xy) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> xy <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(location_data.x, location_data.y)]</span>
<span id="cb3-40">        location_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gpd.GeoDataFrame(location_data,</span>
<span id="cb3-41">                                         geometry<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>geometry,</span>
<span id="cb3-42">                                         crs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>country.crs)</span>
<span id="cb3-43"></span>
<span id="cb3-44">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert country data to a crs that works around here</span></span>
<span id="cb3-45">        country <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> country.to_crs(location_data.estimate_utm_crs(datum_name<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'WGS 84'</span>))</span>
<span id="cb3-46"></span>
<span id="cb3-47">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Now need to convert center to usable form</span></span>
<span id="cb3-48">        location_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame({</span>
<span id="cb3-49">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'location'</span>: [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'center'</span>],</span>
<span id="cb3-50">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>: [country.centroid.x],</span>
<span id="cb3-51">            <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>: [country.centroid.y]</span>
<span id="cb3-52">        })</span>
<span id="cb3-53">        geometry <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Point(xy) <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> xy <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(location_data.x, location_data.y)]</span>
<span id="cb3-54">        location_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gpd.GeoDataFrame(location_data,</span>
<span id="cb3-55">                                         geometry<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>geometry,</span>
<span id="cb3-56">                                         crs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>country.crs)</span>
<span id="cb3-57"></span>
<span id="cb3-58">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># now to lat long</span></span>
<span id="cb3-59">        location_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> location_data.to_crs(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'EPSG:4326'</span>)</span>
<span id="cb3-60"></span>
<span id="cb3-61">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Now convert to ortho based on the correct point</span></span>
<span id="cb3-62">        crs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> ccrs.Orthographic(central_latitude<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>location_data[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'geometry'</span>].y.item(),</span>
<span id="cb3-63">                                central_longitude<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>location_data[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'geometry'</span>].x.item())</span>
<span id="cb3-64">        crs_proj4 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> crs.proj4_init</span>
<span id="cb3-65"></span>
<span id="cb3-66">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert the world, location, and country data to the right projection</span></span>
<span id="cb3-67">    world_ortho <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> world.to_crs(crs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>crs_proj4)</span>
<span id="cb3-68">    location_data <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> location_data.to_crs(crs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>crs_proj4)</span>
<span id="cb3-69">    country <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> country.to_crs(crs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>crs_proj4)</span>
<span id="cb3-70"></span>
<span id="cb3-71">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Find some sizes to determine how to plot the data</span></span>
<span id="cb3-72">    country <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> world_ortho[world_ortho[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ISO_A3_EH'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> country_a3]</span>
<span id="cb3-73">    xmin, ymin, xmax, ymax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> country[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"geometry"</span>].total_bounds</span>
<span id="cb3-74">    country_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (xmax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> xmin)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(ymax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> ymin)</span>
<span id="cb3-75">    country_area <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> country[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'geometry'</span>].area.item()</span>
<span id="cb3-76">    country_proportion <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> country_area<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>country_size</span></code></pre></div>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
The Main Loop Part 2
</h2>
</center>
<hr>
<p>The rest of the loop plots the maps. First, some defauls are set for each plot. Backgrounds, the world map, and the individual country are plotted. Then, if the country is very small, an arrow is drawn, if the country is kind of small, an inset map is drawn, or if the country is largely water, the bounding box is drawn. These options make the map easier to understand.</p>
<div id="654db8d4" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set up some basics</span></span>
<span id="cb4-2">    bounds_increase <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1_500_000</span></span>
<span id="cb4-3">    country_color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#DC143C'</span></span>
<span id="cb4-4">    water_color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#A7C7E7'</span></span>
<span id="cb4-5">    land_color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#DEB887'</span></span>
<span id="cb4-6">    map_indicator <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span></span>
<span id="cb4-7"></span>
<span id="cb4-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This is the basic set up for all of the plots</span></span>
<span id="cb4-9">    fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(subplot_kw<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>{<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"projection"</span>: crs})</span>
<span id="cb4-10">    fig.set_size_inches(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb4-11">    fig.subplots_adjust(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb4-12"></span>
<span id="cb4-13">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Space color</span></span>
<span id="cb4-14">    fig.set_facecolor(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#3B3B3B'</span>)</span>
<span id="cb4-15"></span>
<span id="cb4-16">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Equator line</span></span>
<span id="cb4-17">    ax.gridlines(draw_labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb4-18">                 color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#636363'</span>,</span>
<span id="cb4-19">                 linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-20">                 ylocs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],</span>
<span id="cb4-21">                 xlocs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[],</span>
<span id="cb4-22">                 linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)))</span>
<span id="cb4-23"></span>
<span id="cb4-24">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># location_data buffer for the oceans</span></span>
<span id="cb4-25">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 6400000 makes a circle that works a long the edges</span></span>
<span id="cb4-26">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># used trail and error to find it</span></span>
<span id="cb4-27">    location_data[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'geometry'</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> location_data[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'geometry'</span>].<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">buffer</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6_400_000</span>)</span>
<span id="cb4-28">    ax.add_geometries(location_data[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'geometry'</span>],</span>
<span id="cb4-29">                      crs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>crs,</span>
<span id="cb4-30">                      color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>water_color)</span>
<span id="cb4-31"></span>
<span id="cb4-32">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add background world</span></span>
<span id="cb4-33">    ax.add_geometries(world_ortho[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"geometry"</span>],</span>
<span id="cb4-34">                      crs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>crs,</span>
<span id="cb4-35">                      color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>land_color,</span>
<span id="cb4-36">                      edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>,</span>
<span id="cb4-37">                      linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>)</span>
<span id="cb4-38"></span>
<span id="cb4-39">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Add country map</span></span>
<span id="cb4-40">    ax.add_geometries(country[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"geometry"</span>],</span>
<span id="cb4-41">                      crs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>crs,</span>
<span id="cb4-42">                      color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>country_color,</span>
<span id="cb4-43">                      edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>,</span>
<span id="cb4-44">                      linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>)</span>
<span id="cb4-45"></span>
<span id="cb4-46">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If the country is very small (just Vatican city), use an arrow to mark it</span></span>
<span id="cb4-47">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> country_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50_000</span>:</span>
<span id="cb4-48">        xcenter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (xmin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> xmax) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb4-49">        ycenter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (ymin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> ymax) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb4-50">        ax.annotate(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>,</span>
<span id="cb4-51">                    xy<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(xcenter, ycenter),</span>
<span id="cb4-52">                    xytext<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(xcenter, ycenter <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">450_000</span>),</span>
<span id="cb4-53">                    arrowprops<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(arrowstyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-&gt;"</span>,</span>
<span id="cb4-54">                                    connectionstyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"arc3"</span>,</span>
<span id="cb4-55">                                    color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>country_color,</span>
<span id="cb4-56">                                    linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb4-57">        map_indicator <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Arrow'</span></span>
<span id="cb4-58"></span>
<span id="cb4-59">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If the country is small, add an inset map</span></span>
<span id="cb4-60">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> (country_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">22_500_000_000</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">or</span> (country_size <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50_000_000_000</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> country_proportion <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.01</span>):</span>
<span id="cb4-61">        iax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> inset_locator.inset_axes(ax,</span>
<span id="cb4-62">                                       width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb4-63">                                       height<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>,</span>
<span id="cb4-64">                                       loc<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"upper right"</span>,</span>
<span id="cb4-65">                                       borderpad<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-66">                                       axes_class<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cartopy.mpl.geoaxes.GeoAxes,</span>
<span id="cb4-67">                                       axes_kwargs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(xticks<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[],</span>
<span id="cb4-68">                                                        yticks<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[],</span>
<span id="cb4-69">                                                        projection<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>crs))</span>
<span id="cb4-70">        iax.gridlines(draw_labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span>,</span>
<span id="cb4-71">                      color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'#636363'</span>,</span>
<span id="cb4-72">                      linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>,</span>
<span id="cb4-73">                      ylocs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],</span>
<span id="cb4-74">                      xlocs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[],</span>
<span id="cb4-75">                      linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)))</span>
<span id="cb4-76">        iax.add_geometries(location_data[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'geometry'</span>],</span>
<span id="cb4-77">                           crs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>crs,</span>
<span id="cb4-78">                           color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>water_color)</span>
<span id="cb4-79">        iax.add_geometries(world_ortho[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"geometry"</span>],</span>
<span id="cb4-80">                           crs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>crs,</span>
<span id="cb4-81">                           color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>land_color,</span>
<span id="cb4-82">                           edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>,</span>
<span id="cb4-83">                           linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>)</span>
<span id="cb4-84">        iax.add_geometries(country[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"geometry"</span>],</span>
<span id="cb4-85">                           crs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>crs,</span>
<span id="cb4-86">                           color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>country_color,</span>
<span id="cb4-87">                           edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>,</span>
<span id="cb4-88">                           linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.25</span>)</span>
<span id="cb4-89"></span>
<span id="cb4-90">        bounds_increase <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">55000</span></span>
<span id="cb4-91">        iax.axis([xmin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> bounds_increase,</span>
<span id="cb4-92">                  xmax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> bounds_increase,</span>
<span id="cb4-93">                  ymin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> bounds_increase,</span>
<span id="cb4-94">                  ymax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> bounds_increase])</span>
<span id="cb4-95">        x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [xmin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> bounds_increase,</span>
<span id="cb4-96">             xmax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> bounds_increase,</span>
<span id="cb4-97">             xmax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> bounds_increase,</span>
<span id="cb4-98">             xmin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> bounds_increase,</span>
<span id="cb4-99">             xmin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> bounds_increase]</span>
<span id="cb4-100">        y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [ymin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> bounds_increase,</span>
<span id="cb4-101">             ymin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> bounds_increase,</span>
<span id="cb4-102">             ymax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> bounds_increase,</span>
<span id="cb4-103">             ymax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> bounds_increase,</span>
<span id="cb4-104">             ymin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> bounds_increase]</span>
<span id="cb4-105">        ax.plot(x, y, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'k'</span>, alpha<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>, transform<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>crs)</span>
<span id="cb4-106">        _ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> inset_locator.mark_inset(ax, iax,</span>
<span id="cb4-107">                                     loc1<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, loc2<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>,</span>
<span id="cb4-108">                                     linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb4-109">        map_indicator <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Inset'</span></span>
<span id="cb4-110"></span>
<span id="cb4-111">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Reset bounds_increase for final map</span></span>
<span id="cb4-112">        bounds_increase <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1500000</span></span>
<span id="cb4-113"></span>
<span id="cb4-114">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If the country is mostly ocean, add a bounding box</span></span>
<span id="cb4-115">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> country_proportion <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.01</span>:</span>
<span id="cb4-116">        bounding_box <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> box(xmin, ymin, xmax, ymax)</span>
<span id="cb4-117">        bounding_box_gs <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> gpd.GeoSeries(bounding_box)</span>
<span id="cb4-118"></span>
<span id="cb4-119">        ax.add_geometries(bounding_box_gs,</span>
<span id="cb4-120">                          crs<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>crs,</span>
<span id="cb4-121">                          facecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span>,</span>
<span id="cb4-122">                          edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>country_color,</span>
<span id="cb4-123">                          linewidth<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.5</span>)</span>
<span id="cb4-124">        map_indicator <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Box'</span></span>
<span id="cb4-125"></span>
<span id="cb4-126">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Finish out the plot and save it</span></span>
<span id="cb4-127">    ax.axis(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"equal"</span>)</span>
<span id="cb4-128">    ax.axis([xmin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> bounds_increase,</span>
<span id="cb4-129">             xmax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> bounds_increase,</span>
<span id="cb4-130">             ymin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> bounds_increase,</span>
<span id="cb4-131">             ymax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> bounds_increase])</span>
<span id="cb4-132">    plt.savefig(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'plots/</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>country_name<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">.png'</span>)</span>
<span id="cb4-133">    plt.close(fig)</span>
<span id="cb4-134"></span>
<span id="cb4-135">    country_data[country_a3] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [country_name,</span>
<span id="cb4-136">                            country_size,</span>
<span id="cb4-137">                            country_area,</span>
<span id="cb4-138">                            country_proportion,</span>
<span id="cb4-139">                            map_indicator]</span></code></pre></div>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
Saving Some Data
</h2>
</center>
<hr>
<p>Throughout this code, some data has been collected. At the end it’s saved to a csv used to manually determine cutoffs for mapping options.</p>
<div id="47d01b23" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Save country data</span></span>
<span id="cb5-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># useful to determine cutoffs in the code above</span></span>
<span id="cb5-3">country_df <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pd.DataFrame.from_dict(country_data, orient<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'index'</span>,</span>
<span id="cb5-4">                                    columns<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Name'</span>,</span>
<span id="cb5-5">                                             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Size'</span>,</span>
<span id="cb5-6">                                             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Area'</span>,</span>
<span id="cb5-7">                                             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Proportion'</span>,</span>
<span id="cb5-8">                                             <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Indictor'</span>])</span>
<span id="cb5-9"></span>
<span id="cb5-10">country_df.to_csv(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'country_data.csv'</span>, index_label<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'ISO'</span>)</span></code></pre></div>
</div>
<p>Here are some of the plots. The code and the rest of the outputs can be found at the <a href="https://github.com/WilliamTylerBradley/country_maps">GitHub repo</a>. These can be added to an Anki deck using the <a href="https://ankiweb.net/shared/info/129299120">Media Import 2 add-on</a>.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2025-10-18-country-maps/Algeria.png" class="img-fluid figure-img"></p>
<figcaption>Algeria</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2025-10-18-country-maps/Andorra.png" class="img-fluid figure-img"></p>
<figcaption>Andorra (shows inset map)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2025-10-18-country-maps/Antarctica.png" class="img-fluid figure-img"></p>
<figcaption>Antarctica</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2025-10-18-country-maps/Barbados.png" class="img-fluid figure-img"></p>
<figcaption>Barbados</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2025-10-18-country-maps/Chile.png" class="img-fluid figure-img"></p>
<figcaption>Chile (shows background)</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2025-10-18-country-maps/Cook Islands.png" class="img-fluid figure-img"></p>
<figcaption>Cook Islands (shows box)</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2025-10-18-country-maps/Vatican.png" class="img-fluid figure-img"></p>
<figcaption>Vatican (shows arrow)</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2025-10-18-country-maps/United States.png" class="img-fluid figure-img"></p>
<figcaption>United States</figcaption>
</figure>
</div>
</div>
</div>
</div>



 ]]></description>
  <category>Python</category>
  <guid>https://www.williamtylerbradley.com/posts/2025-10-18-country-maps/</guid>
  <pubDate>Sat, 18 Oct 2025 04:00:00 GMT</pubDate>
  <media:content url="https://www.williamtylerbradley.com/posts/2025-10-18-country-maps/Algeria.png" medium="image" type="image/png" height="108" width="144"/>
</item>
<item>
  <title>Grid Tilings</title>
  <link>https://www.williamtylerbradley.com/posts/2025-09-03-grid-tilings/</link>
  <description><![CDATA[ 





<hr>
<center>
<h2 class="anchored">
Introduction
</h2>
</center>
<hr>
<p>I created a Python package for creating tiling patterns using the multigrid method. This post walks through the code, which can be found at this <a href="https://github.com/WilliamTylerBradley/grid_tilings/tree/main">GitHub repository</a>.</p>
<p>The multigrid method takes several grids of lines and use a repeated formula at each intersection to create a shape. Each line has a number; it’s <strong>k-value</strong>. These are the inputs to the formula. A different input to the formula is used for each division of an intersection because the <strong>k-value</strong> changes as the division crosses a line. So, two lines intersecting will have four inputs while three lines will have six. The output of one formula determine a point’s location. The points together form one tile. Then, all the tiles together create the final image.</p>
<p>It’s important to realize there are two sets of coordinates. One set for the grids and their lines. Another set for the tiles and their points. These two coordinates do not line up. So an image of the lines laid on top of the tiles won’t look right.</p>
<p>The following resources were incredibly helpful.</p>
<ul>
<li><p><a href="https://aatishb.com/patterncollider/"><em>Pattern Collider</em> by Aatish Bhatia and Henry Reich</a></p></li>
<li><p><a href="https://web.williams.edu/Mathematics/sjmiller/public_html/hudson/HRUMC-Mowry&amp;Shukla_Pentagrids%20and%20Penrose.pdf"><em>Pentagrids and Penrose Tilings</em> by Stacy Mowry and Shriya Shukla</a></p></li>
<li><p><a href="http://www.math.utah.edu/~treiberg/PenroseSlides.pdf"><em>Penrose Tiling</em> by Andrejs Treibergs</a></p></li>
<li><p><a href="https://math.stackexchange.com/questions/3465244/properly-drawing-a-penrose-tiling-using-the-pentagrid-method">Properly drawing a Penrose tiling using the pentagrid method</a></p></li>
</ul>
<p>I recommend reading through them to get an idea of how the setup works.</p>
<p>The code mostly flows in a nice order. So I’m going to go straight through <code>grid_tilings.py</code>.</p>
<br>
<hr>
<center>
<h2 class="anchored">
Imports
</h2>
</center>
<hr>
<p>The imports show two sets: one to build the classes and the other for plotting.</p>
<div id="f673013d" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> collections <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> defaultdict, namedtuple, deque</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> itertools <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> combinations</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> math <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> isclose</span>
<span id="cb1-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> uuid</span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> mpl</span>
<span id="cb1-7"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb1-8"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> matplotlib.collections <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> LineCollection</span>
<span id="cb1-9"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> matplotlib.collections <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> PolyCollection</span>
<span id="cb1-10"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">from</span> matplotlib.patches <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> Polygon</span>
<span id="cb1-11"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span></code></pre></div>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
Point Class
</h2>
</center>
<hr>
<p>The ‘Point’ class contains the basic information for a point used for a tile. It takes in the <strong>k-values</strong>, determines the coordinates in the tiling space, and saves everything. These will be saved in a dictionary for use when graphing.</p>
<div id="087cdb8d" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> Point:</span>
<span id="cb2-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Point class containing location information.</span></span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Attributes:</span></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        k_values: Tuple of k value uniquely identifying a point</span></span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        base_location: np.array() location in the tiling space</span></span>
<span id="cb2-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        centered_location: np.array() location in the tiling space that</span></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            has been moved so the base_point is at (0, 0)</span></span>
<span id="cb2-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb2-11"></span>
<span id="cb2-12">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, k_values, cos_list, sin_list, mid_point):</span>
<span id="cb2-13">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb2-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Constructor for a Point.</span></span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Args:</span></span>
<span id="cb2-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            k_values: Tuple of k value uniquely identifying a point</span></span>
<span id="cb2-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            cos_list: cosine values of the Multigrid</span></span>
<span id="cb2-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            sin_list: sin values of the Multigrid</span></span>
<span id="cb2-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            mid_point: center of the tilings</span></span>
<span id="cb2-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb2-22"></span>
<span id="cb2-23">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.k_values <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> k_values</span>
<span id="cb2-24"></span>
<span id="cb2-25">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Convert k_values in the Multigrid space to a point in the</span></span>
<span id="cb2-26">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   tiling space</span></span>
<span id="cb2-27">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.base_location <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>)</span>
<span id="cb2-28">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k, c, s <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(k_values, cos_list, sin_list):</span>
<span id="cb2-29">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.base_location <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.array([c, s])</span>
<span id="cb2-30"></span>
<span id="cb2-31">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.centered_location <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.base_location <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> mid_point</span>
<span id="cb2-32"></span>
<span id="cb2-33">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__str__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb2-34">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>k_values<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span></code></pre></div>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
Line Class
</h2>
</center>
<hr>
<p>The ‘Line’ class stores information for each line. The grids will be made up of these lines. This class uses the standard form of a line to allow both vertical and horizontal lines. There is a function to determine the intersection between itself and another line. There’s another function to draw the line, which is helpful when debugging. Finally, there’s an exception class for if two lines are equivalent. This can happen when two different grids end up overlapping exactly. For example, one grid going straight up and another going straight down with one unit difference. In these situations, the logic for determining the points will fail. So, it needs to be stopped by the exception.</p>
<div id="574be918" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> Line:</span>
<span id="cb3-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Line class used to build up a Multigrid.</span></span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Follows the standard form a line.</span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    a*x + b*y = c</span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    This allows for both vertical and horizontal lines.</span></span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Attributes:</span></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        a: x value</span></span>
<span id="cb3-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        b: y value</span></span>
<span id="cb3-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        c: constant value, created by adding offset and k value</span></span>
<span id="cb3-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        k: k value (optional)</span></span>
<span id="cb3-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        grid: grid number (optional)</span></span>
<span id="cb3-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        angles: angles of the x-axis</span></span>
<span id="cb3-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb3-17"></span>
<span id="cb3-18">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, a, b, o, k<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, grid<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>):</span>
<span id="cb3-19">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb3-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Constructor for Line.</span></span>
<span id="cb3-21"></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Arg:</span></span>
<span id="cb3-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            a: x value</span></span>
<span id="cb3-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            b: y value</span></span>
<span id="cb3-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            c: constant value, created by adding offset and k value</span></span>
<span id="cb3-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            o: k value (optional)</span></span>
<span id="cb3-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            grid: grid number (optional)</span></span>
<span id="cb3-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb3-29"></span>
<span id="cb3-30">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a</span>
<span id="cb3-31">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> b</span>
<span id="cb3-32">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> o <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> k</span>
<span id="cb3-33">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.offset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> o</span>
<span id="cb3-34">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> k</span>
<span id="cb3-35">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> grid</span>
<span id="cb3-36"></span>
<span id="cb3-37">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Determine the angle off horizontal</span></span>
<span id="cb3-38">        first_angle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arctan2(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>a, b)</span>
<span id="cb3-39">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> first_angle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb3-40">            second_angle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> first_angle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> np.pi</span>
<span id="cb3-41">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb3-42">            second_angle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> first_angle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> np.pi</span>
<span id="cb3-43"></span>
<span id="cb3-44">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># crossing counter-clockwise</span></span>
<span id="cb3-45">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># first angle is always k + 1</span></span>
<span id="cb3-46">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># second is alway k by construction</span></span>
<span id="cb3-47">        Angle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> namedtuple(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'Angle'</span>, [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'value'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'k'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'grid'</span>])</span>
<span id="cb3-48">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.angles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Angle(first_angle, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, grid),</span>
<span id="cb3-49">                       Angle(second_angle, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.k, grid)]</span>
<span id="cb3-50"></span>
<span id="cb3-51">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__str__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb3-52">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> (<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'a=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>a<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, b=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>b<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, offset=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>offset<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, '</span></span>
<span id="cb3-53">                <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'k=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>k<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, grid=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>grid<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb3-54"></span>
<span id="cb3-55">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> determine_intersection(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, other_line, decimals<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>):</span>
<span id="cb3-56">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb3-57"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Finds the intersection between this Line and another one.</span></span>
<span id="cb3-58"></span>
<span id="cb3-59"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Args:</span></span>
<span id="cb3-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            other_line: different Line</span></span>
<span id="cb3-61"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            decimals: controls the rounding for comparisons</span></span>
<span id="cb3-62"></span>
<span id="cb3-63"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Returns:</span></span>
<span id="cb3-64"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            Tuple containing the intersection or None if parallel</span></span>
<span id="cb3-65"></span>
<span id="cb3-66"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Raises:</span></span>
<span id="cb3-67"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            OverlappingLines: if the Lines are the same</span></span>
<span id="cb3-68"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb3-69"></span>
<span id="cb3-70">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># denominator for formula for the intersection</span></span>
<span id="cb3-71">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># if this is zero then the lines are parallel or overlap</span></span>
<span id="cb3-72">        denom <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> other_line.b) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (other_line.a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.b)</span>
<span id="cb3-73">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> isclose(denom, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, rel_tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-5</span>, abs_tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-05</span>):</span>
<span id="cb3-74"></span>
<span id="cb3-75">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Determine if it's the same line by calculating if all the</span></span>
<span id="cb3-76">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   coefficients have the same proportion between the two</span></span>
<span id="cb3-77">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   lines</span></span>
<span id="cb3-78">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> isclose(other_line.a, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, rel_tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-5</span>, abs_tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-05</span>):</span>
<span id="cb3-79">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> isclose(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.a, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, rel_tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-5</span>, abs_tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-05</span>):</span>
<span id="cb3-80">                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Different lines</span></span>
<span id="cb3-81">                    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb3-82">                a_proportion <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb3-83">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb3-84">                a_proportion <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> other_line.a</span>
<span id="cb3-85"></span>
<span id="cb3-86">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> isclose(other_line.b, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, rel_tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-5</span>, abs_tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-05</span>):</span>
<span id="cb3-87">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> isclose(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.b, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, rel_tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-5</span>, abs_tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-05</span>):</span>
<span id="cb3-88">                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Different lines</span></span>
<span id="cb3-89">                    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb3-90">                b_proportion <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb3-91">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb3-92">                b_proportion <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> other_line.b</span>
<span id="cb3-93"></span>
<span id="cb3-94">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> a_proportion <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> b_proportion:</span>
<span id="cb3-95">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> isclose(a_proportion, b_proportion):</span>
<span id="cb3-96">                    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb3-97"></span>
<span id="cb3-98">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> isclose(other_line.c, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, rel_tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-5</span>, abs_tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-05</span>):</span>
<span id="cb3-99">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> isclose(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.c, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, rel_tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-5</span>, abs_tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-05</span>):</span>
<span id="cb3-100">                    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Different lines</span></span>
<span id="cb3-101">                    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb3-102">                c_proportion <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb3-103">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb3-104">                c_proportion <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> other_line.c</span>
<span id="cb3-105"></span>
<span id="cb3-106">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> a_proportion <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> c_proportion:</span>
<span id="cb3-107">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> isclose(a_proportion, c_proportion,</span>
<span id="cb3-108">                               rel_tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-5</span>, abs_tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-05</span>):</span>
<span id="cb3-109">                    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb3-110"></span>
<span id="cb3-111">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> b_proportion <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> c_proportion:</span>
<span id="cb3-112">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> isclose(b_proportion, c_proportion,</span>
<span id="cb3-113">                               rel_tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-5</span>, abs_tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-05</span>):</span>
<span id="cb3-114">                    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span></span>
<span id="cb3-115"></span>
<span id="cb3-116">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">raise</span> OverlappingLines(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, other_line)</span>
<span id="cb3-117">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb3-118">            x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (other_line.b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.c) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> other_line.c)</span>
<span id="cb3-119">            x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> denom</span>
<span id="cb3-120"></span>
<span id="cb3-121">            y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> other_line.c) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (other_line.a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.c)</span>
<span id="cb3-122">            y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> denom</span>
<span id="cb3-123"></span>
<span id="cb3-124">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> (np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">round</span>(x, decimals), np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">round</span>(y, decimals))</span>
<span id="cb3-125"></span>
<span id="cb3-126">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> draw_line(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, ax):</span>
<span id="cb3-127">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb3-128"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Draws the line.</span></span>
<span id="cb3-129"></span>
<span id="cb3-130"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Example:</span></span>
<span id="cb3-131"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            l = Line(1, 1, 0)</span></span>
<span id="cb3-132"></span>
<span id="cb3-133"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            fig, ax = plt.subplots()</span></span>
<span id="cb3-134"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            l.draw_line(ax)</span></span>
<span id="cb3-135"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            plt.show()</span></span>
<span id="cb3-136"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb3-137"></span>
<span id="cb3-138">        graph_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb3-139"></span>
<span id="cb3-140">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Crosses x-axis</span></span>
<span id="cb3-141">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb3-142">            graph_points.append((<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, (<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.b))</span>
<span id="cb3-143">            graph_points.append((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.b))</span>
<span id="cb3-144">            graph_points.append((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, (<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.a<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.b))</span>
<span id="cb3-145"></span>
<span id="cb3-146">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Crosses y-axis</span></span>
<span id="cb3-147">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb3-148">            graph_points.append(((<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.a, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))</span>
<span id="cb3-149">            graph_points.append((<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.c<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.a, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>))</span>
<span id="cb3-150">            graph_points.append(((<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.b<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.a, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))</span>
<span id="cb3-151"></span>
<span id="cb3-152">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Build out boundary</span></span>
<span id="cb3-153">        min_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.inf</span>
<span id="cb3-154">        max_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>np.inf</span>
<span id="cb3-155">        min_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.inf</span>
<span id="cb3-156">        max_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>np.inf</span>
<span id="cb3-157"></span>
<span id="cb3-158">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> graph_points:</span>
<span id="cb3-159">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> i[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> min_x:</span>
<span id="cb3-160">                min_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> i[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb3-161">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> i[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> max_x:</span>
<span id="cb3-162">                max_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> i[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb3-163">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> i[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> min_y:</span>
<span id="cb3-164">                min_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> i[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb3-165">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> i[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> max_y:</span>
<span id="cb3-166">                max_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> i[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb3-167"></span>
<span id="cb3-168">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If the line is horizontal or vertical, set boundary to 5.</span></span>
<span id="cb3-169">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> min_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> max_x:</span>
<span id="cb3-170">            min_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> min_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb3-171">            max_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> max_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb3-172">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> min_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> max_y:</span>
<span id="cb3-173">            min_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> min_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb3-174">            max_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> max_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb3-175"></span>
<span id="cb3-176">        ax.axhline(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gray'</span>, linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--"</span>)</span>
<span id="cb3-177">        ax.axvline(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, color<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'gray'</span>, linestyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"--"</span>)</span>
<span id="cb3-178">        ax.add_collection(LineCollection([graph_points]))</span>
<span id="cb3-179">        ax.set_xlim(min_x, max_x)</span>
<span id="cb3-180">        ax.set_ylim(min_y, max_y)</span>
<span id="cb3-181">        ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>)</span>
<span id="cb3-182">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> ax</span>
<span id="cb3-183"></span>
<span id="cb3-184"></span>
<span id="cb3-185"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> OverlappingLines(<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">Exception</span>):</span>
<span id="cb3-186">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Exception for lines that are the same."""</span></span>
<span id="cb3-187">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, line_1, line_2,</span>
<span id="cb3-188">                 msg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"These two lines are the same line."</span>):</span>
<span id="cb3-189">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.line_1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> line_1</span>
<span id="cb3-190">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.line_2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> line_2</span>
<span id="cb3-191">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.msg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> msg</span>
<span id="cb3-192">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>().<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.msg)</span>
<span id="cb3-193"></span>
<span id="cb3-194">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__str__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb3-195">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>msg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n\t</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>line_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n\t</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>line_2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span></code></pre></div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2025-09-03-grid-tilings/line_graph_0_1_2.png" class="img-fluid figure-img"></p>
<figcaption>(0, 1, 2) Line</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2025-09-03-grid-tilings/line_graph_1_0_0.png" class="img-fluid figure-img"></p>
<figcaption>(1, 0, 0) Line</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2025-09-03-grid-tilings/line_graph_1_1_0.png" class="img-fluid figure-img"></p>
<figcaption>(1, 1, 0) Line</figcaption>
</figure>
</div>
</div>
</div>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
Edge Class
</h2>
</center>
<hr>
<p>The <code>Edge</code> class is used to draw the tiles and determine which tiles are neighbors. There is an exception for if an edge is used by more than two tiles. This can happen when there’s a floating point issue.</p>
<div id="c59e8010" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> Edge:</span>
<span id="cb4-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb4-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Class used for tile edges.</span></span>
<span id="cb4-4"></span>
<span id="cb4-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    This doesn't relate to the Line class at all.</span></span>
<span id="cb4-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb4-7"></span>
<span id="cb4-8">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, point_ids, tile_id):</span>
<span id="cb4-9">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb4-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Constructor for Edge.</span></span>
<span id="cb4-11"></span>
<span id="cb4-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Args:</span></span>
<span id="cb4-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            point_ids: Points for the ends of the edge</span></span>
<span id="cb4-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            tile_id: starting tile_id</span></span>
<span id="cb4-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb4-16">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> point_ids</span>
<span id="cb4-17">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tile_ids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [tile_id]</span>
<span id="cb4-18"></span>
<span id="cb4-19">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> add_tile_id(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, tile_id):</span>
<span id="cb4-20">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb4-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Adds a tile_id to the list of adjacent tiles</span></span>
<span id="cb4-22"></span>
<span id="cb4-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Raises:</span></span>
<span id="cb4-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            OverusedEdge: if there are more than two tiles</span></span>
<span id="cb4-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb4-26">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tile_ids.append(tile_id)</span>
<span id="cb4-27"></span>
<span id="cb4-28">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tile_ids) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>:</span>
<span id="cb4-29">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">raise</span> OverusedEdge(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>)</span>
<span id="cb4-30"></span>
<span id="cb4-31">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__str__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb4-32">        msg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'point_ids: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>points<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb4-33">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> t <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tile_ids:</span>
<span id="cb4-34">            msg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> msg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n\t</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>t<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb4-35">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> msg</span>
<span id="cb4-36"></span>
<span id="cb4-37"></span>
<span id="cb4-38"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> OverusedEdge(<span class="pp" style="color: #AD0000;
background-color: null;
font-style: inherit;">Exception</span>):</span>
<span id="cb4-39">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb4-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Exception for when an edge has more than two tiles one it.</span></span>
<span id="cb4-41"></span>
<span id="cb4-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Happens when the floating point fails on a point with multiple lines</span></span>
<span id="cb4-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb4-44">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, edge, msg<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This edge has more than two tiles."</span>):</span>
<span id="cb4-45">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.edge <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> edge</span>
<span id="cb4-46">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.msg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> msg</span>
<span id="cb4-47">        <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">super</span>().<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.msg)</span>
<span id="cb4-48"></span>
<span id="cb4-49">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__str__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb4-50">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>msg<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">\n\t</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span></code></pre></div>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
Tile Class
</h2>
</center>
<hr>
<p>The <code>Tile</code> class contains all the information for one shape. It takes in the points and the intersection that creates the tile. The function <code>compare_angles</code> compares itself to another tile to see if they match. This function, along with <code>tile_group</code>, is used to color all the same tiles one color. Then <code>draw_tile</code> and <code>draw_line_angles</code> draw images.</p>
<div id="59fa26fe" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> Tile:</span>
<span id="cb5-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb5-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Class used for the Tile.</span></span>
<span id="cb5-4"></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Attributes:</span></span>
<span id="cb5-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        tile_points: points around the tile</span></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        intersection_points: points for the intersection that creates</span></span>
<span id="cb5-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            the tile</span></span>
<span id="cb5-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        intersection_lines: lines from the Multigrid that intersect on</span></span>
<span id="cb5-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            the tile</span></span>
<span id="cb5-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        tile_group: group number for coloring similar tiles</span></span>
<span id="cb5-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        tile_id: unique id for each tile. Used for Edge class</span></span>
<span id="cb5-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        connected: Bool for if the tile is connected to the base_point</span></span>
<span id="cb5-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            through other tiles. Used to remove unconnected tiles.</span></span>
<span id="cb5-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        interior_angles: angles inside the tile. Used determine similar</span></span>
<span id="cb5-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            tiles and thus the tile_group.</span></span>
<span id="cb5-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb5-18">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, tile_points, intersection_points, intersection_lines):</span>
<span id="cb5-19">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb5-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Constructor for a Tile</span></span>
<span id="cb5-21"></span>
<span id="cb5-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Args:</span></span>
<span id="cb5-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            tile_points: points around the tile</span></span>
<span id="cb5-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            intersection_points: points for the intersection that</span></span>
<span id="cb5-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                creates the tile</span></span>
<span id="cb5-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            intersection_lines: lines from the Multigrid that intersect</span></span>
<span id="cb5-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                on the tile</span></span>
<span id="cb5-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb5-29">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tile_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tile_points</span>
<span id="cb5-30">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.intersection_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> intersection_points</span>
<span id="cb5-31">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.intersection_lines <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> intersection_lines</span>
<span id="cb5-32">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tile_group <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb5-33">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tile_id <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> uuid.uuid4()</span>
<span id="cb5-34">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.connected <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb5-35"></span>
<span id="cb5-36">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Determine the interior angles to compare tiles to see which</span></span>
<span id="cb5-37">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   ones have the same shape. Don't need to compare distances</span></span>
<span id="cb5-38">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   between angles because it's always 1 by construction.</span></span>
<span id="cb5-39">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.interior_angles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb5-40">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> previous_point, tile_point, next_point <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> (</span>
<span id="cb5-41">            <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>([<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tile_points[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tile_points[:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb5-42">                <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tile_points,</span>
<span id="cb5-43">                <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tile_points[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tile_points[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]])):</span>
<span id="cb5-44"></span>
<span id="cb5-45">            point_location <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tile_point.base_location</span>
<span id="cb5-46">            previous_point_location <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> previous_point.base_location</span>
<span id="cb5-47">            next_point_location <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> next_point.base_location</span>
<span id="cb5-48"></span>
<span id="cb5-49">            in_vector <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> point_location <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> previous_point_location</span>
<span id="cb5-50">            out_vector <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> next_point_location <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> point_location</span>
<span id="cb5-51">            angle <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.arctan2(in_vector[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> out_vector[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb5-52">                               <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> in_vector[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> out_vector[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],</span>
<span id="cb5-53">                               in_vector[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> out_vector[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb5-54">                               <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> in_vector[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> out_vector[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb5-55"></span>
<span id="cb5-56">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.interior_angles.append(angle)</span>
<span id="cb5-57"></span>
<span id="cb5-58">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> compare_angles(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, other_polygon):</span>
<span id="cb5-59">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb5-60"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Compare this tile to another one to see if they have the</span></span>
<span id="cb5-61"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            same shape</span></span>
<span id="cb5-62"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb5-63"></span>
<span id="cb5-64">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Do they even have the same number of angles?</span></span>
<span id="cb5-65">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.interior_angles) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(other_polygon.interior_angles):</span>
<span id="cb5-66">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb5-67"></span>
<span id="cb5-68">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Is the first angle even in the other set?</span></span>
<span id="cb5-69">        no_match <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb5-70">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> a <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.interior_angles:</span>
<span id="cb5-71">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> isclose(a, other_polygon.interior_angles[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],</span>
<span id="cb5-72">                       rel_tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-5</span>, abs_tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-05</span>):</span>
<span id="cb5-73">                no_match <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb5-74">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> no_match:</span>
<span id="cb5-75">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb5-76"></span>
<span id="cb5-77">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Do they have all the same angles in same order?</span></span>
<span id="cb5-78">        angles_repeated <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.interior_angles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.interior_angles</span>
<span id="cb5-79">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> a <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> np.arange(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.interior_angles)):</span>
<span id="cb5-80">            match <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb5-81">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> b <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> np.arange(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(other_polygon.interior_angles)):</span>
<span id="cb5-82">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> isclose(angles_repeated[a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> b],</span>
<span id="cb5-83">                               other_polygon.interior_angles[b],</span>
<span id="cb5-84">                               rel_tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-5</span>, abs_tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-05</span>):</span>
<span id="cb5-85">                    match <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb5-86">                    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">break</span></span>
<span id="cb5-87">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> match:</span>
<span id="cb5-88">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb5-89">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb5-90"></span>
<span id="cb5-91">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> draw_tile(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, ax):</span>
<span id="cb5-92">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb5-93"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Draws the tile.</span></span>
<span id="cb5-94"></span>
<span id="cb5-95"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Example:</span></span>
<span id="cb5-96"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            cos_list = [1, 0, -1, 0]</span></span>
<span id="cb5-97"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            sin_list = [0, 1, 0, -1]</span></span>
<span id="cb5-98"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            mid_point = np.array([0, 0], dtype=float)</span></span>
<span id="cb5-99"></span>
<span id="cb5-100"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            points = [Point((1.0, 0.0, 0.0, 0.0),</span></span>
<span id="cb5-101"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                            cos_list,</span></span>
<span id="cb5-102"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                            sin_list,</span></span>
<span id="cb5-103"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                            mid_point),</span></span>
<span id="cb5-104"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                    Point((1.0, 1.0, 0.0, 0.0),</span></span>
<span id="cb5-105"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                          cos_list,</span></span>
<span id="cb5-106"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                          sin_list,</span></span>
<span id="cb5-107"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                          mid_point),</span></span>
<span id="cb5-108"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                    Point((0.0, 1.0, 0.0, 0.0),</span></span>
<span id="cb5-109"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                          cos_list,</span></span>
<span id="cb5-110"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                          sin_list,</span></span>
<span id="cb5-111"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                          mid_point),</span></span>
<span id="cb5-112"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                    Point((0.0, 0.0, 0.0, 0.0),</span></span>
<span id="cb5-113"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                          cos_list,</span></span>
<span id="cb5-114"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                          sin_list,</span></span>
<span id="cb5-115"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                          mid_point)]</span></span>
<span id="cb5-116"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            lines = [Line(0, 1, .25, 0, 1),</span></span>
<span id="cb5-117"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                    Line(1, 0, .25, 0, 2)]</span></span>
<span id="cb5-118"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            t = Tile(points, (.25, .25), lines)</span></span>
<span id="cb5-119"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            fig, ax = plt.subplots()</span></span>
<span id="cb5-120"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            t.draw_tile(ax)</span></span>
<span id="cb5-121"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            plt.show()</span></span>
<span id="cb5-122"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb5-123"></span>
<span id="cb5-124">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Determine boundary box</span></span>
<span id="cb5-125">        min_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.inf</span>
<span id="cb5-126">        max_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>np.inf</span>
<span id="cb5-127">        min_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.inf</span>
<span id="cb5-128">        max_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>np.inf</span>
<span id="cb5-129"></span>
<span id="cb5-130">        line_base_point <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.intersection_points</span>
<span id="cb5-131">        tile_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb5-132">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> tp <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tile_points:</span>
<span id="cb5-133">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> tp.base_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> min_x:</span>
<span id="cb5-134">                min_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tp.base_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb5-135">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> tp.base_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> max_x:</span>
<span id="cb5-136">                max_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tp.base_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb5-137">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> tp.base_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> min_y:</span>
<span id="cb5-138">                min_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tp.base_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb5-139">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> tp.base_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> max_y:</span>
<span id="cb5-140">                max_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tp.base_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb5-141">            tile_points.append(tp.base_location.copy())</span>
<span id="cb5-142"></span>
<span id="cb5-143">        midpoint_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb5-144">        midpoint_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb5-145"></span>
<span id="cb5-146">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> tile_points:</span>
<span id="cb5-147">            midpoint_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb5-148">            midpoint_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb5-149"></span>
<span id="cb5-150">        midpoint_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> midpoint_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(tile_points)</span>
<span id="cb5-151">        midpoint_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> midpoint_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(tile_points)</span>
<span id="cb5-152"></span>
<span id="cb5-153">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> tile_points:</span>
<span id="cb5-154">            p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> midpoint_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> line_base_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb5-155">            p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> midpoint_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> line_base_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb5-156"></span>
<span id="cb5-157">        min_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-158">        max_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-159">        min_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-160">        max_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-161"></span>
<span id="cb5-162">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Line stuff</span></span>
<span id="cb5-163">        line_base_point <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.intersection_points</span>
<span id="cb5-164">        line_min_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.intersection_points[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb5-165">        line_max_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.intersection_points[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb5-166">        line_min_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.intersection_points[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb5-167">        line_max_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.intersection_points[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb5-168">        boundary <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Line(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, line_min_x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb5-169">                    Line(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, line_max_x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb5-170">                    Line(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, line_min_y, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb5-171">                    Line(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, line_max_y, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)]</span>
<span id="cb5-172"></span>
<span id="cb5-173">        draw_lines <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb5-174"></span>
<span id="cb5-175">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> line <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.intersection_lines:</span>
<span id="cb5-176">            points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb5-177">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> b <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> boundary:</span>
<span id="cb5-178">                intersection <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> line.determine_intersection(b)</span>
<span id="cb5-179">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (intersection</span>
<span id="cb5-180">                        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> intersection[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> (line_min_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>)</span>
<span id="cb5-181">                        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> intersection[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> (line_max_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>)</span>
<span id="cb5-182">                        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> intersection[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> (line_min_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>)</span>
<span id="cb5-183">                        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> intersection[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> (line_max_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>)):</span>
<span id="cb5-184">                    points.append(intersection)</span>
<span id="cb5-185">            draw_lines.append(points)</span>
<span id="cb5-186"></span>
<span id="cb5-187">        ax.add_collection(LineCollection(draw_lines))</span>
<span id="cb5-188">        ax.add_patch(Polygon(tile_points, facecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'w'</span>, edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"k"</span>))</span>
<span id="cb5-189">        ax.set_xlim(line_min_x, line_max_x)</span>
<span id="cb5-190">        ax.set_ylim(line_min_y, line_max_y)</span>
<span id="cb5-191">        ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>)</span>
<span id="cb5-192"></span>
<span id="cb5-193">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> ax</span>
<span id="cb5-194"></span>
<span id="cb5-195">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> draw_line_angles(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, ax):</span>
<span id="cb5-196">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Draws the lines and their angles."""</span></span>
<span id="cb5-197"></span>
<span id="cb5-198">        angles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [np.pi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)]</span>
<span id="cb5-199">        angles_color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> angles]</span>
<span id="cb5-200"></span>
<span id="cb5-201">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> line <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.intersection_lines:</span>
<span id="cb5-202">            angles.extend([line.angles[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>].value, line.angles[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>].value])</span>
<span id="cb5-203">            angles_color.extend([<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'red'</span>])</span>
<span id="cb5-204"></span>
<span id="cb5-205">        draw_lines <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb5-206">        text_location <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb5-207"></span>
<span id="cb5-208">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> angle <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> angles:</span>
<span id="cb5-209">            draw_lines.append([(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), (np.cos(angle), np.sin(angle))])</span>
<span id="cb5-210">            text_location.append([<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.10</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.cos(angle), <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.10</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(angle)])</span>
<span id="cb5-211"></span>
<span id="cb5-212">        ax.add_collection(LineCollection(draw_lines, colors<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>angles_color))</span>
<span id="cb5-213">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> tl, a <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(text_location, angles):</span>
<span id="cb5-214">            ax.text(tl[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], tl[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>a<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.2f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb5-215">        ax.set_xlim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>)</span>
<span id="cb5-216">        ax.set_ylim(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>)</span>
<span id="cb5-217">        ax.axis(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'off'</span>)</span>
<span id="cb5-218">        ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>)</span>
<span id="cb5-219"></span>
<span id="cb5-220">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> ax</span></code></pre></div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2025-09-03-grid-tilings/tile_line_angles_graph.png" class="img-fluid figure-img"></p>
<figcaption>Intersection Angles</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2025-09-03-grid-tilings/tile_graph.png" class="img-fluid figure-img"></p>
<figcaption>Tile</figcaption>
</figure>
</div>
</div>
</div>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
Multigrid Class
</h2>
</center>
<hr>
<p>The <code>Multigrid</code> class is the workhorse of this package. It takes in all the starting parameters and sets up the grid. The <code>create_tiles</code> function finds all the intersections, creates a tile for each one, then assigns the tile a color. The <code>remove_unconnected_tiles</code> function discards any tiles that don’t connect to the main central section. The <code>draw_image</code> and <code>save_image</code> function create the final images. The <code>determine_base_K</code> and <code>determine_K</code> functions are used to determine the <em>k-values</em>. The <code>random_color</code> and <code>oklab</code> functions are used to create colors. Finally, the <code>draw_oklab</code>, <code>draw_offsets</code>, <code>draw_grids</code>, <code>draw_k</code>, and <code>draw_all_tiles</code> functions are helpers to visualize the process.</p>
<div id="4cc63cc5" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> Multigrid:</span>
<span id="cb6-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb6-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Multigrid class used create the grid of Lines to create the Tiles.</span></span>
<span id="cb6-4"></span>
<span id="cb6-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    This is the main workhorse for the package.</span></span>
<span id="cb6-6"></span>
<span id="cb6-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Attributes:</span></span>
<span id="cb6-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        seed: RNG seed</span></span>
<span id="cb6-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        grid_count: The number of grids</span></span>
<span id="cb6-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        grid_bounds: The number of lines in a grid</span></span>
<span id="cb6-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        rotation: Amount to turn the multigrid</span></span>
<span id="cb6-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        cos_list: cosine values of the Multigrid</span></span>
<span id="cb6-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        sin_list: sin values of the Multigrid</span></span>
<span id="cb6-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        base_point: Location to move the multigrid to</span></span>
<span id="cb6-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        offsets: Movement from the center for each of the grids</span></span>
<span id="cb6-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        colors: Colors for the tile groups</span></span>
<span id="cb6-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        grids: list for all of the Lines in the Multigrid</span></span>
<span id="cb6-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        grid_colors: list for a color for each grid</span></span>
<span id="cb6-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        mid_point: center of the tilings</span></span>
<span id="cb6-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        points: dictionary of the points for the Tiles</span></span>
<span id="cb6-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        edges: dictionary of the edges for the Tiles</span></span>
<span id="cb6-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        intersections: dictionary for the intersections between all the</span></span>
<span id="cb6-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            Lines in the Multigrid</span></span>
<span id="cb6-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        base_tiles: tile of unique tile shapes, used to determine Tile</span></span>
<span id="cb6-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            coloring</span></span>
<span id="cb6-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        tiles: dictionary of Tiles</span></span>
<span id="cb6-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb6-28"></span>
<span id="cb6-29">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>,</span>
<span id="cb6-30">                 seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb6-31">                 grid_count<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb6-32">                 grid_bounds<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[],</span>
<span id="cb6-33">                 rotation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb6-34">                 base_point<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(),</span>
<span id="cb6-35">                 offsets<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[],</span>
<span id="cb6-36">                 colors<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[]):</span>
<span id="cb6-37">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb6-38"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Constructor for a Multigrid</span></span>
<span id="cb6-39"></span>
<span id="cb6-40"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Args:</span></span>
<span id="cb6-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            seed: RNG seed</span></span>
<span id="cb6-42"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            grid_count: The number of grids</span></span>
<span id="cb6-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            grid_bounds: The number of lines in a grid</span></span>
<span id="cb6-44"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            rotation: Amount to turn the multigrid</span></span>
<span id="cb6-45"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            base_point: Location to move the multigrid to</span></span>
<span id="cb6-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            offsets: Movement from the center for each of the grids</span></span>
<span id="cb6-47"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            colors: Colors for the tile groups</span></span>
<span id="cb6-48"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb6-49">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.seed <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> seed</span>
<span id="cb6-50">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.rng <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.random.default_rng(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.seed)</span>
<span id="cb6-51"></span>
<span id="cb6-52">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> grid_count:</span>
<span id="cb6-53">            grid_count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.rng.integers(low<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, high<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>)</span>
<span id="cb6-54">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> grid_count</span>
<span id="cb6-55"></span>
<span id="cb6-56">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> grid_bounds:</span>
<span id="cb6-57">            grid_bounds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.rng.integers(low<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, high<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>)</span>
<span id="cb6-58">            grid_bounds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>grid_bounds, grid_bounds<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb6-59">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_bounds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> grid_bounds</span>
<span id="cb6-60"></span>
<span id="cb6-61">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> rotation <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb6-62">            rotation <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.rng.uniform(low<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, high<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> grid_count))</span>
<span id="cb6-63">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.rotation <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rotation</span>
<span id="cb6-64"></span>
<span id="cb6-65">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Evenly space grids around the origin</span></span>
<span id="cb6-66">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cos_list <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [np.cos(x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi</span>
<span id="cb6-67">                                <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.rotation)</span>
<span id="cb6-68">                         <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> np.arange(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_count)]</span>
<span id="cb6-69">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.sin_list <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [np.sin(x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi</span>
<span id="cb6-70">                                <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.rotation)</span>
<span id="cb6-71">                         <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> np.arange(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_count)]</span>
<span id="cb6-72"></span>
<span id="cb6-73">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> offsets:</span>
<span id="cb6-74">            offsets <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.rng.uniform(size<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>grid_count)</span>
<span id="cb6-75">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(offsets) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb6-76">                offsets <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> offsets <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">sum</span>(offsets)</span>
<span id="cb6-77">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.offsets <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> offsets</span>
<span id="cb6-78"></span>
<span id="cb6-79">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> colors:</span>
<span id="cb6-80">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.colors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> colors</span>
<span id="cb6-81">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb6-82">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.colors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb6-83"></span>
<span id="cb6-84">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> base_point:</span>
<span id="cb6-85">            r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sqrt(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.rng.random())</span>
<span id="cb6-86">            theta <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.rng.random() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.pi</span>
<span id="cb6-87">            base_point <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.cos(theta),</span>
<span id="cb6-88">                                   r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.sin(theta), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>)</span>
<span id="cb6-89">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.base_point <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> base_point</span>
<span id="cb6-90"></span>
<span id="cb6-91">        base_k_values <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb6-92">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> c, s, o <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cos_list, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.sin_list, offsets):</span>
<span id="cb6-93">            base_k_values.append(</span>
<span id="cb6-94">                <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.determine_base_K(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.base_point, c, s, o))</span>
<span id="cb6-95"></span>
<span id="cb6-96">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create the grids here</span></span>
<span id="cb6-97">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grids <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb6-98">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i, (s, c, o, bk) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">enumerate</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.sin_list, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cos_list,</span>
<span id="cb6-99">                                              offsets, base_k_values)):</span>
<span id="cb6-100">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> np.arange(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>grid_bounds):</span>
<span id="cb6-101">                <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grids.append(Line(c, s, o, bk <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> k, i))</span>
<span id="cb6-102">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_colors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.oklab(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.75</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> c, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> s)</span>
<span id="cb6-103">                            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> c, s <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cos_list, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.sin_list)]</span>
<span id="cb6-104"></span>
<span id="cb6-105">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.mid_point <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array([<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], dtype<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>)</span>
<span id="cb6-106">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k, c, s <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(base_k_values, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cos_list, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.sin_list):</span>
<span id="cb6-107">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.mid_point <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.array([c, s])</span>
<span id="cb6-108"></span>
<span id="cb6-109">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> update_edges(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, points, tile_id):</span>
<span id="cb6-110">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Only used to update edges when creating tiles"""</span></span>
<span id="cb6-111">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> points <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.edges:</span>
<span id="cb6-112">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.edges[points].add_tile_id(tile_id)</span>
<span id="cb6-113">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb6-114">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.edges[points] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Edge(points, tile_id)</span>
<span id="cb6-115"></span>
<span id="cb6-116">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> create_tiles(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb6-117">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb6-118"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Creates the tiles from the intersections of lines in the</span></span>
<span id="cb6-119"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            Multigrid</span></span>
<span id="cb6-120"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb6-121"></span>
<span id="cb6-122">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb6-123"></span>
<span id="cb6-124">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.edges <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb6-125"></span>
<span id="cb6-126">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Use a set for each intersection so if three or more lines</span></span>
<span id="cb6-127">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   cross at the same point, there is one intersection and only</span></span>
<span id="cb6-128">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   those many lines listed, not an intersection for each pair</span></span>
<span id="cb6-129">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   of lines</span></span>
<span id="cb6-130">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.intersections <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> defaultdict(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">set</span>)</span>
<span id="cb6-131">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> pair <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> combinations(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grids, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>):</span>
<span id="cb6-132">            l1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pair[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb6-133">            l2 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pair[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb6-134"></span>
<span id="cb6-135">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If they're the same grid, they don't intersect</span></span>
<span id="cb6-136">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> l1.grid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> l2.grid:</span>
<span id="cb6-137">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">continue</span></span>
<span id="cb6-138"></span>
<span id="cb6-139">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">try</span>:</span>
<span id="cb6-140">                intersection <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> l1.determine_intersection(l2)</span>
<span id="cb6-141">                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sometime there's not an intersection for even number</span></span>
<span id="cb6-142">                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   grids.</span></span>
<span id="cb6-143">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> intersection:</span>
<span id="cb6-144">                    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.intersections[intersection].update([l1, l2])</span>
<span id="cb6-145">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># A bad combination of offsets with an even number of grids</span></span>
<span id="cb6-146">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   can produce lines that overlap (because two grids end up</span></span>
<span id="cb6-147">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   one unit apart, but in the exact opposite direction).</span></span>
<span id="cb6-148">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   If that happens, it should break.</span></span>
<span id="cb6-149">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">except</span> OverlappingLines <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> e:</span>
<span id="cb6-150">                <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">print</span>(e)</span>
<span id="cb6-151">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">raise</span></span>
<span id="cb6-152"></span>
<span id="cb6-153">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.base_tiles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb6-154">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tiles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> {}</span>
<span id="cb6-155"></span>
<span id="cb6-156">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (intersection_points,</span>
<span id="cb6-157">             intersection_lines) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.intersections.items():</span>
<span id="cb6-158"></span>
<span id="cb6-159">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># We need to build a tile from each intersection. The points</span></span>
<span id="cb6-160">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   of a tile are in between the lines that make up an</span></span>
<span id="cb6-161">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   intersection. We'll loop through the lines in circle</span></span>
<span id="cb6-162">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   crossing over each line and then back over them as we</span></span>
<span id="cb6-163">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   go all the way around. So first order the lines by</span></span>
<span id="cb6-164">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   angle.</span></span>
<span id="cb6-165">            angles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb6-166">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> line <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> intersection_lines:</span>
<span id="cb6-167">                angles.extend(line.angles.copy())</span>
<span id="cb6-168">            angles.sort()</span>
<span id="cb6-169"></span>
<span id="cb6-170">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Then, set up K values for the other lines. The k values</span></span>
<span id="cb6-171">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   that are for the lines get pulled from them.</span></span>
<span id="cb6-172">            ks <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.determine_K(c, intersection_points[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],</span>
<span id="cb6-173">                                   s, intersection_points[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], o)</span>
<span id="cb6-174">                  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> c, s, o <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cos_list,</span>
<span id="cb6-175">                                     <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.sin_list,</span>
<span id="cb6-176">                                     <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.offsets)]</span>
<span id="cb6-177"></span>
<span id="cb6-178">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Now spin around to ensure the ks are correct on the lines</span></span>
<span id="cb6-179">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   that intersect for the starting point (the left side of</span></span>
<span id="cb6-180">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   the circle).</span></span>
<span id="cb6-181">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> angle <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> angles:</span>
<span id="cb6-182">                ks[angle.grid] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> angle.k</span>
<span id="cb6-183"></span>
<span id="cb6-184">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Finally, loop through again with all the k values set</span></span>
<span id="cb6-185">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   correctly, update them as each line is crossed.</span></span>
<span id="cb6-186">            tile_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb6-187">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> angle <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> angles:</span>
<span id="cb6-188">                ks[angle.grid] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> angle.k</span>
<span id="cb6-189"></span>
<span id="cb6-190">                k_values <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">tuple</span>(ks)</span>
<span id="cb6-191">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> k_values <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.points:</span>
<span id="cb6-192">                    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.points[k_values] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Point(k_values,</span>
<span id="cb6-193">                                                  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cos_list,</span>
<span id="cb6-194">                                                  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.sin_list,</span>
<span id="cb6-195">                                                  <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.mid_point)</span>
<span id="cb6-196"></span>
<span id="cb6-197">                tile_points.append(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.points[k_values])</span>
<span id="cb6-198"></span>
<span id="cb6-199">            t <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Tile(tile_points, intersection_points, intersection_lines)</span>
<span id="cb6-200"></span>
<span id="cb6-201">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create an Edge for each edge of a Tile</span></span>
<span id="cb6-202">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> t_current, t_next <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(t.tile_points,</span>
<span id="cb6-203">                                         t.tile_points[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:]</span>
<span id="cb6-204">                                         <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> [t.tile_points[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]]):</span>
<span id="cb6-205">                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check left to right, then down to up to make sure the</span></span>
<span id="cb6-206">                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   edges dictionary keys match</span></span>
<span id="cb6-207">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> t_current.base_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> t_next.base_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]:</span>
<span id="cb6-208">                    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.update_edges(points<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(t_current.k_values,</span>
<span id="cb6-209">                                              t_next.k_values),</span>
<span id="cb6-210">                                      tile_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>t.tile_id)</span>
<span id="cb6-211">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> t_next.base_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> t_current.base_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]:</span>
<span id="cb6-212">                    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.update_edges(points<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(t_next.k_values,</span>
<span id="cb6-213">                                              t_current.k_values),</span>
<span id="cb6-214">                                      tile_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>t.tile_id)</span>
<span id="cb6-215">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> t_current.base_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> t_next.base_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]:</span>
<span id="cb6-216">                    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.update_edges(points<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(t_current.k_values,</span>
<span id="cb6-217">                                              t_next.k_values),</span>
<span id="cb6-218">                                      tile_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>t.tile_id)</span>
<span id="cb6-219">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb6-220">                    <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.update_edges(points<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(t_next.k_values,</span>
<span id="cb6-221">                                              t_current.k_values),</span>
<span id="cb6-222">                                      tile_id<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>t.tile_id)</span>
<span id="cb6-223"></span>
<span id="cb6-224">            <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Assign a tile_group number for coloring later</span></span>
<span id="cb6-225">            bt_match <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb6-226">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> bt <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.base_tiles:</span>
<span id="cb6-227">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> bt.compare_angles(t):</span>
<span id="cb6-228">                    t.tile_group <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> bt.tile_group</span>
<span id="cb6-229">                    bt_match <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb6-230">                    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">break</span></span>
<span id="cb6-231"></span>
<span id="cb6-232">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> bt_match:</span>
<span id="cb6-233">                t.tile_group <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.base_tiles)</span>
<span id="cb6-234">                <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.base_tiles.append(t)</span>
<span id="cb6-235"></span>
<span id="cb6-236">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tiles[t.tile_id] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> t</span>
<span id="cb6-237"></span>
<span id="cb6-238">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Assign colors to base tiles</span></span>
<span id="cb6-239">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.colors:</span>
<span id="cb6-240">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.base_tiles) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>):</span>
<span id="cb6-241">                <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.colors.append(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.random_color())</span>
<span id="cb6-242"></span>
<span id="cb6-243">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> remove_unconnected_tiles(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb6-244">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb6-245"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Removes tiles that aren't connected to the center.</span></span>
<span id="cb6-246"></span>
<span id="cb6-247"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Only needed if drawing all tiles and don't want any of the</span></span>
<span id="cb6-248"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        unconnected ones.</span></span>
<span id="cb6-249"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb6-250"></span>
<span id="cb6-251">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Build out network of neighbors</span></span>
<span id="cb6-252">        neighbors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> defaultdict(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>)</span>
<span id="cb6-253">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> edge <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.edges.values():</span>
<span id="cb6-254">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(edge.tile_ids) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>:</span>
<span id="cb6-255">                neighbors[edge.tile_ids[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]].append(edge.tile_ids[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb6-256">                neighbors[edge.tile_ids[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]].append(edge.tile_ids[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb6-257"></span>
<span id="cb6-258">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Find a center-ish tile</span></span>
<span id="cb6-259">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> tile_id, tile <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tiles.items():</span>
<span id="cb6-260">            tile_point <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tile.tile_points[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb6-261">            tile_distance <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tile_point.centered_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb6-262">            <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> tile_point.centered_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb6-263">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> tile_distance <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>:</span>
<span id="cb6-264">                center_tile <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> tile</span>
<span id="cb6-265">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">break</span></span>
<span id="cb6-266"></span>
<span id="cb6-267">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Mark the connected tiles</span></span>
<span id="cb6-268">        center_tile.connected <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb6-269">        connected_tiles <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> deque([center_tile])</span>
<span id="cb6-270"></span>
<span id="cb6-271">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> connected_tiles:</span>
<span id="cb6-272">            current_tile <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> connected_tiles.pop()</span>
<span id="cb6-273">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> neighbor <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> neighbors[current_tile.tile_id]:</span>
<span id="cb6-274">                neighbor_tile <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tiles[neighbor]</span>
<span id="cb6-275">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> neighbor_tile.connected:</span>
<span id="cb6-276">                    neighbor_tile.connected <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb6-277">                    connected_tiles.append(neighbor_tile)</span>
<span id="cb6-278"></span>
<span id="cb6-279">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Now, delete the not connected tiles</span></span>
<span id="cb6-280">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> k <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tiles.keys()):</span>
<span id="cb6-281">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tiles[k].connected:</span>
<span id="cb6-282">                <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">del</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tiles[k]</span>
<span id="cb6-283"></span>
<span id="cb6-284">        remove_edges <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb6-285">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> edge <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.edges.values():</span>
<span id="cb6-286">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> t <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> edge.tile_ids.copy():</span>
<span id="cb6-287">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> t <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tiles:</span>
<span id="cb6-288">                    edge.tile_ids.remove(t)</span>
<span id="cb6-289"></span>
<span id="cb6-290">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> edge.tile_ids:</span>
<span id="cb6-291">                remove_edges.append(edge.points)</span>
<span id="cb6-292"></span>
<span id="cb6-293">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> edge <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> remove_edges:</span>
<span id="cb6-294">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">del</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.edges[edge]</span>
<span id="cb6-295"></span>
<span id="cb6-296">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> draw_image(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, ax):</span>
<span id="cb6-297">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb6-298"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Draws the main image.</span></span>
<span id="cb6-299"></span>
<span id="cb6-300"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        mg = Multigrid(grid_count=5,</span></span>
<span id="cb6-301"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                            grid_bounds=[-5, 5], rotation=0,</span></span>
<span id="cb6-302"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                            base_point = [0, 0],</span></span>
<span id="cb6-303"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                            offsets=[.2, .2, .2, .2, .2])</span></span>
<span id="cb6-304"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        mg.create_tiles()</span></span>
<span id="cb6-305"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        mg.remove_unconnected_tiles()</span></span>
<span id="cb6-306"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        fig, ax = plt.subplots(figsize=figsize)</span></span>
<span id="cb6-307"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        ax = self.draw_image(ax)</span></span>
<span id="cb6-308"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        plt.tight_layout()</span></span>
<span id="cb6-309"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        plt.show()</span></span>
<span id="cb6-310"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb6-311">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Find the closest distance between the center and all the edges</span></span>
<span id="cb6-312">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   that don't have two tiles</span></span>
<span id="cb6-313">        closest_distance <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.inf</span>
<span id="cb6-314"></span>
<span id="cb6-315">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> edge <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.edges.values():</span>
<span id="cb6-316">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(edge.tile_ids) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>:</span>
<span id="cb6-317">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> edge.points:</span>
<span id="cb6-318">                    p_distance <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.points[p].centered_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb6-319">                                  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.points[p].centered_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb6-320">                    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> p_distance <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> closest_distance:</span>
<span id="cb6-321">                        closest_distance <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> p_distance</span>
<span id="cb6-322">        closest_distance <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sqrt(closest_distance)</span>
<span id="cb6-323"></span>
<span id="cb6-324">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set this distance as the diagonal of a square for the image</span></span>
<span id="cb6-325">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#   bounds.</span></span>
<span id="cb6-326">        image_bounds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> closest_distance <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> np.sqrt(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb6-327"></span>
<span id="cb6-328">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set up all the tiles as polygons</span></span>
<span id="cb6-329">        polygons <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb6-330">        polygon_colors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb6-331">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> t <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tiles.values():</span>
<span id="cb6-332">            locations <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb6-333">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> t.tile_points:</span>
<span id="cb6-334">                locations.append(p.centered_location)</span>
<span id="cb6-335"></span>
<span id="cb6-336">            polygons.append(locations)</span>
<span id="cb6-337">            polygon_colors.append(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.colors[t.tile_group])</span>
<span id="cb6-338"></span>
<span id="cb6-339">        polygon_collection <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> PolyCollection(polygons,</span>
<span id="cb6-340">                                            facecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>polygon_colors,</span>
<span id="cb6-341">                                            edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.colors[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb6-342">        ax.add_collection(polygon_collection)</span>
<span id="cb6-343">        ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>)</span>
<span id="cb6-344">        ax.axis([<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>image_bounds, image_bounds, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>image_bounds, image_bounds])</span>
<span id="cb6-345">        ax.axis(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'off'</span>)</span>
<span id="cb6-346"></span>
<span id="cb6-347">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> save_image(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, image_location, figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), dpi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">150</span>):</span>
<span id="cb6-348">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb6-349"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Save the main image</span></span>
<span id="cb6-350"></span>
<span id="cb6-351"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        mg = Multigrid(grid_count=5,</span></span>
<span id="cb6-352"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                            grid_bounds=[-5, 5], rotation=0,</span></span>
<span id="cb6-353"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                            base_point = [0, 0],</span></span>
<span id="cb6-354"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">                            offsets=[.2, .2, .2, .2, .2])</span></span>
<span id="cb6-355"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        mg.create_tiles()</span></span>
<span id="cb6-356"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        mg.remove_unconnected_tiles()</span></span>
<span id="cb6-357"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        mg.save_image('output/graph.png')</span></span>
<span id="cb6-358"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb6-359"></span>
<span id="cb6-360">        fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>figsize)</span>
<span id="cb6-361">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.draw_image(ax)</span>
<span id="cb6-362">        plt.tight_layout(pad<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb6-363">        plt.savefig(image_location, dpi<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>dpi)</span>
<span id="cb6-364">        plt.close()</span>
<span id="cb6-365"></span>
<span id="cb6-366">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> determine_base_K(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, p, c, s, o):</span>
<span id="cb6-367">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Set the k values if there's a base_point"""</span></span>
<span id="cb6-368">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If it's on a line, lower it to the origin</span></span>
<span id="cb6-369">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> isclose(((c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), o,</span>
<span id="cb6-370">                   rel_tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-5</span>, abs_tol<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-05</span>):</span>
<span id="cb6-371">            p_distance <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.sqrt(p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb6-372">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> p_distance:</span>
<span id="cb6-373">                p_normal_origin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>p_ <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> p_distance <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> p_ <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> p]</span>
<span id="cb6-374">                p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [p <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> pno <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> p, pno <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(p, p_normal_origin)]</span>
<span id="cb6-375">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb6-376">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb6-377"></span>
<span id="cb6-378">        base_k <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.determine_K(c, p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], s, p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], o)</span>
<span id="cb6-379">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> base_k</span>
<span id="cb6-380"></span>
<span id="cb6-381">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> determine_K(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, c, x, s, y, o):</span>
<span id="cb6-382">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Formula for the k values"""</span></span>
<span id="cb6-383">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> np.ceil(c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> o)</span>
<span id="cb6-384"></span>
<span id="cb6-385">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> random_color(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>):</span>
<span id="cb6-386">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Draws a random color from oklab"""</span></span>
<span id="cb6-387">        converts_rgb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb6-388"></span>
<span id="cb6-389">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> converts_rgb:</span>
<span id="cb6-390">            L <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.rng.uniform(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb6-391">            a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.rng.uniform(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.3</span>)</span>
<span id="cb6-392">            b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.rng.uniform(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.3</span>)</span>
<span id="cb6-393"></span>
<span id="cb6-394">            rgb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.oklab(L, a, b)</span>
<span id="cb6-395"></span>
<span id="cb6-396">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> ((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> rgb[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> rgb[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb6-397">                    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> rgb[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> rgb[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb6-398">                    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> rgb[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> rgb[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)):</span>
<span id="cb6-399">                converts_rgb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb6-400"></span>
<span id="cb6-401">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> rgb</span>
<span id="cb6-402"></span>
<span id="cb6-403">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> oklab(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, L, a, b):</span>
<span id="cb6-404">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Converts oklab to rgb"""</span></span>
<span id="cb6-405">        new_l <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> L <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3963377774</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2158037573</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> b</span>
<span id="cb6-406">        new_m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> L <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.1055613458</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0638541728</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> b</span>
<span id="cb6-407">        new_s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> L <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0894841775</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2914855480</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> b</span>
<span id="cb6-408"></span>
<span id="cb6-409">        new_l <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> new_l <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> new_l <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> new_l</span>
<span id="cb6-410">        new_m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> new_m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> new_m <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> new_m</span>
<span id="cb6-411">        new_s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> new_s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> new_s <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> new_s</span>
<span id="cb6-412"></span>
<span id="cb6-413">        rgb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.0767416621</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> new_l</span>
<span id="cb6-414">               <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.3077115913</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> new_m</span>
<span id="cb6-415">               <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.2309699292</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> new_s,</span>
<span id="cb6-416">               <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.2684380046</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> new_l</span>
<span id="cb6-417">               <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.6097574011</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> new_m</span>
<span id="cb6-418">               <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.3413193965</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> new_s,</span>
<span id="cb6-419">               <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.0041960863</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> new_l</span>
<span id="cb6-420">               <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.7034186147</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> new_m</span>
<span id="cb6-421">               <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.7076147010</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> new_s]</span>
<span id="cb6-422"></span>
<span id="cb6-423">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># transfer function</span></span>
<span id="cb6-424">        rgb_correct <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb6-425">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> value <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> rgb:</span>
<span id="cb6-426">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> value <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.0031308</span>:</span>
<span id="cb6-427">                value <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">12.92</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> value</span>
<span id="cb6-428">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb6-429">                value <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.055</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> np.power(value, (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.4</span>))) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.055</span></span>
<span id="cb6-430">            rgb_correct.append(value)</span>
<span id="cb6-431"></span>
<span id="cb6-432">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> rgb_correct</span>
<span id="cb6-433"></span>
<span id="cb6-434">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> draw_oklab(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, L):</span>
<span id="cb6-435">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Draws a slice of oklab colorspace"""</span></span>
<span id="cb6-436">        A, B <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.meshgrid(np.arange(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.001</span>), np.arange(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.001</span>))</span>
<span id="cb6-437">        r <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros_like(A)</span>
<span id="cb6-438">        g <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros_like(A)</span>
<span id="cb6-439">        b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros_like(A)</span>
<span id="cb6-440">        a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros_like(A)</span>
<span id="cb6-441">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(r)):</span>
<span id="cb6-442">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(r[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])):</span>
<span id="cb6-443">                rgb <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.oklab(L, A[i, j], B[i, j])</span>
<span id="cb6-444"></span>
<span id="cb6-445">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> ((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> rgb[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> rgb[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb6-446">                        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> rgb[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> rgb[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb6-447">                        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> rgb[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> rgb[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)):</span>
<span id="cb6-448">                    r[i, j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rgb[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb6-449">                    g[i, j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rgb[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb6-450">                    b[i, j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> rgb[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]</span>
<span id="cb6-451">                    a[i, j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb6-452"></span>
<span id="cb6-453">        c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.dstack([r, g, b, a])</span>
<span id="cb6-454"></span>
<span id="cb6-455">        plt.imshow(c, interpolation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'nearest'</span>, origin<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lower"</span>)</span>
<span id="cb6-456">        plt.xlabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'a'</span>)</span>
<span id="cb6-457">        plt.xticks(np.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(c), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>),</span>
<span id="cb6-458">                   labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">round</span>(np.linspace(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb6-459">        plt.ylabel(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'b'</span>)</span>
<span id="cb6-460">        plt.yticks(np.linspace(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(c), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>),</span>
<span id="cb6-461">                   labels<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>np.<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">round</span>(np.linspace(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.3</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb6-462">        plt.title(<span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f"L = </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>L<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">"</span>)</span>
<span id="cb6-463">        plt.show()</span>
<span id="cb6-464"></span>
<span id="cb6-465">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> draw_offsets(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, ax):</span>
<span id="cb6-466">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Draws the offsets"""</span></span>
<span id="cb6-467">        x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> o <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.base_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x, o <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span></span>
<span id="cb6-468">             <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cos_list, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.offsets)]</span>
<span id="cb6-469">        y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> o <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.base_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> y, o <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span></span>
<span id="cb6-470">             <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.sin_list, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.offsets)]</span>
<span id="cb6-471"></span>
<span id="cb6-472">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x_point, y_point <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(x, y):</span>
<span id="cb6-473">            ax.annotate(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, xytext<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.base_point, xy<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(x_point, y_point),</span>
<span id="cb6-474">                        arrowprops<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="bu" style="color: null;
background-color: null;
font-style: inherit;">dict</span>(arrowstyle<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"-&gt;"</span>))</span>
<span id="cb6-475">        ax.scatter(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.base_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>], <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.base_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb6-476">        ax.scatter(x, y)</span>
<span id="cb6-477">        ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'box'</span>)</span>
<span id="cb6-478">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> ax</span>
<span id="cb6-479"></span>
<span id="cb6-480">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> draw_grids(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, ax):</span>
<span id="cb6-481">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Draws the grids"""</span></span>
<span id="cb6-482">        min_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.inf</span>
<span id="cb6-483">        max_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>np.inf</span>
<span id="cb6-484">        min_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.inf</span>
<span id="cb6-485">        max_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>np.inf</span>
<span id="cb6-486"></span>
<span id="cb6-487">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.intersections.keys():</span>
<span id="cb6-488">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> i[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> min_x:</span>
<span id="cb6-489">                min_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> i[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb6-490">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> i[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> max_x:</span>
<span id="cb6-491">                max_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> i[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb6-492">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> i[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> min_y:</span>
<span id="cb6-493">                min_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> i[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb6-494">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> i[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> max_y:</span>
<span id="cb6-495">                max_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> i[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb6-496"></span>
<span id="cb6-497">        min_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb6-498">        max_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb6-499">        min_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb6-500">        max_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb6-501"></span>
<span id="cb6-502">        boundary <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Line(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, min_x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), Line(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, max_x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb6-503">                    Line(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, min_y, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), Line(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, max_y, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)]</span>
<span id="cb6-504"></span>
<span id="cb6-505">        draw_lines <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb6-506">        draw_color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb6-507"></span>
<span id="cb6-508">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> line <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grids:</span>
<span id="cb6-509">            points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb6-510">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> b <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> boundary:</span>
<span id="cb6-511">                intersection <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> line.determine_intersection(b)</span>
<span id="cb6-512">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (intersection</span>
<span id="cb6-513">                        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> intersection[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> (min_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>)</span>
<span id="cb6-514">                        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> intersection[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> (max_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>)</span>
<span id="cb6-515">                        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> intersection[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> (min_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>)</span>
<span id="cb6-516">                        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> intersection[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> (max_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>)):</span>
<span id="cb6-517">                    points.append(intersection)</span>
<span id="cb6-518">            draw_lines.append(points)</span>
<span id="cb6-519">            draw_color.append(line.grid)</span>
<span id="cb6-520"></span>
<span id="cb6-521">        colors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_colors[g] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> g <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> draw_color]</span>
<span id="cb6-522">        ax.add_collection(LineCollection(draw_lines, colors<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>colors))</span>
<span id="cb6-523"></span>
<span id="cb6-524">        ax.set_xlim(min_x, max_x)</span>
<span id="cb6-525">        ax.set_ylim(min_y, max_y)</span>
<span id="cb6-526">        ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>)</span>
<span id="cb6-527">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> ax</span>
<span id="cb6-528"></span>
<span id="cb6-529">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> draw_k(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, ax, this_grid):</span>
<span id="cb6-530">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Draws the k values for one grid"""</span></span>
<span id="cb6-531">        these_lines <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [line <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> line <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grids <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> line.grid <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> this_grid]</span>
<span id="cb6-532">        this_cos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cos_list[this_grid]</span>
<span id="cb6-533">        this_sin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.sin_list[this_grid]</span>
<span id="cb6-534">        this_offset <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.offsets[this_grid]</span>
<span id="cb6-535"></span>
<span id="cb6-536">        min_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.floor(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.base_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb6-537">        max_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.ceil(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.base_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb6-538">        min_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.floor(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.base_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb6-539">        max_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.ceil(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.base_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_count <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb6-540"></span>
<span id="cb6-541">        boundary <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [Line(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, min_x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), Line(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, max_x, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb6-542">                    Line(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, min_y, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), Line(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, max_y, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)]</span>
<span id="cb6-543"></span>
<span id="cb6-544">        draw_lines <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb6-545">        draw_color <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb6-546"></span>
<span id="cb6-547">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> line <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> these_lines:</span>
<span id="cb6-548">            points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb6-549">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> b <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> boundary:</span>
<span id="cb6-550">                intersection <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> line.determine_intersection(b)</span>
<span id="cb6-551">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (intersection</span>
<span id="cb6-552">                        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> intersection[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> (min_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>)</span>
<span id="cb6-553">                        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> intersection[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> (max_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>)</span>
<span id="cb6-554">                        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> intersection[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> (min_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>)</span>
<span id="cb6-555">                        <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> intersection[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> (max_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>)):</span>
<span id="cb6-556">                    points.append(intersection)</span>
<span id="cb6-557">            draw_lines.append(points)</span>
<span id="cb6-558">            draw_color.append(line.grid)</span>
<span id="cb6-559"></span>
<span id="cb6-560">        points_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [(this_cos <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.base_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>)</span>
<span id="cb6-561">                     <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.base_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>])</span>
<span id="cb6-562">                    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> np.arange(min_x, max_x)]</span>
<span id="cb6-563">        points_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [(this_sin <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.base_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.5</span>)</span>
<span id="cb6-564">                     <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.base_point[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb6-565">                    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> np.arange(min_y, max_y)]</span>
<span id="cb6-566">        points_label <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.determine_K(this_cos, x, this_sin, y, this_offset)</span>
<span id="cb6-567">                        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x, y <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(points_x, points_y)]</span>
<span id="cb6-568"></span>
<span id="cb6-569">        X, Y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.meshgrid(np.arange(min_x, max_x, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.1</span>),</span>
<span id="cb6-570">                           np.arange(min_y, max_y, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.1</span>))</span>
<span id="cb6-571">        Z <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.zeros(X.shape)</span>
<span id="cb6-572"></span>
<span id="cb6-573">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(X.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]):</span>
<span id="cb6-574">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(X.shape[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]):</span>
<span id="cb6-575">                Z[i, j] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.determine_K(this_cos, X[i, j],</span>
<span id="cb6-576">                                           this_sin, Y[i, j],</span>
<span id="cb6-577">                                           this_offset)</span>
<span id="cb6-578"></span>
<span id="cb6-579">        colors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_colors[g] <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> g <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> draw_color]</span>
<span id="cb6-580"></span>
<span id="cb6-581">        cmap <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mpl.cm.viridis</span>
<span id="cb6-582">        bounds <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.unique(Z)</span>
<span id="cb6-583">        norm <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mpl.colors.BoundaryNorm(bounds, cmap.N)</span>
<span id="cb6-584"></span>
<span id="cb6-585">        ax.pcolor(X, Y, Z, norm<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>norm, cmap<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>cmap)</span>
<span id="cb6-586"></span>
<span id="cb6-587">        ax.add_collection(LineCollection(draw_lines, colors<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>colors))</span>
<span id="cb6-588">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> x, y, l <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">zip</span>(points_x, points_y, points_label):</span>
<span id="cb6-589">            ax.text(x, y, <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span>l<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:.0f}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span>)</span>
<span id="cb6-590"></span>
<span id="cb6-591">        ax.set_xlim(min_x, max_x)</span>
<span id="cb6-592">        ax.set_ylim(min_y, max_y)</span>
<span id="cb6-593">        ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>)</span>
<span id="cb6-594">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> ax</span>
<span id="cb6-595"></span>
<span id="cb6-596">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> draw_all_tiles(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>, ax):</span>
<span id="cb6-597">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Draws all the tiles"""</span></span>
<span id="cb6-598">        min_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.inf</span>
<span id="cb6-599">        max_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>np.inf</span>
<span id="cb6-600">        min_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.inf</span>
<span id="cb6-601">        max_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>np.inf</span>
<span id="cb6-602"></span>
<span id="cb6-603">        polygons <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb6-604">        polygon_colors <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb6-605">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> t <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.tiles.values():</span>
<span id="cb6-606">            locations <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb6-607">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> t.tile_points:</span>
<span id="cb6-608">                locations.append(p.base_location)</span>
<span id="cb6-609">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> min_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> p.base_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]:</span>
<span id="cb6-610">                    min_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> p.base_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb6-611">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> max_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> p.base_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]:</span>
<span id="cb6-612">                    max_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> p.base_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb6-613">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> min_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> p.base_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]:</span>
<span id="cb6-614">                    min_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> p.base_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb6-615">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> max_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> p.base_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]:</span>
<span id="cb6-616">                    max_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> p.base_location[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb6-617"></span>
<span id="cb6-618">            polygons.append(locations)</span>
<span id="cb6-619">            polygon_colors.append(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.colors[t.tile_group])</span>
<span id="cb6-620"></span>
<span id="cb6-621">        polygon_collection <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> PolyCollection(polygons,</span>
<span id="cb6-622">                                            facecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>polygon_colors,</span>
<span id="cb6-623">                                            edgecolor<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.colors[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb6-624">        ax.add_collection(polygon_collection)</span>
<span id="cb6-625">        ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>)</span>
<span id="cb6-626">        ax.set_xlim(min_x, max_x)</span>
<span id="cb6-627">        ax.set_ylim(min_y, max_y)</span></code></pre></div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2025-09-03-grid-tilings/offsets_graph.png" class="img-fluid figure-img"></p>
<figcaption>Offsets</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2025-09-03-grid-tilings/k_1_graph.png" class="img-fluid figure-img"></p>
<figcaption>K=1 Grid</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2025-09-03-grid-tilings/k_3_graph.png" class="img-fluid figure-img"></p>
<figcaption>K=3 Grid</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2025-09-03-grid-tilings/all_tiles_graph.png" class="img-fluid figure-img"></p>
<figcaption>All tiles</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2025-09-03-grid-tilings/connected_tiles_graph.png" class="img-fluid figure-img"></p>
<figcaption>Connected Tiles</figcaption>
</figure>
</div>
</div>
</div>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
Example
</h2>
</center>
<hr>
<div id="7aa1d57b" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> grid_tilings</span>
<span id="cb7-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb7-3"></span>
<span id="cb7-4"></span>
<span id="cb7-5">mg <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> grid_tilings.Multigrid(seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-6">                            grid_count<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb7-7">                            grid_bounds<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>],</span>
<span id="cb7-8">                            rotation<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-9">                            base_point <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>],</span>
<span id="cb7-10">                            offsets<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>[<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.2</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.2</span>])</span>
<span id="cb7-11">mg.create_tiles()</span>
<span id="cb7-12"></span>
<span id="cb7-13">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots(figsize<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))</span>
<span id="cb7-14">ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> mg.draw_image(ax)</span>
<span id="cb7-15">plt.tight_layout()</span>
<span id="cb7-16">plt.show()</span></code></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2025-09-03-grid-tilings/image_graph.png" class="img-fluid figure-img"></p>
<figcaption>Final Image</figcaption>
</figure>
</div>



 ]]></description>
  <category>Python</category>
  <guid>https://www.williamtylerbradley.com/posts/2025-09-03-grid-tilings/</guid>
  <pubDate>Wed, 03 Sep 2025 04:00:00 GMT</pubDate>
  <media:content url="https://www.williamtylerbradley.com/posts/2025-09-03-grid-tilings/image_graph.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>Google Cloud - Cloud Digital Leader Certification Flashcards</title>
  <link>https://www.williamtylerbradley.com/posts/2025-06-21-gc-cloud-digital-leader-flashcards/</link>
  <description><![CDATA[ 





<p>I recently passed the Cloud Digital Leader certification from Google. I made a set of flash cards for it and posted them to GitHub. Here’s the <a href="https://github.com/WilliamTylerBradley/gcp_digital_leader_fc">link</a>. They can be imported into <a href="https://apps.ankiweb.net/">Anki</a>.</p>
<p>They could be improved. I wish I had made them more like the exam questions. For example, I have:</p>
<div class="grid">
<div class="g-col-2">

</div>
<div class="g-col-8">
<table class="caption-top table">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th>Latency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A measure of how long it takes a particular part of a system to return a result. It’s important because it directly affects the user experience, changes could indicate emerging issues. It’s values might be tied to capacity demands, and it can be used to measure system improvements.</td>
</tr>
</tbody>
</table>
</div>
<div class="g-col-2">

</div>
</div>
<p><br> I should have broken this up into:</p>
<div class="grid">
<div class="g-col-2">

</div>
<div class="g-col-8">
<table class="caption-top table">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th>What is latency?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A measure of how long it takes a particular part of a system to return a result.</td>
</tr>
</tbody>
</table>
</div>
<div class="g-col-2">

</div>
</div>
<div class="grid">
<div class="g-col-2">

</div>
<div class="g-col-8">
<table class="caption-top table">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th>What do you measure to test long it takes a particular part of a system to return a result?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Latency</td>
</tr>
</tbody>
</table>
</div>
<div class="g-col-2">

</div>
</div>
<div class="grid">
<div class="g-col-2">

</div>
<div class="g-col-8">
<table class="caption-top table">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th>Why is latecy important?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Because it directly affects the user experience, changes could indicate emerging issues</td>
</tr>
</tbody>
</table>
</div>
<div class="g-col-2">

</div>
</div>
<div class="grid">
<div class="g-col-2">

</div>
<div class="g-col-8">
<table class="caption-top table">
<colgroup>
<col style="width: 100%">
</colgroup>
<thead>
<tr class="header">
<th>What is measuring latecy useful for?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>It’s values might be tied to capacity demands, and it can be used to measure system improvements.</td>
</tr>
</tbody>
</table>
</div>
<div class="g-col-2">

</div>
</div>



 ]]></description>
  <category>Google Cloud</category>
  <guid>https://www.williamtylerbradley.com/posts/2025-06-21-gc-cloud-digital-leader-flashcards/</guid>
  <pubDate>Sat, 21 Jun 2025 04:00:00 GMT</pubDate>
  <media:content url="https://www.williamtylerbradley.com/posts/2025-06-21-gc-cloud-digital-leader-flashcards/gcp_dl_fc.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>Poisson Disk Sampling</title>
  <link>https://www.williamtylerbradley.com/posts/2024-11-11-poisson-disk-sampling/</link>
  <description><![CDATA[ 





<hr>
<center>
<h2 class="anchored">
Introduction
</h2>
</center>
<hr>
<p>This post goes through the code for a Python Poisson Disk Sampling package. The code comes from <a href="https://www.cs.ubc.ca/~rbridson/docs/bridson-siggraph07-poissondisk.pdf">Robert Bridson’s algorithm</a>. The posts from <a href="https://sighack.com/post/poisson-disk-sampling-bridsons-algorithm">Sighack</a> and <a href="https://www.jasondavies.com/poisson-disc/">Jason Davies</a> are also helpful resources to have.</p>
<p>Basically, we’ll start with one point then add another point within certain bounds from that one. We’ll continue adding new points off of these points and so on as long as the new points aren’t too close to any other point. When no new points can be added, the algorithm is done.</p>
<p>The points in this code will form a repeating pattern if allowed.</p>
<br>
<hr>
<center>
<h2 class="anchored">
Code
</h2>
</center>
<hr>
<p>We’ll start by importing the libraries.</p>
<div id="abdbc987" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> math</span>
<span id="cb1-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> random</span>
<span id="cb1-3"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> copy</span></code></pre></div>
</div>
<p>Then we’ll create a <code>Point</code> class. It’s basically just a holder for the location of a single point.</p>
<div id="5b28c184" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> Point:</span>
<span id="cb2-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Class for a singluar point</span></span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Attributes</span></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    ----------</span></span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    order: int</span></span>
<span id="cb2-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        The order the point was inserted into the class list</span></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    x: float</span></span>
<span id="cb2-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        x-location of the point</span></span>
<span id="cb2-11"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    y: float</span></span>
<span id="cb2-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        y-location of the point</span></span>
<span id="cb2-13"></span>
<span id="cb2-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb2-15"></span>
<span id="cb2-16">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>,</span>
<span id="cb2-17">                 order: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span>,</span>
<span id="cb2-18">                 x: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>,</span>
<span id="cb2-19">                 y: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb2-20">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb2-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Constructs a point</span></span>
<span id="cb2-22"></span>
<span id="cb2-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Parameters</span></span>
<span id="cb2-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        ----------</span></span>
<span id="cb2-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        order: int</span></span>
<span id="cb2-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            The order the point was inserted into the class list</span></span>
<span id="cb2-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        x: float</span></span>
<span id="cb2-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            x-location of the point</span></span>
<span id="cb2-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        y: float</span></span>
<span id="cb2-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            y-location of the point</span></span>
<span id="cb2-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb2-32">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.order <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> order</span>
<span id="cb2-33">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> x</span>
<span id="cb2-34">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> y</span>
<span id="cb2-35"></span>
<span id="cb2-36">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__repr__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>:</span>
<span id="cb2-37">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""repr for Point class"""</span></span>
<span id="cb2-38">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'Point(order=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>order<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, x=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, y=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">)'</span></span>
<span id="cb2-39"></span>
<span id="cb2-40">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__str__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">str</span>:</span>
<span id="cb2-41">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""str for Point class"""</span></span>
<span id="cb2-42">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">f'</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>order<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">: </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">, </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">{</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">.</span>y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">}</span><span class="ss" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb2-43"></span>
<span id="cb2-44">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> point_information(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>:</span>
<span id="cb2-45">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Returns the Point information as a list"""</span></span>
<span id="cb2-46">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.order, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.x, <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.y]</span></code></pre></div>
</div>
<p>Now, we’ll start to build up the main code section. First is the <code>PoissonDiskSampling</code> class. This will hold the main code for the algorithm. We’ll start out with the <code>__init__</code> method to set up the basic attributes.</p>
<p>We’ll need to keep track of:</p>
<ul>
<li><code>radius</code> to know how far to search around a point. This determines how close points are together.</li>
<li><code>grid_height</code> and <code>grid_width</code> to know how big of an area to fill.</li>
<li><code>sample_limit</code> to know when to stop trying for new points. This can affect how filled in the area gets.</li>
<li><code>seed</code> to make it reproducible.</li>
<li><code>initial_point</code> for an optional starting point.</li>
</ul>
<p>These attributes will be used to build the backgroud grid, <code>grid</code>. This is used to speed up comparing a potential point to the current list of accepted points, <code>points</code>. Finally, there will be a very similar list of points that are kept to anchor potential points, <code>active_list</code>.</p>
<div id="5cdecab8" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">class</span> PoissonDiskSampling:</span>
<span id="cb3-2">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Class for poisson disk sampling points</span></span>
<span id="cb3-4"></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Attributes</span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    ----------</span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    points: list</span></span>
<span id="cb3-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        The main list of points</span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb3-10">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">__init__</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>,</span>
<span id="cb3-11">                 radius: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>,</span>
<span id="cb3-12">                 grid_width: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>,</span>
<span id="cb3-13">                 grid_height: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>,</span>
<span id="cb3-14">                 sample_limit: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>,</span>
<span id="cb3-15">                 seed: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb3-16">                 inital_point: Point <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb3-17">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb3-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Constructor for the poisson disk sample</span></span>
<span id="cb3-19"></span>
<span id="cb3-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Parameters</span></span>
<span id="cb3-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        ----------</span></span>
<span id="cb3-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        radius: float</span></span>
<span id="cb3-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            The minimum distance between points</span></span>
<span id="cb3-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        grid_width: float</span></span>
<span id="cb3-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            The width of the grid</span></span>
<span id="cb3-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        grid_height: float</span></span>
<span id="cb3-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            The height of the grid</span></span>
<span id="cb3-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        sample_limit: int</span></span>
<span id="cb3-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            The number of times to try to find a new sample point for</span></span>
<span id="cb3-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            each attempt with an active point. Decreasing will speed up</span></span>
<span id="cb3-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            the process, but increasing will fill in more points.</span></span>
<span id="cb3-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        seed: int</span></span>
<span id="cb3-33"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            Seed for the random number generator, if needed.</span></span>
<span id="cb3-34"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        inital_point: Point</span></span>
<span id="cb3-35"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            Inital point to use. If one is not provided, then one is</span></span>
<span id="cb3-36"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">            choosen at random. This is mostly used for testing.</span></span>
<span id="cb3-37"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb3-38">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.radius <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> radius</span>
<span id="cb3-39">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> grid_width</span>
<span id="cb3-40">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> grid_height</span>
<span id="cb3-41">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.sample_limit <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> sample_limit</span>
<span id="cb3-42"></span>
<span id="cb3-43">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># These are called often in the code. So they are pre-calculated</span></span>
<span id="cb3-44">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cell_size: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.radius <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> math.sqrt(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb3-45">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.bounds: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> math.ceil(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.radius<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cell_size)  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 2</span></span>
<span id="cb3-46">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.wrap_cutoff <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.bounds<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb3-47">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_cell_width: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> math.ceil(</span>
<span id="cb3-48">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cell_size)</span>
<span id="cb3-49">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_cell_height: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> math.ceil(</span>
<span id="cb3-50">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cell_size)</span>
<span id="cb3-51">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.radius_2: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.radius)<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb3-52"></span>
<span id="cb3-53">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># These hold the points, one as a list and one as a 2d array.</span></span>
<span id="cb3-54">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># The grid has room to hold duplicated points on the edges to</span></span>
<span id="cb3-55">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># allow checking for point distance when the pattern repeats.</span></span>
<span id="cb3-56">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.points: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span>
<span id="cb3-57">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>[<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [</span>
<span id="cb3-58">            [<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> i <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_cell_height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.bounds<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)]</span>
<span id="cb3-59">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> j <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_cell_width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.bounds<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)]</span>
<span id="cb3-60"></span>
<span id="cb3-61">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This is list of point to sample from until they are checked</span></span>
<span id="cb3-62">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#  for the self.sample_limit attribute</span></span>
<span id="cb3-63">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.active_list: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> []</span></code></pre></div>
</div>
<p>We can finish up the rest of the <code>__init__</code> method that will sample all the points. It starts by determining the first point. Then uses a while loop to sample new points until all of the accepted points have been checked.</p>
<div id="0e401f20" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set up the start</span></span>
<span id="cb4-2">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> seed <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb4-3">            random.seed(seed)</span>
<span id="cb4-4"></span>
<span id="cb4-5">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> inital_point <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">is</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb4-6">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.insert_point(inital_point)</span>
<span id="cb4-7">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span>:</span>
<span id="cb4-8">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.insert_point(</span>
<span id="cb4-9">                Point(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-10">                      random.random() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_width,</span>
<span id="cb4-11">                      random.random() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_height))</span>
<span id="cb4-12"></span>
<span id="cb4-13">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Continue until all points are checked</span></span>
<span id="cb4-14">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Randomly pull a point that hasn't been removed each time</span></span>
<span id="cb4-15">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.active_list:</span>
<span id="cb4-16">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.sample(random.randrange(<span class="bu" style="color: null;
background-color: null;
font-style: inherit;">len</span>(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.active_list)))</span></code></pre></div>
</div>
<p>In the previous code block, the <code>sample</code> method is called in a while loop. We’ll now build up two other methods, <code>insert_point</code> and <code>check_neighbors</code>, to then get to <code>sample</code>.</p>
<p>The <code>insert_point</code> method takes a new point and inserts it into the <code>grid</code> and <code>points</code> list. The main difficulty is in checking the edges to have points repeat if needed.</p>
<div id="b622cf71" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> insert_point(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>,</span>
<span id="cb5-2">                     p: Point) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb5-3">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb5-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Inserts a new point into the self.points list and the self.grid</span></span>
<span id="cb5-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        array. If the point is near the edge, extra points will be added</span></span>
<span id="cb5-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        to the grid so the pattern can repeat itself without having</span></span>
<span id="cb5-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        points too close to each other.</span></span>
<span id="cb5-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        """</span></span>
<span id="cb5-9">        cell_x: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> math.floor(p.x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cell_size) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.bounds</span>
<span id="cb5-10">        cell_y: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> math.floor(p.y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cell_size) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.bounds</span>
<span id="cb5-11"></span>
<span id="cb5-12">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid[cell_x][cell_y] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> p</span>
<span id="cb5-13">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.points.append(p.point_information())</span>
<span id="cb5-14"></span>
<span id="cb5-15">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># If on the edges, loop around</span></span>
<span id="cb5-16">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check along sides</span></span>
<span id="cb5-17">        flip_x: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bool</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb5-18">        cell_x_wrap: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span></span>
<span id="cb5-19">        x_wrap: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span></span>
<span id="cb5-20">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> cell_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.wrap_cutoff:</span>
<span id="cb5-21">            flip_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb5-22">            cell_x_wrap <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_cell_width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> cell_x</span>
<span id="cb5-23">            x_wrap <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> p.x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_width</span>
<span id="cb5-24">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> cell_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_cell_width:</span>
<span id="cb5-25">            flip_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb5-26">            cell_x_wrap <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cell_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_cell_width</span>
<span id="cb5-27">            x_wrap <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> p.x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_width</span>
<span id="cb5-28"></span>
<span id="cb5-29">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> flip_x:</span>
<span id="cb5-30">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid[cell_x_wrap][cell_y] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Point(p.order, x_wrap, p.y)</span>
<span id="cb5-31"></span>
<span id="cb5-32">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check along top and bottom</span></span>
<span id="cb5-33">        flip_y: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bool</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb5-34">        cell_y_wrap: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span></span>
<span id="cb5-35">        y_wrap: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span></span>
<span id="cb5-36">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> cell_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.wrap_cutoff:</span>
<span id="cb5-37">            flip_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb5-38">            cell_y_wrap <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_cell_height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> cell_y</span>
<span id="cb5-39">            y_wrap <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> p.y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_height</span>
<span id="cb5-40">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">elif</span> cell_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_cell_height:</span>
<span id="cb5-41">            flip_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span>
<span id="cb5-42">            cell_y_wrap <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> cell_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_cell_height</span>
<span id="cb5-43">            y_wrap <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> p.y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid_height</span>
<span id="cb5-44"></span>
<span id="cb5-45">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> flip_y:</span>
<span id="cb5-46">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid[cell_x][cell_y_wrap] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Point(p.order, p.x, y_wrap)</span>
<span id="cb5-47"></span>
<span id="cb5-48">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check corners</span></span>
<span id="cb5-49">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> flip_x <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> flip_y:</span>
<span id="cb5-50">            <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid[cell_x_wrap][cell_y_wrap] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> Point(</span>
<span id="cb5-51">                p.order, x_wrap, y_wrap)</span>
<span id="cb5-52"></span>
<span id="cb5-53">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Insert into active list</span></span>
<span id="cb5-54">        <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.active_list.append(p)</span></code></pre></div>
</div>
<p>The <code>check_neighbors</code> method uses the <code>grid</code> to see if the new points is too close to any other points.</p>
<div id="83a25ddb" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> check_neighbors(<span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>,</span>
<span id="cb6-2">                        x: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>,</span>
<span id="cb6-3">                        y: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">bool</span>:</span>
<span id="cb6-4">        <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""Checks if there are any points too close a location."""</span></span>
<span id="cb6-5">        cell_x: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> math.floor(x<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cell_size) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.bounds</span>
<span id="cb6-6">        cell_y: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> math.floor(y<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.cell_size) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.bounds</span>
<span id="cb6-7"></span>
<span id="cb6-8">        column: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span></span>
<span id="cb6-9">        row: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span></span>
<span id="cb6-10">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> column <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(cell_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, cell_x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>):</span>
<span id="cb6-11">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> row <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(cell_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, cell_y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>):</span>
<span id="cb6-12">                neighbor: Point <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.grid[column][row]</span>
<span id="cb6-13">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> neighbor:</span>
<span id="cb6-14">                    dx: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> neighbor.x <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x</span>
<span id="cb6-15">                    dy: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> neighbor.y <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y</span>
<span id="cb6-16">                    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (dx<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> dy<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">**</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">self</span>.radius_2:</span>
<span id="cb6-17">                        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">False</span></span>
<span id="cb6-18"></span>
<span id="cb6-19">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">True</span></span></code></pre></div>
</div>
<p>The <code>sample</code> method takes in an index for a point from the <code>active_list</code>, pulls a new point around that point, and then checks to see if it’s good with <code>check_neighbors</code>. If it is good, then it calls <code>insert_point</code>. If enough attempts are made without adding a new point, the first point is removed from <code>active_list</code>.</p>
<p>Finally, the <code>sample_points</code> method pulls everything together and repeated the points pattern if requested.</p>
<div id="b93f10fb" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> sample_points(radius: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>,</span>
<span id="cb7-2">                  grid_width: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>,</span>
<span id="cb7-3">                  grid_height: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span>,</span>
<span id="cb7-4">                  sample_limit: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>,</span>
<span id="cb7-5">                  repeat_percentage: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">.25</span>,</span>
<span id="cb7-6">                  seed: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>,</span>
<span id="cb7-7">                  inital_point: Point <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-&gt;</span> <span class="va" style="color: #111111;
background-color: null;
font-style: inherit;">None</span>:</span>
<span id="cb7-8">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">"""</span></span>
<span id="cb7-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Creates a list of points from poisson disk sampling with optional</span></span>
<span id="cb7-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    repeats along the edges.</span></span>
<span id="cb7-11"></span>
<span id="cb7-12"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    Parameters</span></span>
<span id="cb7-13"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    ----------</span></span>
<span id="cb7-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    radius: float</span></span>
<span id="cb7-15"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        The minimum distance between points</span></span>
<span id="cb7-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    grid_width: float</span></span>
<span id="cb7-17"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        The width of the grid</span></span>
<span id="cb7-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    grid_height: float</span></span>
<span id="cb7-19"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        The height of the grid</span></span>
<span id="cb7-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    sample_limit: int</span></span>
<span id="cb7-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        The number of times to try to find a new sample point for</span></span>
<span id="cb7-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        each attempt with an active point. Decreasing will speed up</span></span>
<span id="cb7-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        the process, but increasing will fill in more points.</span></span>
<span id="cb7-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    repeat_percentage: float</span></span>
<span id="cb7-25"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        How much to repeat points around the borders. 0 for no repeats</span></span>
<span id="cb7-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        1 for full repeats.</span></span>
<span id="cb7-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    seed: int</span></span>
<span id="cb7-28"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Seed for the random number generator, if needed.</span></span>
<span id="cb7-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    inital_point: Point</span></span>
<span id="cb7-30"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        Inital point to use. If one is not provided, then one is</span></span>
<span id="cb7-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">        choosen at random. This is mostly used for testing.</span></span>
<span id="cb7-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">    """</span></span>
<span id="cb7-33">    samp: PoissonDiskSampling <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> PoissonDiskSampling(radius<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>radius,</span>
<span id="cb7-34">                                                    grid_width<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>grid_width,</span>
<span id="cb7-35">                                                    grid_height<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>grid_height,</span>
<span id="cb7-36">                                                    sample_limit<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>sample_limit,</span>
<span id="cb7-37">                                                    seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>seed,</span>
<span id="cb7-38">                                                    inital_point<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span>inital_point)</span>
<span id="cb7-39">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> repeat_percentage <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb7-40">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> samp.points</span>
<span id="cb7-41"></span>
<span id="cb7-42">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Find boundaries from repeat_percentage</span></span>
<span id="cb7-43">    width_min: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (grid_width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> repeat_percentage)</span>
<span id="cb7-44">    width_max: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> grid_width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (grid_width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> repeat_percentage)</span>
<span id="cb7-45">    height_min: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (grid_height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> repeat_percentage)</span>
<span id="cb7-46">    height_max: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">float</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> grid_height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (grid_height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> repeat_percentage)</span>
<span id="cb7-47"></span>
<span id="cb7-48">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Fill list with base points and copies for repetition</span></span>
<span id="cb7-49">    points: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> copy.deepcopy(samp.points)</span>
<span id="cb7-50"></span>
<span id="cb7-51">    column: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span></span>
<span id="cb7-52">    row: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">int</span></span>
<span id="cb7-53">    p: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span></span>
<span id="cb7-54">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> column <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>):</span>
<span id="cb7-55">        <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> row <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>):</span>
<span id="cb7-56">            <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> column <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">or</span> row <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>:</span>
<span id="cb7-57">                rep_points: <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">list</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> copy.deepcopy(samp.points)</span>
<span id="cb7-58">                <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> rep_points:</span>
<span id="cb7-59">                    p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> column <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> grid_width</span>
<span id="cb7-60">                    p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> row <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> grid_height</span>
<span id="cb7-61">                <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Check if the repeated points are in bounds</span></span>
<span id="cb7-62">                rep_points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> [p <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> p <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> rep_points</span>
<span id="cb7-63">                              <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> width_min</span>
<span id="cb7-64">                              <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> width_max</span>
<span id="cb7-65">                              <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> height_min</span>
<span id="cb7-66">                              <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">and</span> p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>] <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> height_max]</span>
<span id="cb7-67">                points.extend(rep_points)</span>
<span id="cb7-68"></span>
<span id="cb7-69">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> points</span></code></pre></div>
</div>
<p>A package for the code can be found <a href="https://github.com/WilliamTylerBradley/poisson_disk_sampling">here</a>.</p>
<div id="d32a4d10" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># install the package</span></span>
<span id="cb8-2">pip install git<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>https:<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">//</span>github.com<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>WilliamTylerBradley<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>poisson_disk_sampling</span></code></pre></div>
</div>
<p>Here’s some example code. The repetition of points is visible here.</p>
<div id="c697d0ce" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> matplotlib.pyplot <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> plt</span>
<span id="cb9-2"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> numpy <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> np</span>
<span id="cb9-3"></span>
<span id="cb9-4"><span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">import</span> PoissonDiskSampling <span class="im" style="color: #00769E;
background-color: null;
font-style: inherit;">as</span> pds</span>
<span id="cb9-5"></span>
<span id="cb9-6">height <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb9-7">width <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb9-8">radius <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb9-9"></span>
<span id="cb9-10">samp <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> pds.sample_points(radius, width, height, seed<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb9-11">points <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> np.array(samp)</span>
<span id="cb9-12"></span>
<span id="cb9-13">fig, ax <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> plt.subplots()</span>
<span id="cb9-14">ax.scatter(points[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], points[:, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>])</span>
<span id="cb9-15">ax.set_aspect(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'equal'</span>)</span>
<span id="cb9-16">plt.show()</span></code></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2024-11-11-poisson-disk-sampling/base_img.png" class="img-fluid figure-img"></p>
<figcaption>Example</figcaption>
</figure>
</div>



 ]]></description>
  <category>Python</category>
  <category>Generative Art</category>
  <guid>https://www.williamtylerbradley.com/posts/2024-11-11-poisson-disk-sampling/</guid>
  <pubDate>Mon, 11 Nov 2024 05:00:00 GMT</pubDate>
  <media:content url="https://www.williamtylerbradley.com/posts/2024-11-11-poisson-disk-sampling/base_img.png" medium="image" type="image/png" height="139" width="144"/>
</item>
<item>
  <title>Generative Art Twitter Bot with R and GitHub Actions</title>
  <link>https://www.williamtylerbradley.com/posts/2022-09-15-generative-art-twitter-bot-with-r-and-github-actions/</link>
  <description><![CDATA[ 





<hr>
<center>
<h2 class="anchored">
Introduction
</h2>
</center>
<hr>
<p><a href="https://twitter.com/flw_fld_fgmnts"><img src="https://www.williamtylerbradley.com/posts/2022-09-15-generative-art-twitter-bot-with-r-and-github-actions/twitter.png" class="img-fluid"></a></p>
<p>This blog post covers my experience making a generative art Twitter bot with GitHub Actions and R. You can click <a href="https://twitter.com/flw_fld_fgmnts">here</a> or on the image above to see it. I’ve thought about building an automated daily-ish thing to produce generative art, but I wanted something free/low cost, simple, and easily shared. I’ve seen several Twitter bots from R code for a platform, and Github Actions provides a great engine. So all the pieces can go together nicely.</p>
<p>This blog post is half tutorial/half list of mistakes I made and had to fix. So, it’s a little awkward. While you’re creating your work, I’d love for you to write better notes than this post and put them on your blog.</p>
<p>Speaking of other blog posts, the following posts helped me a ton. I’d highly recommend reading through them before this one. I’ll reference them throughout this piece.</p>
<ul>
<li><p><a href="https://www.rostrum.blog/2020/09/21/londonmapbot/">Matt Dray’s “A Twitter bot with {rtweet} and GitHub Actions” post</a></p></li>
<li><p><a href="https://github.com/jdjohn215/milwaukee-weather">John D. Johnson’s Automated Tufte-style weather graphs</a></p></li>
<li><p><a href="https://oscarbaruffa.com/twitterbot/">Oscar Baruffa’s “Tips for building a Twitter bot with R and Github Actions” post</a></p></li>
<li><p><a href="https://ryo-n7.github.io/2021-09-23-CanPL-GoogleDrive-GithubActions-Tutorial/">Ryo Nakagawara’s “Creating a data pipeline with Github Actions &amp; the {googledrive} package for the Canadian Premier League soccer data initiative!” post</a></p></li>
</ul>
<p>There are three pieces to making this work: R art code, a Twitter account, and setting up the GitHub Action. I’ll write about them in turn, and by the end, it’ll all work. I assume you’re familiar with Twitter terminology (tweet, post, etc.), have a GitHub account, and know how to push code to it.</p>
<br>
<hr>
<center>
<h2 class="anchored">
R art code
</h2>
</center>
<hr>
<p>You’ll need some R code that creates an output file for the art. This can be a simple script or a set of functions. <a href="https://art-from-code.netlify.app/">Danielle Navarro</a> and <a href="https://www.data-imaginist.com/">Thomas Lin Pedersen</a> are great resources if you need some help.</p>
<p>There are several options for the output files’ format. I used png for images and mp4 for animation. I initially used gifs for animation, but posting to Twitter sometimes made it look terrible. Many others have complained about this, so I encourage you to use an mp4 instead of a gif. You’ll want to double-check the options for Twitter and <code>rtweet</code> before writing the code. I use temporary files for the output, but you can save them somewhere. See <a href="https://github.com/jdjohn215/milwaukee-weather">John D. Johnson’s post</a> for an example of saving a new image daily. (Note: you might need to update the <code>rtweet</code> package to post mp4. <a href="https://github.com/ropensci/rtweet/issues/701">See this conversation</a>.)</p>
<p>If you’ve never made an R package, a generative art one is a great place to start.</p>
<ul>
<li><p><strong>It’s low stakes.</strong> If your math is wrong, but the image looks good, it’s totally fine. You don’t have to do intense testing or submit to CRAN. You can cut corners, and everything’s good as long as it runs.</p></li>
<li><p><strong>You’ll actually learn about package development.</strong> Unfortunately, copy-pasting code from a small “Hello World” example won’t teach you a lot about creating an R package. This project will probably cover dependencies, output files, and set up for automation. You can also create a <a href="https://williamtylerbradley.github.io/flowfieldfigments/">website</a>, hex-sticker, and documentation.</p></li>
<li><p><strong>It’s your special baby.</strong> No one else has the same project as you. It’s not like every other student in a class has a 99% copy. It’s fun because it’s definitely yours.</p></li>
</ul>
<p>If you have your art code in a separate file or package, you’ll need to write a code file to create the actual output. This file will probably include the code to post to Twitter.</p>
<p>If you’re using randomness generated from R, it’s good practice to set the seed (using set.seed or other capabilities). I used the current date in the “%Y%m%d” format for the seed (ex: 20220817). Then, if something breaks or looks bad, I can always recreate what happened because I have the seed saved.</p>
<p>You also might need to choose other parameters for your code. I used the date here, too but took modulo of the day of the year to loop through the options. For example, August 17, 2022, is the 229th day. Taking mod 2 of this number and adding one will flip between 1 and 2 as the date increases. This setup can be used to flip between two options. I had three sets of options: layout (three levels), colors (two levels), and output format (five levels). By using modulo, I can flip through all 30 options in order.</p>
<p>At this point, you should have code to produce your generative art into an output file. If you have the skills to do this, you have the skills to finish out the rest. The R code is the hardest part.</p>
<br>
<hr>
<center>
<h2 class="anchored">
Twitter Account
</h2>
</center>
<hr>
<p>I list creating the Twitter account as the second step. However, doing this first can help match all the names. I created the package as “flowfieldfigments” and later found out Twitter usernames cannot be longer than 15 characters. That’s why the Twitter account is “flw_fld_fgmnts” instead.</p>
<p>I had to log out of my other account to sign up for a new one. The process was pretty easy after that.</p>
<p>I used <a href="https://oscarbaruffa.com/twitterbot/">Oscar Baruffa’s</a> trick of adding “+something” to the end of my normal Gmail account. So instead of “gmailaccount.gmail.com”, I have “gmailaccount+twitterbot01.gmail.com”. This setup sent all the emails to the usual account without any issues.</p>
<p>You’ll need to add your phone number. I had an issue where I couldn’t use my usual phone number because it was associated with another account. So I had to take my number off my first account, use it for the new one, then, later on, take it off the new one, and add it back to the old one. You don’t have to add it back to the old one, but you’ll only receive texts for the associated account.</p>
<p>To build out a bot, you’ll need to sign up for a <a href="https://developer.twitter.com/en">Developer Account</a>. Then, you’ll need to fill out all the information according to your situation.</p>
<p>After creating the account, on the <a href="https://developer.twitter.com/en">Developer Portal</a>, you’ll need to apply for Elevated access. It says this can take a while, but it was under a minute for me. (If you don’t do this, you’ll end up with an error message like: “You currently have Essential access, which includes access to Twitter API v2 endpoints only. If you need access to this endpoint, you’ll need to apply for Elevated access via the Developer Portal. You can learn more <a href="https://developer.twitter.com/en/docs/twitter-api/getting-started/about-twitter-api#v2-access-leve">here</a>”.)</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-09-15-generative-art-twitter-bot-with-r-and-github-actions/elevated_access_screenshot.png" class="img-fluid figure-img"></p>
<figcaption>Elevated Access Screenshot</figcaption>
</figure>
</div>
<p>You’ll also need to set up your user authentication settings.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-09-15-generative-art-twitter-bot-with-r-and-github-actions/user_auth_1.png" class="img-fluid figure-img"></p>
<figcaption>User Authentication Settings Screenshot</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-09-15-generative-art-twitter-bot-with-r-and-github-actions/user_auth_2.png" class="img-fluid figure-img"></p>
<figcaption>QAUTH Settings Screenshot</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-09-15-generative-art-twitter-bot-with-r-and-github-actions/user_auth_3.png" class="img-fluid figure-img"></p>
<figcaption>General Authentication Settings Screenshot</figcaption>
</figure>
</div>
<p>For this next section, we’ll test posting tweets using R code. This will involve using keys to your account. After testing, you’ll move them to an appropriate location, but until then, don’t push any of this code to GitHub. You can find them on the Developer Portal under your Project, under “Keys and tokens”, then “Regenerate” under “API Key and Secret” and “Access Token and Secret”. Copy these into an R file like the following one.</p>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set up rtweet</span></span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rtweet)</span>
<span id="cb1-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vignette</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"auth"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">package =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"rtweet"</span>)</span>
<span id="cb1-4"></span>
<span id="cb1-5">auth <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rtweet<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rtweet_bot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">api_key =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"longstringofLETTERS&amp;numbers"</span>, </span>
<span id="cb1-6">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">api_secret =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SECONDlongstringofLETTERS&amp;numbers"</span>, </span>
<span id="cb1-7">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">access_token =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"THIRDlongstringofLETTERS&amp;numbers"</span>, </span>
<span id="cb1-8">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">access_secret =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FOURTHlongstringofLETTERS&amp;numbers"</span>)</span>
<span id="cb1-9">           </span>
<span id="cb1-10">rtweet<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">post_tweet</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">status =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This is a test tweet."</span></span>
<span id="cb1-11">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">token =</span> auth)</span></code></pre></div>
<p>Hopefully, if I’ve written everything correctly and you followed it accordingly, you should have a tweet on your bot’s account saying, “This is a test tweet.” after you run that code.</p>
<p>Now you can add your generative art. The following is the base code I used. For media, you’ll need to add alt text. For subsequent tweets, the status will have to change. I generate mine, so it changes every day. I saved this as <a href="https://github.com/WilliamTylerBradley/flowfieldfigmentsbot/blob/main/tweet_art.R">“tweet_art.R”</a>.</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rtweet)</span>
<span id="cb2-2"></span>
<span id="cb2-3">auth <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rtweet<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rtweet_bot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">api_key =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"longstringofLETTERS&amp;numbers"</span>, </span>
<span id="cb2-4">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">api_secret =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"SECONDlongstringofLETTERS&amp;numbers"</span>, </span>
<span id="cb2-5">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">access_token =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"THIRDlongstringofLETTERS&amp;numbers"</span>, </span>
<span id="cb2-6">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">access_secret =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FOURTHlongstringofLETTERS&amp;numbers"</span>)</span>
<span id="cb2-7">           </span>
<span id="cb2-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Generative art code</span></span>
<span id="cb2-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(flowfieldfigments)</span>
<span id="cb2-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.Date</span>(),<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%Y%m%d"</span>)))</span>
<span id="cb2-11"></span>
<span id="cb2-12">day <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">strftime</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.Date</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%j"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-13"></span>
<span id="cb2-14">seeds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb2-15">size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1500</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-16">anchor_layout <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"random"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spiral"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grid"</span>)[day <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb2-17">color_scheme <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"full"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"subset"</span>)[day <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb2-18">color_subset_center <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>)</span>
<span id="cb2-19">color_subset_width <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>)</span>
<span id="cb2-20">hue_turn <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>)</span>
<span id="cb2-21">alpha_taper <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"start"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"end"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"both"</span>)[day <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb2-22"></span>
<span id="cb2-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># I used a temp file, but you can save and pull it instead</span></span>
<span id="cb2-24">output_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tempfile</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fileext =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".png"</span>)</span>
<span id="cb2-25">flowfieldfigments<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create_png</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seeds =</span> seeds, </span>
<span id="cb2-26">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> size, </span>
<span id="cb2-27">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">anchor_layout =</span> anchor_layout, </span>
<span id="cb2-28">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hue_turn =</span> hue_turn, </span>
<span id="cb2-29">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_scheme =</span> color_scheme,</span>
<span id="cb2-30">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_subset_center =</span> color_subset_center, </span>
<span id="cb2-31">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_subset_width =</span> color_subset_width,</span>
<span id="cb2-32">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha_taper =</span> alpha_taper, </span>
<span id="cb2-33">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">output_file =</span> output_file)</span>
<span id="cb2-34"></span>
<span id="cb2-35">status <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"set.seed("</span>, seed, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span>)</span>
<span id="cb2-36">alt_text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Generative art featuring flow fields. Paths are various colors on a white background."</span></span>
<span id="cb2-37">rtweet<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">post_tweet</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">status =</span> status,</span>
<span id="cb2-38">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">media =</span> output_file,</span>
<span id="cb2-39">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">token =</span> auth,</span>
<span id="cb2-40">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">media_alt_text =</span> alt_text)</span></code></pre></div>
<p>At this point, you should be able to post your generative art to your bot’s Twitter account. You’ll want to try out a lot of the options to make sure your output looks good. I’ve noticed videos can be grainy, but refreshing the page can fix it.</p>
<br>
<hr>
<center>
<h2 class="anchored">
GitHub
</h2>
</center>
<hr>
<p>For the rest of the work, you’ll automate the process using <a href="https://docs.github.com/en/actions">GitHub Actions</a>. To do this, you’ll have to push all your code/setup onto GitHub’s computers and tell them to run it.</p>
<p>To get GitHub to run everything, you’ll need to give:</p>
<ul>
<li><p>Keys to your Twitter account</p></li>
<li><p>A file for setting up what you need to run the code file</p></li>
<li><p>A code file to run</p></li>
</ul>
<p>You’ll need to create a blank <a href="https://github.com/WilliamTylerBradley/flowfieldfigmentsbot">GitHub repository</a> or one based on the R project you’re using (but make sure NOT to push up the code file with your Twitter keys!).</p>
<section id="keys-to-your-twitter-account" class="level3">
<h3 class="anchored" data-anchor-id="keys-to-your-twitter-account">Keys to your Twitter account</h3>
<p>To give your bot’s keys to GitHub, you’ll save the “longstringofLETTERS&amp;numbers” from your R code to GitHub Actions secrets. These are under your repo’s “Settings” on the top ribbon, then under “Security” on the left side panel, then “Secrets”, then “Actions”. You’ll add a new repository secret (click “New Repository Secret) for each of the <code>rtweet::rtweet_bot</code>’s parameters (<code>api_key</code>, <code>api_secret</code>, <code>access_token</code>, and <code>access_secret</code>). I added a prefix to each of the names with the appropriate title. This way, I can use similar names for other Twitter bots. The”longstringofLETTERS&amp;numbers” goes in the “Secret*” box. Make sure you don’t add any whitespace to the front or back.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-09-15-generative-art-twitter-bot-with-r-and-github-actions/secrets.png" class="img-fluid figure-img"></p>
<figcaption>Secrets Screenshot</figcaption>
</figure>
</div>
<p>Now, go back to the code file and update it to use the GitHub Secrets. All you have to do is replace the “longstringofLETTERS&amp;numbers” with “Sys.getenv(”SecretName”)“.</p>
<p>You should be able to test it out with a small test file like this one (or just cut straight to your main file). I found running a small test file was way easier to debug. So, that’s what I recommend. Save this as “test.R” or something.</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#...</span></span>
<span id="cb3-2">auth <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rtweet<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rtweet_bot</span>(</span>
<span id="cb3-3">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">api_key =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.getenv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FFF_TWITTER_API_KEY"</span>),</span>
<span id="cb3-4">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">api_secret =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.getenv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FFF_TWITTER_API_KEY_SECRET"</span>),</span>
<span id="cb3-5">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">access_token =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.getenv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FFF_TWITTER_ACCESS_TOKEN"</span>),</span>
<span id="cb3-6">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">access_secret =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.getenv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FFF_TWITTER_ACCESS_TOKEN_SECRET"</span>)</span>
<span id="cb3-7">)</span>
<span id="cb3-8"></span>
<span id="cb3-9">rtweet<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">post_tweet</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">status =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"This is a test tweet again."</span>,</span>
<span id="cb3-10">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">token =</span> auth)</span></code></pre></div>
</section>
<section id="a-file-for-setting-up-what-you-need-to-run-the-code-file" class="level3">
<h3 class="anchored" data-anchor-id="a-file-for-setting-up-what-you-need-to-run-the-code-file">A file for setting up what you need to run the code file</h3>
<p>Now you’re going to set up the file for using GitHub Actions. I went to “Actions” under the repo’s top ribbon, then used the “Set up workflow yourself” option. You’ll want to create a file like this one:</p>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> flowfieldfigmentsbot</span></span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">on</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb4-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">workflow_dispatch</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb4-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span></span>
<span id="cb4-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">jobs</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb4-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flowfieldsfigmentbot-post</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb4-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runs-on</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> macOS-latest</span></span>
<span id="cb4-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">env</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb4-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GITHUB_PAT</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.GITHUB_TOKEN }}</span></span>
<span id="cb4-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FFF_TWITTER_API_KEY</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.FFF_TWITTER_API_KEY }}</span></span>
<span id="cb4-11"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FFF_TWITTER_API_KEY_SECRET</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.FFF_TWITTER_API_KEY_SECRET }}</span></span>
<span id="cb4-12"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FFF_TWITTER_ACCESS_TOKEN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.FFF_TWITTER_ACCESS_TOKEN }}</span></span>
<span id="cb4-13"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FFF_TWITTER_ACCESS_TOKEN_SECRET</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.FFF_TWITTER_ACCESS_TOKEN_SECRET }}</span></span>
<span id="cb4-14"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">steps</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb4-15"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uses</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> actions/checkout@main</span></span>
<span id="cb4-16"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uses</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> r-lib/actions/setup-r@v2</span></span>
<span id="cb4-17"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Install rtweet package</span></span>
<span id="cb4-18"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">run</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Rscript -e 'install.packages("rtweet", dependencies = TRUE)'</span></span>
<span id="cb4-19"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Create and post tweet</span></span>
<span id="cb4-20"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">run</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Rscript test.R</span></span></code></pre></div>
<p>(You might have to pull the changes into your local repo, add the file, then push it up, but I can’t remember exactly. Somehow you need to end up with a similar file in your repo, under the .github/workflows folder.)</p>
<p>I named this file “main.yml”. The <code>name</code> of the workflow is “flowfieldfigmentsbot”. The <code>on: workflow_dispatch:</code> allows you to click a button to run. We’ll update this to run on a schedule later.</p>
<p>I used <code>macOS-latest</code> for the environment because I developed it on a mac. Feel free to change the <a href="https://docs.github.com/en/actions/using-github-hosted-runners/about-github-hosted-runners">runner image</a>.</p>
<p>The <code>env:</code> information must match what you saved in the GitHub Secrets AND what you wrote in the “test.R” file for the part before the colon. GitHub accesses your Twitter account keys and passes them to R using these lines. I named mine the same for both parts for simplicity, but that’s not required.</p>
<p>The <code>steps:</code> section accesses the repo, sets up R, installs <code>rtweet</code>, and runs the code in “test.R”.</p>
<p>To test everything, under “Actions” there should be an option under “Workflows” for your code. Click “Run workflow” to get it started. Sometimes it takes a few minutes. So make sure to chill out a second instead of clicking it a bunch of times.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-09-15-generative-art-twitter-bot-with-r-and-github-actions/actions.png" class="img-fluid figure-img"></p>
<figcaption>Actions Screenshot</figcaption>
</figure>
</div>
<p>Your bot’s Twitter account should have a new “This is a test tweet again.” tweet. If you try this again without changing the message, you’ll probably get an error about creating tweets with the same status in a row.</p>
<p>If you get a “Could not authenticate you.” error code 32 message, you missed adding the “GITHUB_PAT: ${{ secrets.GITHUB_TOKEN }}” line.</p>
</section>
<section id="a-code-file-to-run" class="level3">
<h3 class="anchored">A code file to run</h3>
<p>Now, you need to add the generative art piece back. For this example, I added <code>devtools</code> to install the package from GitHub. This way, GitHub has access to the generative art code. If you’re using a script instead, you can copy-paste in the code, <code>source</code> it, or run it in this file.</p>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(rtweet)</span>
<span id="cb5-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(devtools)</span>
<span id="cb5-3"></span>
<span id="cb5-4">devtools<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">install_github</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WilliamTylerBradley/flowfieldfigments"</span>)</span>
<span id="cb5-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(flowfieldfigments)</span>
<span id="cb5-6"></span>
<span id="cb5-7">auth <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> rtweet<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rtweet_bot</span>(</span>
<span id="cb5-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">api_key =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.getenv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FFF_TWITTER_API_KEY"</span>),</span>
<span id="cb5-9">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">api_secret =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.getenv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FFF_TWITTER_API_KEY_SECRET"</span>),</span>
<span id="cb5-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">access_token =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.getenv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FFF_TWITTER_ACCESS_TOKEN"</span>),</span>
<span id="cb5-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">access_secret =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.getenv</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"FFF_TWITTER_ACCESS_TOKEN_SECRET"</span>)</span>
<span id="cb5-12">)</span>
<span id="cb5-13"></span>
<span id="cb5-14">seed <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">format</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.Date</span>(),<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%Y%m%d"</span>))</span>
<span id="cb5-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(seed)</span>
<span id="cb5-16"></span>
<span id="cb5-17">day <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">strftime</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">Sys.Date</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">format =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"%j"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-18"></span>
<span id="cb5-19">seeds <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb5-20">size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1500</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-21">anchor_layout <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"random"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"spiral"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"grid"</span>)[day <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb5-22">color_scheme <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"full"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"subset"</span>)[day <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb5-23">color_subset_center <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>)</span>
<span id="cb5-24">color_subset_width <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>)</span>
<span id="cb5-25">hue_turn <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>)</span>
<span id="cb5-26">media <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"png"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gif"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"png"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"gif"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"png"</span>)[day <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb5-27">movement <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"march"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"glide"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)[day <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb5-28">alpha_taper <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"start"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"end"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"both"</span>)[day <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb5-29"></span>
<span id="cb5-30"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span>(media <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"png"</span>) {</span>
<span id="cb5-31">  output_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tempfile</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fileext =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".png"</span>)</span>
<span id="cb5-32">  </span>
<span id="cb5-33">  flowfieldfigments<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create_png</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seeds =</span> seeds, </span>
<span id="cb5-34">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> size, </span>
<span id="cb5-35">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">anchor_layout =</span> anchor_layout, </span>
<span id="cb5-36">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hue_turn =</span> hue_turn, </span>
<span id="cb5-37">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_scheme =</span> color_scheme,</span>
<span id="cb5-38">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_subset_center =</span> color_subset_center, </span>
<span id="cb5-39">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_subset_width =</span> color_subset_width,</span>
<span id="cb5-40">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha_taper =</span> alpha_taper, </span>
<span id="cb5-41">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">output_file =</span> output_file)</span>
<span id="cb5-42">} <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb5-43">  output_file <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tempfile</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fileext =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".gif"</span>)</span>
<span id="cb5-44">  </span>
<span id="cb5-45">  flowfieldfigments<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create_gif</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">seeds =</span> seeds, </span>
<span id="cb5-46">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> size, </span>
<span id="cb5-47">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">anchor_layout =</span> anchor_layout, </span>
<span id="cb5-48">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hue_turn =</span> hue_turn, </span>
<span id="cb5-49">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_scheme =</span> color_scheme,</span>
<span id="cb5-50">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_subset_center =</span> color_subset_center, </span>
<span id="cb5-51">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_subset_width =</span> color_subset_width,</span>
<span id="cb5-52">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">movement =</span> movement, </span>
<span id="cb5-53">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">output_file =</span> output_file)</span>
<span id="cb5-54">}</span>
<span id="cb5-55"></span>
<span id="cb5-56">status <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"set.seed("</span>, seed, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">")"</span>)</span>
<span id="cb5-57">alt_text <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Generative art featuring flow fields. Paths are various colors on a white background."</span></span>
<span id="cb5-58">rtweet<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">post_tweet</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">status =</span> status,</span>
<span id="cb5-59">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">media =</span> output_file,</span>
<span id="cb5-60">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">token =</span> auth,</span>
<span id="cb5-61">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">media_alt_text =</span> alt_text)</span></code></pre></div>
<p>You might need to add a line to install <code>devtools</code> for the YAML file.</p>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb6-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> flowfieldfigmentsbot</span></span>
<span id="cb6-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">on</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb6-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">workflow_dispatch</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb6-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span></span>
<span id="cb6-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">jobs</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb6-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flowfieldsfigmentbot-post</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb6-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runs-on</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> macOS-latest</span></span>
<span id="cb6-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">env</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb6-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GITHUB_PAT</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.GITHUB_TOKEN }}</span></span>
<span id="cb6-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FFF_TWITTER_API_KEY</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.FFF_TWITTER_API_KEY }}</span></span>
<span id="cb6-11"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FFF_TWITTER_API_KEY_SECRET</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.FFF_TWITTER_API_KEY_SECRET }}</span></span>
<span id="cb6-12"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FFF_TWITTER_ACCESS_TOKEN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.FFF_TWITTER_ACCESS_TOKEN }}</span></span>
<span id="cb6-13"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FFF_TWITTER_ACCESS_TOKEN_SECRET</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.FFF_TWITTER_ACCESS_TOKEN_SECRET }}</span></span>
<span id="cb6-14"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">steps</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb6-15"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uses</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> actions/checkout@v2</span></span>
<span id="cb6-16"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uses</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> r-lib/actions/setup-r@v2</span></span>
<span id="cb6-17"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Install rtweet package</span></span>
<span id="cb6-18"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">run</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Rscript -e 'install.packages("rtweet")'</span></span>
<span id="cb6-19"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Install devtools package</span></span>
<span id="cb6-20"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">run</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Rscript -e 'install.packages("devtools")'</span></span>
<span id="cb6-21"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Create and post tweet</span></span>
<span id="cb6-22"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">run</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Rscript tweet_art.R</span></span></code></pre></div>
<p>You can test this using the same method of clicking “Run workflow”. Hopefully, the bot posted your art to Twitter. Depending on your setup, you’ll have to play around with issues until it works.</p>
<p>The final part is setting up the schedule. You’ll do this by changing the <code>workflow_dispatch:</code> line in the YAML file to a <code>schedule:</code> and adding a <a href="https://crontab.guru/every-weekday">cron expression</a>. I really wanted the bot to post at a random time each day, but I couldn’t figure out a clean setup for that. So I picked random-ish times throughout the day. GitHub Actions run on UTC, so I needed to add 5 hours to my EST time (or 4 for EDT). I use the date for the seed, so I needed to make sure every time was a different date on UTC and different on EST. You need to watch your edge case if you care about that. Also, it takes a little while for the GitHub Action to run, so posts often occur later.</p>
<div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> flowfieldfigmentsbot</span></span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">on</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb7-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">schedule</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb7-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cron</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'38 20 * * 0'</span></span>
<span id="cb7-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cron</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'34 16 * * 1'</span></span>
<span id="cb7-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cron</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'24 13 * * 2'</span></span>
<span id="cb7-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cron</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'54 21 * * 3'</span></span>
<span id="cb7-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cron</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'12 22 * * 4'</span></span>
<span id="cb7-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cron</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'7 19 * * 5'</span></span>
<span id="cb7-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cron</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'45 18 * * 6'</span></span>
<span id="cb7-11"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span></span>
<span id="cb7-12"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">jobs</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb7-13"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flowfieldsfigmentbot-post</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb7-14"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runs-on</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> macOS-latest</span></span>
<span id="cb7-15"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">env</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb7-16"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GITHUB_PAT</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.GITHUB_TOKEN }}</span></span>
<span id="cb7-17"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FFF_TWITTER_API_KEY</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.FFF_TWITTER_API_KEY }}</span></span>
<span id="cb7-18"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FFF_TWITTER_API_KEY_SECRET</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.FFF_TWITTER_API_KEY_SECRET }}</span></span>
<span id="cb7-19"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FFF_TWITTER_ACCESS_TOKEN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.FFF_TWITTER_ACCESS_TOKEN }}</span></span>
<span id="cb7-20"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FFF_TWITTER_ACCESS_TOKEN_SECRET</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.FFF_TWITTER_ACCESS_TOKEN_SECRET }}</span></span>
<span id="cb7-21"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">steps</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb7-22"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uses</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> actions/checkout@v2</span></span>
<span id="cb7-23"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uses</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> r-lib/actions/setup-r@v2</span></span>
<span id="cb7-24"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Install rtweet package</span></span>
<span id="cb7-25"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">run</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Rscript -e 'install.packages("rtweet")'</span></span>
<span id="cb7-26"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Install devtools package</span></span>
<span id="cb7-27"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">run</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Rscript -e 'install.packages("devtools")'</span></span>
<span id="cb7-28"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Create and post tweet</span></span>
<span id="cb7-29"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">run</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Rscript tweet_art.R</span></span></code></pre></div>
<p>These times should match:</p>
<p>Sunday 3:38 pm <br> Monday 11:34 am <br> Tuesday 9:24 am <br> Wednesday 4:54 pm <br> Thursday 5:12 pm <br> Friday 2:07 pm <br> Saturday 1:45 pm</p>
<p>So now, your bot should be automatically posting generative art on your schedule!</p>
<br>
<hr>
<center>
<h2 class="anchored" data-anchor-id="a-code-file-to-run">
Bonus
</h2>
</center>
<hr>
<p>You should be good to go at this point. However, there are a ton of options to speed up the process or add features. I picked a couple of them to try.</p>
</section>
<section id="add-a-timeout-option" class="level3">
<h3 class="anchored" data-anchor-id="add-a-timeout-option">Add a timeout option</h3>
<p>You can add an option to stop if the code takes too long. GitHub emails an error when this occurs so that you can check the code. You need to add the number of minutes this should take to the YAML file.</p>
<div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb8-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#...</span></span>
<span id="cb8-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">jobs</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb8-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flowfieldsfigmentbot-post</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb8-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runs-on</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> macOS-latest</span></span>
<span id="cb8-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">timeout-minutes</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span></span>
<span id="cb8-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#...    </span></span></code></pre></div>
<p>Note: the time includes setup, creating the art, and posting, not just creating the art.</p>
</section>
<section id="use-linux-for-the-runner" class="level3">
<h3 class="anchored" data-anchor-id="use-linux-for-the-runner">Use Linux for the runner</h3>
<p>The Linux options are cheaper for private repositories. You’ll need to change out <code>runs-on:</code> in the YAML file and add some new calls for libraries. I think I needed these for using the mp4 output files and installing R packages. The libraries you need might be different.</p>
<div class="sourceCode" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb9-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#...</span></span>
<span id="cb9-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">jobs</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb9-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flowfieldsfigmentbot-post</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb9-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runs-on</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ubuntu-latest</span></span>
<span id="cb9-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">timeout-minutes</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb9-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">env</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb9-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GITHUB_PAT</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.GITHUB_TOKEN }}</span></span>
<span id="cb9-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FFF_TWITTER_API_KEY</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.FFF_TWITTER_API_KEY }}</span></span>
<span id="cb9-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FFF_TWITTER_API_KEY_SECRET</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.FFF_TWITTER_API_KEY_SECRET }}</span></span>
<span id="cb9-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FFF_TWITTER_ACCESS_TOKEN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.FFF_TWITTER_ACCESS_TOKEN }}</span></span>
<span id="cb9-11"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FFF_TWITTER_ACCESS_TOKEN_SECRET</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.FFF_TWITTER_ACCESS_TOKEN_SECRET }}</span></span>
<span id="cb9-12"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">steps</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb9-13"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uses</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> actions/checkout@v2</span></span>
<span id="cb9-14"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> install libavfilter-dev</span></span>
<span id="cb9-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">        run</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">: </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">|</span></span>
<span id="cb9-16">          sudo apt-get update</span>
<span id="cb9-17">          sudo apt-get install libavfilter-dev</span>
<span id="cb9-18"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Install libcurl and libssl on Linux</span></span>
<span id="cb9-19"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">run</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sudo apt-get -y install libcurl4-openssl-dev'</span></span>
<span id="cb9-20"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shell</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> bash</span></span>
<span id="cb9-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#...</span></span></code></pre></div>
</section>
<section id="add-renv-for-caching" class="level3">
<h3 class="anchored" data-anchor-id="add-renv-for-caching">Add <code>renv</code> for caching</h3>
<p>You can use the <code>renv</code> package to cache everything.</p>
<p>You’ll need to run similar code in your R project and then push your project to GitHub to save everything.</p>
<div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(renv)</span>
<span id="cb10-2">renv<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">init</span>()</span>
<span id="cb10-3">renv<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">snapshot</span>()</span></code></pre></div>
<p>Then in your YAML file, you need to add information to call the <code>actions/cache@v3</code> action. Again, there are several different ways to set this up, so search the internet.</p>
<div class="sourceCode" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb11-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#...</span></span>
<span id="cb11-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">jobs</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb11-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">flowfieldsfigmentbot-post</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb11-4"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runs-on</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ubuntu-latest</span></span>
<span id="cb11-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">timeout-minutes</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb11-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">env</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb11-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">GITHUB_PAT</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.GITHUB_TOKEN }}</span></span>
<span id="cb11-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FFF_TWITTER_API_KEY</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.FFF_TWITTER_API_KEY }}</span></span>
<span id="cb11-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FFF_TWITTER_API_KEY_SECRET</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.FFF_TWITTER_API_KEY_SECRET }}</span></span>
<span id="cb11-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FFF_TWITTER_ACCESS_TOKEN</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.FFF_TWITTER_ACCESS_TOKEN }}</span></span>
<span id="cb11-11"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">FFF_TWITTER_ACCESS_TOKEN_SECRET</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ secrets.FFF_TWITTER_ACCESS_TOKEN_SECRET }}</span></span>
<span id="cb11-12"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">steps</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb11-13"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uses</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> actions/checkout@v2</span></span>
<span id="cb11-14"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> install libavfilter-dev</span></span>
<span id="cb11-15"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">        run</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">: </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">|</span></span>
<span id="cb11-16">          sudo apt-get update</span>
<span id="cb11-17">          sudo apt-get install libavfilter-dev</span>
<span id="cb11-18"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Install libcurl and libssl on Linux</span></span>
<span id="cb11-19"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">run</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'sudo apt-get -y install libcurl4-openssl-dev'</span></span>
<span id="cb11-20"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shell</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> bash</span></span>
<span id="cb11-21"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uses</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> r-lib/actions/setup-r@v2</span></span>
<span id="cb11-22"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb11-23"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">use-public-rspm</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">true</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span></span>
<span id="cb11-24"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Set RENV_PATHS_ROOT</span></span>
<span id="cb11-25"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shell</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> bash</span></span>
<span id="cb11-26"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">        run</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">: </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">|</span></span>
<span id="cb11-27">          echo "RENV_PATHS_ROOT=${{ runner.temp }}/renv" &gt;&gt; $GITHUB_ENV</span>
<span id="cb11-28"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Install and activate renv</span></span>
<span id="cb11-29"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">        run</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">: </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">|</span></span>
<span id="cb11-30">          if (!requireNamespace("renv", quietly = TRUE)) install.packages("renv")</span>
<span id="cb11-31">          renv::activate()</span>
<span id="cb11-32"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shell</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Rscript {0}</span></span>
<span id="cb11-33"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Get R and OS version</span></span>
<span id="cb11-34"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">id</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> get-version</span></span>
<span id="cb11-35"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">        run</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">: </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">|</span></span>
<span id="cb11-36">          cat("##[set-output name=os-version;]", sessionInfo()$running, "\n", sep = "")</span>
<span id="cb11-37">          cat("##[set-output name=r-version;]", R.Version()$version.string, sep = "")</span>
<span id="cb11-38"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shell</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Rscript {0}</span></span>
<span id="cb11-39"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Restore Renv package cache</span></span>
<span id="cb11-40"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">uses</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> actions/cache@v3</span></span>
<span id="cb11-41"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">with</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span></span>
<span id="cb11-42"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">path</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ env.RENV_PATHS_ROOT }}</span></span>
<span id="cb11-43"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">key</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ steps.get-version.outputs.os-version }}-${{ steps.get-version.outputs.r-version }}-${{ inputs.cache-version }}-${{ hashFiles('renv.lock') }}</span></span>
<span id="cb11-44"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">          </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">restore-keys</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> ${{ steps.get-version.outputs.os-version }}-${{ steps.get-version.outputs.r-version }}-${{inputs.cache-version }}-</span></span>
<span id="cb11-45"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Restore packages</span></span>
<span id="cb11-46"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shell</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Rscript {0}</span></span>
<span id="cb11-47"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">        run</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">: </span><span class="ch" style="color: #20794D;
background-color: null;
font-style: inherit;">|</span></span>
<span id="cb11-48">          renv::restore()</span>
<span id="cb11-49"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">      </span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">-</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">name</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Create and post tweet</span></span>
<span id="cb11-50"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">        </span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">run</span><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">:</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> Rscript tweet_art.R</span></span></code></pre></div>
<p>The <code>Set RENV_PATHS_ROOT</code> step provides information to the <code>Install and activate renv</code> step that sets up <code>renv</code>. Next, the <code>Get R and OS version</code> step provides information for the <code>Restore Renv package cache</code> step to tell GitHub to use the cache. Finally, the <code>Restore packages</code> step uses <code>renv</code> to access the saved information. Part of this code looks up the runner system. That was useful when I switched between <code>mac-os-latest</code> and <code>ubuntu-latest</code>. So you might not need the exact same code.</p>
<p>Sometimes when you make enough changes, the cache needs to be reset (or the first time you try this). You’ll get an error message in the logs like ‘Cache not found for input keys:’. Your code is probably fine; it just needs to reload everything. This will take longer than regular runs. So make sure your time-out option accounts for that.</p>
<hr>
<p>Creating an automated process for generative art is a big step for an artist. There’s no curation, so everything coded to happen can happen. Tyler Hobbs’ <a href="https://tylerxhobbs.com/essays/2021/the-rise-of-long-form-generative-art">“The Rise of Long-Form Generative Art”</a> covers this topic, and now you can experience it firsthand.</p>


</section>

 ]]></description>
  <category>R</category>
  <category>Generative Art</category>
  <guid>https://www.williamtylerbradley.com/posts/2022-09-15-generative-art-twitter-bot-with-r-and-github-actions/</guid>
  <pubDate>Thu, 15 Sep 2022 04:00:00 GMT</pubDate>
  <media:content url="https://www.williamtylerbradley.com/posts/2022-09-15-generative-art-twitter-bot-with-r-and-github-actions/flowfieldfigments.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>Circuitry</title>
  <link>https://www.williamtylerbradley.com/posts/2022-05-28-circuitry/</link>
  <description><![CDATA[ 





<hr>
<center>
<h2 class="anchored">
Background
</h2>
</center>
<hr>
<p>This small generative art project uses code from my previous work. I really liked the looped path objects and decided to try something else with them. This work expands the loop a little, adds a randomly generated color scheme, and uses a standard image style.</p>
<br>
<hr>
<center>
<h2 class="anchored">
Code
</h2>
</center>
<hr>
<p>The first function is <code>get_maze</code>. This code creates a maze from a <code>size</code>-by-<code>size</code> grid. The final code uses a base <code>size</code> of ten. The maze starts at the bottom middle and randomly adds edges.</p>
<div class="cell">
<details class="code-fold">
<summary>[<code>get_maze</code> function]</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">get_maze <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(size) {</span>
<span id="cb1-2">  </span>
<span id="cb1-3">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sets up base data set of potential edges for the maze</span></span>
<span id="cb1-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># size is always 5 for right now</span></span>
<span id="cb1-5">  edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">CJ</span>(</span>
<span id="cb1-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, size), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb1-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, size)</span>
<span id="cb1-8">  )</span>
<span id="cb1-9">  edges[, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(.I <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, x1),</span>
<span id="cb1-10">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(.I <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, y1))]</span>
<span id="cb1-11">  edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> edges[x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> size, ]</span>
<span id="cb1-12">  edges[, id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(edges))]</span>
<span id="cb1-13">  edges[, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">node1 =</span> (x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb1-14">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">node2 =</span> (x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)]</span>
<span id="cb1-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setkey</span>(edges, id)</span>
<span id="cb1-16">  </span>
<span id="cb1-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># data set of nodes</span></span>
<span id="cb1-18">  nodes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(edges[, .(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> node1)], edges[, .(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> node2)]))</span>
<span id="cb1-19">  nodes[, connected <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb1-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setkey</span>(nodes, id)</span>
<span id="cb1-21">  </span>
<span id="cb1-22">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># data set of node id to edge ids</span></span>
<span id="cb1-23">  nodes_edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(edges[, .(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> node1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">edge =</span> id)][], </span>
<span id="cb1-24">                              edges[, .(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> node2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">edge =</span> id)]))</span>
<span id="cb1-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setkey</span>(nodes_edges, id)</span>
<span id="cb1-26">  </span>
<span id="cb1-27">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># location : 1 for maze, 0 for frontier, -1 for uncharted, -2 for discarded</span></span>
<span id="cb1-28">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># starting point : bottom middle</span></span>
<span id="cb1-29">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># include bottom middle then either off to the sides or up</span></span>
<span id="cb1-30">  starting_edge <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> edges[(x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span></span>
<span id="cb1-31">                           (x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), ][<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(.N, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), ]</span>
<span id="cb1-32">  </span>
<span id="cb1-33">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set up base columns</span></span>
<span id="cb1-34">  edges[, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">location =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb1-35">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probability =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)]</span>
<span id="cb1-36">  edges[.(starting_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>id), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">location =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb1-37">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probability =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)]</span>
<span id="cb1-38">  nodes[.(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(starting_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>node1, starting_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>node2)), connected <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb1-39">  edges[.(nodes_edges[.(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(starting_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>node1, starting_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>node2)), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"edge"</span>]), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span></span>
<span id="cb1-40">        (<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">location =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fifelse</span>(location <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, location),</span>
<span id="cb1-41">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probability =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fifelse</span>(location <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, probability))]</span>
<span id="cb1-42">  </span>
<span id="cb1-43">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#### Loop through maze generation ----</span></span>
<span id="cb1-44">  num_edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-45">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> (num_edges <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> (size<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) {</span>
<span id="cb1-46">    </span>
<span id="cb1-47">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># select next edge</span></span>
<span id="cb1-48">    selected_edge <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> edges[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(.N, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> probability), ]</span>
<span id="cb1-49">    </span>
<span id="cb1-50">    <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## if it's good, then</span></span>
<span id="cb1-51">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add it to the maze</span></span>
<span id="cb1-52">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add connecting edges to the frontier</span></span>
<span id="cb1-53">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># else add it to discard</span></span>
<span id="cb1-54">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">any</span>(nodes[.(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(selected_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>node1, selected_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>node2))</span>
<span id="cb1-55">                  , connected] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) {</span>
<span id="cb1-56">      </span>
<span id="cb1-57">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add to maze</span></span>
<span id="cb1-58">      edges[.(selected_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>id), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">location =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb1-59">                                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probability =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)]</span>
<span id="cb1-60">      </span>
<span id="cb1-61">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update nodes</span></span>
<span id="cb1-62">      nodes[.(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(selected_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>node1, selected_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>node2)), connected <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb1-63">      </span>
<span id="cb1-64">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update frontier</span></span>
<span id="cb1-65">      edges[.(nodes_edges[.(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(selected_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>node1, selected_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>node2))</span>
<span id="cb1-66">                          , <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"edge"</span>]), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span></span>
<span id="cb1-67">            (<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">location =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fifelse</span>(location <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, location),</span>
<span id="cb1-68">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probability =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fifelse</span>(location <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, probability))]</span>
<span id="cb1-69">      </span>
<span id="cb1-70">      num_edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> num_edges <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-71">    } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb1-72">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># drop from frontier</span></span>
<span id="cb1-73">      edges[.(selected_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>id), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">location =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb1-74">                                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probability =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)]</span>
<span id="cb1-75">    }</span>
<span id="cb1-76">  }</span>
<span id="cb1-77">  </span>
<span id="cb1-78">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(edges[location <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ])</span>
<span id="cb1-79">}</span></code></pre></div>
</details>
</div>
<p>The next function, <code>update_maze</code>, doubles the edges so that the maze follows a loop. The new connections trace the outline of the maze. This action mimics exploring the maze and following the path back to the start.</p>
<div class="cell">
<details class="code-fold">
<summary>[<code>update_maze</code> function]</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">update_maze <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(edges) {</span>
<span id="cb2-2">  </span>
<span id="cb2-3">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># list out all possible edges</span></span>
<span id="cb2-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (basically same code as setting up the maze)</span></span>
<span id="cb2-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plus adds edges that stick out on the outside</span></span>
<span id="cb2-6">  size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(edges<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-7">  all_possible_edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">CJ</span>(</span>
<span id="cb2-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, size), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, size) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-10">  )</span>
<span id="cb2-11">  all_possible_edges[, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(.I <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, x1),</span>
<span id="cb2-12">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(.I <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, y1))]</span>
<span id="cb2-13">  all_possible_edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_possible_edges[(x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb2-14">                                             (y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), ]</span>
<span id="cb2-15">  </span>
<span id="cb2-16">  edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> edges[, .(x1, x2, y1, y2, id)]</span>
<span id="cb2-17">  </span>
<span id="cb2-18">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># merge maze and all possible edges to see which ones weren't used</span></span>
<span id="cb2-19">  all_possible_edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">merge</span>(all_possible_edges, edges,</span>
<span id="cb2-20">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y2"</span>),</span>
<span id="cb2-21">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">all.x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb2-22">  )</span>
<span id="cb2-23">  </span>
<span id="cb2-24">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This function subs in the new edges appropriately</span></span>
<span id="cb2-25">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># basically, any path edge needs to be updated to two edges so the maze</span></span>
<span id="cb2-26">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># starts at the bottom middle, travels through the maze, and back to the start</span></span>
<span id="cb2-27">  create_new_edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x1, y1, x2, y2, id) {</span>
<span id="cb2-28">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># if no edges, add block</span></span>
<span id="cb2-29">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(id)) {</span>
<span id="cb2-30">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> y2) { <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># horizontal edge</span></span>
<span id="cb2-31">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb2-32">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x1,</span>
<span id="cb2-33">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-34">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x1,</span>
<span id="cb2-35">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y1,</span>
<span id="cb2-36">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-37">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-38">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-39">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y2</span>
<span id="cb2-40">        )</span>
<span id="cb2-41">      } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> { <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># vertical edge</span></span>
<span id="cb2-42">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb2-43">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-44">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y1,</span>
<span id="cb2-45">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x1,</span>
<span id="cb2-46">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y1,</span>
<span id="cb2-47">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-48">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-49">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x2,</span>
<span id="cb2-50">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-51">        )</span>
<span id="cb2-52">      }</span>
<span id="cb2-53">    } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> { <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># has edge, add connections</span></span>
<span id="cb2-54">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> y2) { <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># horizontal edge</span></span>
<span id="cb2-55">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb2-56">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x1,</span>
<span id="cb2-57">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-58">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-59">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-60">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x1,</span>
<span id="cb2-61">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y1,</span>
<span id="cb2-62">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-63">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y2</span>
<span id="cb2-64">        )</span>
<span id="cb2-65">      } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> { <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># vertical edge</span></span>
<span id="cb2-66">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb2-67">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-68">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y1,</span>
<span id="cb2-69">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-70">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-71">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x1,</span>
<span id="cb2-72">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y1,</span>
<span id="cb2-73">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x2,</span>
<span id="cb2-74">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-75">        )</span>
<span id="cb2-76">      }</span>
<span id="cb2-77">    }</span>
<span id="cb2-78">  }</span>
<span id="cb2-79">  </span>
<span id="cb2-80">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># fill in blocks and paths</span></span>
<span id="cb2-81">  all_possible_edges[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb2-82">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x1_1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y1_1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x2_1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y2_1"</span>,</span>
<span id="cb2-83">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x1_2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y1_2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x2_2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y2_2"</span></span>
<span id="cb2-84">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create_new_edges</span>(x1, y1, x2, y2, id),</span>
<span id="cb2-85">  by <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(all_possible_edges))</span>
<span id="cb2-86">  ]</span>
<span id="cb2-87">  </span>
<span id="cb2-88">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># clean everything up</span></span>
<span id="cb2-89">  all_possible_edges[, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1 =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb2-90">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1 =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb2-91">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2 =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb2-92">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2 =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb2-93">                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)]</span>
<span id="cb2-94">  </span>
<span id="cb2-95">  all_possible_edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">melt</span>(all_possible_edges,</span>
<span id="cb2-96">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure.vars =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">patterns</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y2"</span>),</span>
<span id="cb2-97">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value.name =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y2"</span>)</span>
<span id="cb2-98">  )[, variable <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>]</span>
<span id="cb2-99">  </span>
<span id="cb2-100">  all_possible_edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_possible_edges[(x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb2-101">                                              y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb2-102">                                              x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb2-103">                                              y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)), ]</span>
<span id="cb2-104">}</span></code></pre></div>
</details>
</div>
<p>The last external function, <code>maze_to_path</code>, puts all the edges in order from the bottom left corner, traveling through the loop and back to the beginning.</p>
<div class="cell">
<details class="code-fold">
<summary>[<code>maze_to_path</code> function]</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">maze_to_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(edges) {</span>
<span id="cb3-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set up id</span></span>
<span id="cb3-3">  edges[, id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> .I]</span>
<span id="cb3-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setkey</span>(edges, id)</span>
<span id="cb3-5">  </span>
<span id="cb3-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set up nodes data set</span></span>
<span id="cb3-7">  nodes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(edges[, .(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y1)]</span>
<span id="cb3-8">                        , edges[, .(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y2)]))</span>
<span id="cb3-9">  nodes[, id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> .I]</span>
<span id="cb3-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setkey</span>(nodes, id)</span>
<span id="cb3-11">  </span>
<span id="cb3-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add node ids to edges data set</span></span>
<span id="cb3-13">  edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">merge</span>(edges, nodes,</span>
<span id="cb3-14">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y1"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>),</span>
<span id="cb3-15">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">suffixes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_node_1"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">all.x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb3-16">  )</span>
<span id="cb3-17">  edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">merge</span>(edges, nodes,</span>
<span id="cb3-18">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y2"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>),</span>
<span id="cb3-19">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">suffixes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_node_2"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">all.x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb3-20">  )</span>
<span id="cb3-21">  </span>
<span id="cb3-22">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># nodes to edges look up table</span></span>
<span id="cb3-23">  nodes_edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(</span>
<span id="cb3-24">    edges[, .(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> id_node_1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">edge =</span> id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">connecting_node =</span> id_node_2)],</span>
<span id="cb3-25">    edges[, .(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> id_node_2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">edge =</span> id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">connecting_node =</span> id_node_1)]</span>
<span id="cb3-26">  ))</span>
<span id="cb3-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setkey</span>(nodes_edges, id)</span>
<span id="cb3-28">  </span>
<span id="cb3-29">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># save spot for path</span></span>
<span id="cb3-30">  path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vector</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mode =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"numeric"</span>)</span>
<span id="cb3-31">  </span>
<span id="cb3-32">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># variables to keep track of progress through the maze</span></span>
<span id="cb3-33">  current_node <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nodes[y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, id]</span>
<span id="cb3-34">  first_node <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> current_node</span>
<span id="cb3-35">  </span>
<span id="cb3-36">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update path</span></span>
<span id="cb3-37">  path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">append</span>(path, current_node)</span>
<span id="cb3-38">  previous_node <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> current_node</span>
<span id="cb3-39">  </span>
<span id="cb3-40">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># keep going to unexplored nodes</span></span>
<span id="cb3-41">  current_node <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nodes_edges[.(current_node), </span>
<span id="cb3-42">  ][connecting_node <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> previous_node</span>
<span id="cb3-43">    , connecting_node][<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb3-44">  </span>
<span id="cb3-45">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># continue through the whole path</span></span>
<span id="cb3-46">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> (current_node <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> first_node) {</span>
<span id="cb3-47">    path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">append</span>(path, current_node)</span>
<span id="cb3-48">    future_node <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nodes_edges[.(current_node), </span>
<span id="cb3-49">    ][connecting_node <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> previous_node</span>
<span id="cb3-50">      , connecting_node]</span>
<span id="cb3-51">    previous_node <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> current_node</span>
<span id="cb3-52">    current_node <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> future_node</span>
<span id="cb3-53">  }</span>
<span id="cb3-54">  </span>
<span id="cb3-55">  path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(</span>
<span id="cb3-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(path)),</span>
<span id="cb3-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">node =</span> path</span>
<span id="cb3-58">  )</span>
<span id="cb3-59">  path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">merge</span>(path, nodes, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"node"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"id"</span>))</span>
<span id="cb3-60">}</span></code></pre></div>
</details>
</div>
<p>The main workhorse utilizes the previous functions to get a set of connections.</p>
<p>The color scheme code follows a random circle in the HCL color space. There are ten points equidistant around the circle. Sometimes the first random circle will produce invalid color values. So the code loops until it finds a complete set. The circle’s center is saved and used as a border for the images and fills small circles where the connections meet.</p>
<p>Finally, a sine wave with a random number of waves determines the connections’ sizes.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>[<code>generate_output</code> code]</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(data.table)</span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"get_maze.R"</span>)</span>
<span id="cb4-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"update_maze.R"</span>)</span>
<span id="cb4-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"maze_to_path.R"</span>)</span>
<span id="cb4-7"></span>
<span id="cb4-8">get_set <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(size) {</span>
<span id="cb4-9">  set <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_maze</span>(size)</span>
<span id="cb4-10">  set <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update_maze</span>(set)</span>
<span id="cb4-11">  set <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">maze_to_path</span>(set)</span>
<span id="cb4-12">  </span>
<span id="cb4-13">  set[, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),</span>
<span id="cb4-14">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))]</span>
<span id="cb4-15">  </span>
<span id="cb4-16">  set <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> set[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">order</span>(order), ]</span>
<span id="cb4-17">  set[, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">':='</span> (<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shift</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lead"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) ),</span>
<span id="cb4-18">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shift</span>(y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lead"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) ))]</span>
<span id="cb4-19">}</span>
<span id="cb4-20"></span>
<span id="cb4-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get color scheme by finding a random circle in HCL color space</span></span>
<span id="cb4-22">get_colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>() {</span>
<span id="cb4-23">  </span>
<span id="cb4-24">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># two random vectors</span></span>
<span id="cb4-25">  v1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb4-26">  v2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb4-27">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># orthogonal</span></span>
<span id="cb4-28">  v2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> v2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(v1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%*%</span> v2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> v1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%*%</span> v1 ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> v1</span>
<span id="cb4-29">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># unit</span></span>
<span id="cb4-30">  v1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> v1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(v1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%*%</span> v1))</span>
<span id="cb4-31">  v2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> v2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(v2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%*%</span> v2))</span>
<span id="cb4-32">  </span>
<span id="cb4-33">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># random point</span></span>
<span id="cb4-34">  p <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span>)</span>
<span id="cb4-35">  </span>
<span id="cb4-36">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># random radius</span></span>
<span id="cb4-37">  r <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>)</span>
<span id="cb4-38">  </span>
<span id="cb4-39">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># ten points around the circle</span></span>
<span id="cb4-40">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># need to keep both end points even though they're the same value</span></span>
<span id="cb4-41">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># for scale_color_gradientn to loop back around</span></span>
<span id="cb4-42">  t <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>)</span>
<span id="cb4-43">  </span>
<span id="cb4-44">  colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p1 =</span> p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb4-45">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p2 =</span> p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb4-46">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">p3 =</span> p[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>],</span>
<span id="cb4-47">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">r =</span> r,</span>
<span id="cb4-48">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">t =</span> t,</span>
<span id="cb4-49">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v11 =</span> v1[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb4-50">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v12 =</span> v1[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb4-51">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v13 =</span> v1[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>],</span>
<span id="cb4-52">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v21 =</span> v2[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>],</span>
<span id="cb4-53">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v22 =</span> v2[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>],</span>
<span id="cb4-54">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">v23 =</span> v2[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>])</span>
<span id="cb4-55">  </span>
<span id="cb4-56">  colors[, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">':='</span> (<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> r <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(t) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> v11 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> r <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(t) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> v21,</span>
<span id="cb4-57">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> p2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> r <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(t) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> v12 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> r <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(t) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> v22,</span>
<span id="cb4-58">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> p3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> r <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(t) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> v13 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> r <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(t) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> v23)]</span>
<span id="cb4-59">  colors[, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span> (<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H =</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">atan2</span>(y, x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>pi) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>,</span>
<span id="cb4-60">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb4-61">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L =</span> z)]</span>
<span id="cb4-62">  </span>
<span id="cb4-63">  </span>
<span id="cb4-64">  colors[, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">':='</span> (<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hex_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(L <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> L <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA_character_</span>, </span>
<span id="cb4-65">                                    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(H, C, L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixup =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>))), </span>
<span id="cb4-66">         by <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(colors))]</span>
<span id="cb4-67"></span>
<span id="cb4-68">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(colors)</span>
<span id="cb4-69">}</span>
<span id="cb4-70"></span>
<span id="cb4-71"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sometimes the circle will be out of range,</span></span>
<span id="cb4-72"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># so try again until all the colors are valid</span></span>
<span id="cb4-73">get_color_scheme <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>() {</span>
<span id="cb4-74">  colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_colors</span>()</span>
<span id="cb4-75"></span>
<span id="cb4-76">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">any</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(colors<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>hex_value))) {</span>
<span id="cb4-77">    colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_colors</span>()</span>
<span id="cb4-78">  }</span>
<span id="cb4-79">  </span>
<span id="cb4-80">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(colors)</span>
<span id="cb4-81">}</span>
<span id="cb4-82"></span>
<span id="cb4-83"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Create 10 outputs</span></span>
<span id="cb4-84"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10101010</span>)</span>
<span id="cb4-85"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>) {</span>
<span id="cb4-86">  size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb4-87">  set <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_set</span>(size)</span>
<span id="cb4-88">  </span>
<span id="cb4-89">  colors <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_color_scheme</span>()</span>
<span id="cb4-90">  </span>
<span id="cb4-91">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Save center of the circle</span></span>
<span id="cb4-92">  color_center <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">h =</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">atan2</span>(colors<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p2[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>], colors<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p1[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>pi) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>,</span>
<span id="cb4-93">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">c =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(colors<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p1[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> colors<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p2[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb4-94">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">l =</span> colors<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>p3[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>])</span>
<span id="cb4-95">  </span>
<span id="cb4-96">  color_scheme <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> colors[[<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"hex_value"</span>]]</span>
<span id="cb4-97">  </span>
<span id="cb4-98">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get boundaries of white background square</span></span>
<span id="cb4-99">  boundaries <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(set<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(set<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(set<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(set<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x)),</span>
<span id="cb4-100">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(set<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(set<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(set<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(set<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y)))</span>
<span id="cb4-101">  boundaries[, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">':='</span> (<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span>,</span>
<span id="cb4-102">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.1</span>)]</span>
<span id="cb4-103">  </span>
<span id="cb4-104">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set up connections size</span></span>
<span id="cb4-105">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># order goes from 1 to 400</span></span>
<span id="cb4-106">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 400 / waves = num segments per wave</span></span>
<span id="cb4-107">  waves <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">70</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">130</span>))</span>
<span id="cb4-108">  offset <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>pi)</span>
<span id="cb4-109">  set[, size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> order <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(order) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>pi]</span>
<span id="cb4-110">  set[, size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(waves <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> offset) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span> ]</span>
<span id="cb4-111">  </span>
<span id="cb4-112">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-113">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> boundaries,</span>
<span id="cb4-114">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y),</span>
<span id="cb4-115">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>,</span>
<span id="cb4-116">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-117">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> set,</span>
<span id="cb4-118">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y,</span>
<span id="cb4-119">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> xend, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> yend, </span>
<span id="cb4-120">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> order, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> size),</span>
<span id="cb4-121">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb4-122">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineend =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"round"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-123">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> set,</span>
<span id="cb4-124">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y,</span>
<span id="cb4-125">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> xend, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> yend, </span>
<span id="cb4-126">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> order, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),</span>
<span id="cb4-127">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-128">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineend =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"round"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-129">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> set,</span>
<span id="cb4-130">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y), </span>
<span id="cb4-131">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color_center,</span>
<span id="cb4-132">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-133">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_gradientn</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">colours =</span> color_scheme) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-134">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-135">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-136">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb4-137">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"output/output_"</span>, i, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".jpeg"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> color_center)</span>
<span id="cb4-138">}</span></code></pre></div>
</details>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
Output
</h2>
</center>
<hr>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-28-circuitry/output_1.jpeg" class="img-fluid figure-img"></p>
<figcaption>Output 1</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-28-circuitry/output_2.jpeg" class="img-fluid figure-img"></p>
<figcaption>Output 2</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-28-circuitry/output_3.jpeg" class="img-fluid figure-img"></p>
<figcaption>Output 3</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-28-circuitry/output_4.jpeg" class="img-fluid figure-img"></p>
<figcaption>Output 4</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-28-circuitry/output_5.jpeg" class="img-fluid figure-img"></p>
<figcaption>Output 5</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-28-circuitry/output_6.jpeg" class="img-fluid figure-img"></p>
<figcaption>Output 6</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-28-circuitry/output_7.jpeg" class="img-fluid figure-img"></p>
<figcaption>Output 7</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-28-circuitry/output_8.jpeg" class="img-fluid figure-img"></p>
<figcaption>Output 8</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-28-circuitry/output_9.jpeg" class="img-fluid figure-img"></p>
<figcaption>Output 9</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-28-circuitry/output_10.jpeg" class="img-fluid figure-img"></p>
<figcaption>Output 10</figcaption>
</figure>
</div>
</div>
</div>
</div>



 ]]></description>
  <category>R</category>
  <category>Generative Art</category>
  <guid>https://www.williamtylerbradley.com/posts/2022-05-28-circuitry/</guid>
  <pubDate>Sat, 28 May 2022 04:00:00 GMT</pubDate>
  <media:content url="https://www.williamtylerbradley.com/posts/2022-05-28-circuitry/output_1.jpeg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Cross-validation: A Toy Example</title>
  <link>https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/</link>
  <description><![CDATA[ 





<hr>
<center>
<h2 class="anchored">
Background
</h2>
</center>
<hr>
<p>This blog post comes from a presentation I gave a few years ago. It will walk through a demonstration of cross-validation for comparing predictive models. I assume you already know about cross-validation and won’t spend much time explaining it. Working through how this presentation functions is the main focus. The exercise works by having your co-workers (or other people) stand on a large grid marked by string. Each person has a toy animal representing their class, either African mammal or dinosaur, with information attached.</p>
<p>The toy also has a tag with:</p>
<ul>
<li>ID number</li>
<li>x-position of X1</li>
<li>y-position of X2</li>
<li>fold number.</li>
</ul>
<p>I used X1 and X2 instead of x and y since y is often reserved for the class, but x and y can be used. People will move on and off the grid as the toys move in and out of hold-out sets for different folds. Predictive models are built and tested to determine the best one. There are many variations on this idea, so feel free to change this up to suit your situation.</p>
<p>I’d recommend starting with a brief explanation of cross-validation and when/why it is used. I usually have slides with a curve of data (like y = x^2 + noise). Then show three models: a line, a curve, and one that goes through all data points but is very squiggly. Then add in some data to estimate and show that the curve fits best. Or something similar to get the general picture.</p>
<p>(As a side note, this presentation was inspired by the <a href="https://en.wikipedia.org/wiki/Dance_Your_Ph.D.">Dance Your Ph.D.&nbsp;contest</a>. I’m not good with music, but if you are, I’m pretty confident this could be a dance instead.)</p>
<br>
<hr>
<center>
<h2 class="anchored">
Setup
</h2>
</center>
<hr>
<p>The following picture gives a general idea of the setup. I’m using a table for the photography, but it would be much larger on the floor. I had small cones for the axis labels, but there are small pieces of paper here. String or tape can mark the grid lines. The axes are generic X1 and X2, but they can represent variables like height/weight ratio or transformations like PCA.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/set_up.JPG" style="width:80.0%;height:80.0%" class="figure-img"></p>
<figcaption>Setup Grid</figcaption>
</figure>
</div>
<p>The exercise aims to create models using ribbons, to separate the mammals from dinosaurs. The ribbons are different lengths to represent the different flexibility of models. Then, we’ll test each of the models using cross-validation to estimate how well each one would perform on new data.</p>
<p>I created test data sets to determine the toys’ positions and folds until I got some with the desired attributes. I used twelve animals, but your number will depend on the people you have. There are three folds and three models. Each fold has four animals, two mammals and two dinosaurs. The three models are a straight line, a curve, and a squiggle. I wanted some variety with accuracy, none of the models to be perfect, and have Model 2 to be the best. I created a decision boundary of a curve to get started. All animals are positioned on integers, with African mammals on the left/below the curve and dinosaurs on the right/above. Then I sampled data sets until I got some with the desired properties, compared them, and chose one with nice images. You can see the <a href="https://github.com/WilliamTylerBradley/cross-validation-example">code in this repo</a>.</p>
<br>
<hr>
<center>
<h2 class="anchored">
Full Data Set
</h2>
</center>
<hr>
<p>The following images show a graphic of the data and a picture of the toys in place. In the graphic, mammals are yellow while dinosaurs are green. The toys are in place based on their tag’s information. The tea towel holds the assessment data. People can just walk off the grid to any place in real life. For this blogpost, graphics on the left would be displayed during the presentation to guide the exercise, while the pictures on the right show the physical experience.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/ids.png" class="img-fluid figure-img"></p>
<figcaption>Full Data Set - Graphic</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/full_pop.JPG" class="img-fluid figure-img"></p>
<figcaption>Full Data Set - Picture</figcaption>
</figure>
</div>
</div>
</div>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
Folds and Models
</h2>
</center>
<hr>
<p>The next image shows which animals are in each fold. This image shows when people should move off the grid. The fold IDs are also on the tag attached to each toy.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/folds.png" class="img-fluid figure-img"></p>
<figcaption>Folds Identification</figcaption>
</figure>
</div>
<section id="fold-1" class="level2">
<h2 class="anchored" data-anchor-id="fold-1">Fold 1</h2>
<p>So to set up the first fold, people with a fold ID of 1 move off the grid. These people are in the assessment set while everyone else is in the analysis set. (Sometimes called validation and training set.)</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_1_analysis.png" class="img-fluid figure-img"></p>
<figcaption>Fold 1 - Graphic</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_1_analysis_pic.JPG" class="img-fluid figure-img"></p>
<figcaption>Fold 1 - Picture</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="fold-1---model-1" class="level2">
<h2 class="anchored" data-anchor-id="fold-1---model-1">Fold 1 - Model 1</h2>
<p>For Model 1, we have a piece of ribbon that stretches to a line across the grid. For this model, the ribbon is always a straight line. The analysis set people attempt to set the line down to separate the mammals from the dinosaurs. In this case, a straight line cannot separate the animals. So, the elephant in the bottom right corner ends up on the wrong side. The graphic displays the error with a green on the outside (labeled as a dinosaur) and yellow on the inside (actually a mammal) dot. For the graphics, dots with two colors are mismatches.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_1_analysis_model_1.png" class="img-fluid figure-img"></p>
<figcaption>Fold 1 - Analysis Set - Model 1 - Graphic</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_1_analysis_model_1_pic.JPG" class="img-fluid figure-img"></p>
<figcaption>Fold 1 - Analysis Set - Model 1 - Picture</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>It’s important to emphasize the analysis set doesn’t know about the assessment set. This way, people don’t try to remember where they were to improve accuracy. Driving home this point really helped explain the importance of cross-validation and how it estimates model performance on unseen data.</p>
<p>We bring the people in the hold-out area back onto the grid for the assessment set. The ribbon marking the model stays in place. For my presentation, I kept everyone on the grid. But for the pictures, it was easier to see the results by moving the analysis set out of the way. In the end, the model mislabels one of the dinosaurs because it’s on the wrong side. Its dot is two colors, and the toy is knocked over.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_1_assessment_model_1.png" class="img-fluid figure-img"></p>
<figcaption>Fold 1 - Assessment Set - Model 1 - Graphic</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_1_assessment_model_1_pic.JPG" class="img-fluid figure-img"></p>
<figcaption>Fold 1 - Assessment Set - Model 1 - Picture</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="fold-2" class="level2">
<h2 class="anchored" data-anchor-id="fold-2">Fold 2</h2>
<p>The people in fold 2 move off the grid for the next step. Then a straight line model is built.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_2_analysis.png" class="img-fluid figure-img"></p>
<figcaption>Fold 2 - Graphic</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_2_analysis_pic.JPG" class="img-fluid figure-img"></p>
<figcaption>Fold 2 - Picture</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="fold-2---model-1" class="level2">
<h2 class="anchored" data-anchor-id="fold-2---model-1">Fold 2 - Model 1</h2>
<p>In this example, the model built by code mismarks the dinosaur in the model. I choose to move the model and correct it for the picture. In an actual presentation, people will move these however they want. So they are unlikely to match the computer result every time. You can either keep track of both results or only focus on the computer output.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_2_analysis_model_1.png" class="img-fluid figure-img"></p>
<figcaption>Fold 2 - Assessment Set - Model 1 - Graphic</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_2_analysis_model_1_pic.JPG" class="img-fluid figure-img"></p>
<figcaption>Fold 2 - Assessment Set - Model 1 - Picture</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>When we add back in the assessment set, two errors occur: the giraffe in the top left and a dinosaur towards the bottom right.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_2_assessment_model_1.png" class="img-fluid figure-img"></p>
<figcaption>Fold 2 - Analysis Set - Model 1 - Graphic</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_2_assessment_model_1_pic.JPG" class="img-fluid figure-img"></p>
<figcaption>Fold 2 - Analysis Set - Model 1 - Picture</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="fold-3" class="level2">
<h2 class="anchored" data-anchor-id="fold-3">Fold 3</h2>
<p>Fold 3 repeats the same action with the last set of people.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_3_analysis.png" class="img-fluid figure-img"></p>
<figcaption>Fold 3 - Graphic</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_3_analysis_pic.JPG" class="img-fluid figure-img"></p>
<figcaption>Fold 3 - Picture</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="fold-3---model-1" class="level2">
<h2 class="anchored" data-anchor-id="fold-3---model-1">Fold 3 - Model 1</h2>
<p>We end up building a model again. This time everyone in the analysis set can be labeled correctly, but we’ll miss the elephant in the bottom right of the assessment set.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_3_analysis_model_1.png" class="img-fluid figure-img"></p>
<figcaption>Fold 3 - Assessment Set - Model 1 - Graphic</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_3_analysis_model_1_pic.JPG" class="img-fluid figure-img"></p>
<figcaption>Fold 3 - Assessment Set - Model 1 - Picture</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_3_assessment_model_1.png" class="img-fluid figure-img"></p>
<figcaption>Fold 3 - Analysis Set - Model 1 - Graphic</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_3_assessment_model_1_pic.JPG" class="img-fluid figure-img"></p>
<figcaption>Fold 3 - Analysis Set - Model 1 - Picture</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="fold-1---model-2" class="level2">
<h2 class="anchored" data-anchor-id="fold-1---model-2">Fold 1 - Model 2</h2>
<p>This set will mirror the first part of the exercise but use a different model. The new model is a longer piece of ribbon that can have a slight curve. Apart from that, everything is the same.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_1_analysis_model_2.png" class="img-fluid figure-img"></p>
<figcaption>Fold 1 - Assessment Set - Model 2 - Graphic</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_1_analysis_model_2_pic.JPG" class="img-fluid figure-img"></p>
<figcaption>Fold 1 - Assessment Set - Model 2 - Picture</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_1_assessment_model_2.png" class="img-fluid figure-img"></p>
<figcaption>Fold 1 - Analysis Set - Model 2 - Graphic</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_1_assessment_model_2_pic.JPG" class="img-fluid figure-img"></p>
<figcaption>Fold 1 - Analysis Set - Model 2 - Picture</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>For fold 1, we finally get an analysis set and an assessment set with 100% accuracy. This shows that adding some complexity to the model can help.</p>
</section>
<section id="fold-2---model-2" class="level2">
<h2 class="anchored" data-anchor-id="fold-2---model-2">Fold 2 - Model 2</h2>
<p>This follows the same pattern as the previous fold.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_2_analysis_model_2.png" class="img-fluid figure-img"></p>
<figcaption>Fold 2 - Assessment Set - Model 2 - Graphic</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_2_analysis_model_2_pic.JPG" class="img-fluid figure-img"></p>
<figcaption>Fold 2 - Assessment Set - Model 2 - Picture</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_2_assessment_model_2.png" class="img-fluid figure-img"></p>
<figcaption>Fold 2 - Analysis Set - Model 2 - Graphic</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_2_assessment_model_2_pic.JPG" class="img-fluid figure-img"></p>
<figcaption>Fold 2 - Analysis Set - Model 2 - Picture</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="fold-3---model-2" class="level2">
<h2 class="anchored" data-anchor-id="fold-3---model-2">Fold 3 - Model 2</h2>
<p>In this fold, we do have an error in the assessment set. I like to see at least one error for each model to demonstrate that it can be impossible to get everything correct.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_3_analysis_model_2.png" class="img-fluid figure-img"></p>
<figcaption>Fold 3 - Assessment Set - Model 2 - Graphic</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_3_analysis_model_2_pic.JPG" class="img-fluid figure-img"></p>
<figcaption>Fold 3 - Assessment Set - Model 2 - Picture</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_3_assessment_model_2.png" class="img-fluid figure-img"></p>
<figcaption>Fold 3 - Analysis Set - Model 2 - Graphic</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_3_assessment_model_2_pic.JPG" class="img-fluid figure-img"></p>
<figcaption>Fold 3 - Analysis Set - Model 2 - Picture</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="fold-1---model-3" class="level2">
<h2 class="anchored" data-anchor-id="fold-1---model-3">Fold 1 - Model 3</h2>
<p>We have the longest ribbon for the most flexible model for the final model. The exercise follows the previous steps.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_1_analysis_model_3.png" class="img-fluid figure-img"></p>
<figcaption>Fold 1 - Assessment Set - Model 3 - Graphic</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_1_analysis_model_3_pic.JPG" class="img-fluid figure-img"></p>
<figcaption>Fold 1 - Assessment Set - Model 3 - Picture</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_1_assessment_model_3.png" class="img-fluid figure-img"></p>
<figcaption>Fold 1 - Analysis Set - Model 3 - Graphic</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_1_assessment_model_3_pic.JPG" class="img-fluid figure-img"></p>
<figcaption>Fold 1 - Analysis Set - Model 3 - Picture</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="fold-2---model-3" class="level2">
<h2 class="anchored" data-anchor-id="fold-2---model-3">Fold 2 - Model 3</h2>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_2_analysis_model_3.png" class="img-fluid figure-img"></p>
<figcaption>Fold 2 - Assessment Set - Model 3 - Graphic</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_2_analysis_model_3_pic.JPG" class="img-fluid figure-img"></p>
<figcaption>Fold 2 - Assessment Set - Model 3 - Picture</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_2_assessment_model_3.png" class="img-fluid figure-img"></p>
<figcaption>Fold 2 - Analysis Set - Model 3 - Graphic</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_2_assessment_model_3_pic.JPG" class="img-fluid figure-img"></p>
<figcaption>Fold 2 - Analysis Set - Model 3 - Picture</figcaption>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="fold-3---model-3" class="level2">
<h2 class="anchored" data-anchor-id="fold-3---model-3">Fold 3 - Model 3</h2>
<p>There is more room for the final model to move the ribbon. The flexibility can create new patterns that don’t capture the data as well.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_3_analysis_model_3.png" class="img-fluid figure-img"></p>
<figcaption>Fold 3 - Assessment Set - Model 3 - Graphic</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_3_analysis_model_3_pic.JPG" class="img-fluid figure-img"></p>
<figcaption>Fold 3 - Assessment Set - Model 3 - Picture</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_3_assessment_model_3.png" class="img-fluid figure-img"></p>
<figcaption>Fold 3 - Analysis Set - Model 3 - Graphic</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/fold_3_assessment_model_3_pic.JPG" class="img-fluid figure-img"></p>
<figcaption>Fold 3 - Analysis Set - Model 3 - Picture</figcaption>
</figure>
</div>
</div>
</div>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
Overall Accuracy
</h2>
</center>
<hr>
<p>We can wrap up the exercise by looking at the models’ overall accuracy. For this setup, Model 2 performed the best. This outcome shows that having some flexibility can fit the data better, but adding too much complexity to the model can hurt.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/accuracy_table.png" style="height:80.0%" class="figure-img"></p>
<figcaption>Accuracy Results</figcaption>
</figure>
</div>
<hr>
<p>The last topic to mention is the toys used. I got African mammals and dinosaurs because they were at the store near me, but I think it’s a great combination. Most people know enough about them to have a conversation on variables that can help separate them. At the same time, it’s not a serious or business-related topic. So, it’s more interesting than just using colored points, but you can also avoid people getting too caught up in the weeds. Feel free to change it to whatever you want.</p>


</section>

 ]]></description>
  <category>Data Science</category>
  <category>Presentations</category>
  <guid>https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/</guid>
  <pubDate>Fri, 20 May 2022 04:00:00 GMT</pubDate>
  <media:content url="https://www.williamtylerbradley.com/posts/2022-05-20-cross-validation-a-toy-example/thumbnail.JPG" medium="image"/>
</item>
<item>
  <title>Pandemic Mazes</title>
  <link>https://www.williamtylerbradley.com/posts/2022-05-03-pandemic-mazes/</link>
  <description><![CDATA[ 





<hr>
<center>
<h2 class="anchored">
Background
</h2>
</center>
<hr>
<p>This art project came out of my experiences during the pandemic. I thought the signs on grocery store floors were an interesting physical manifestation of the COVID rules. Especially since some places had clear signs but some didn’t, some people followed the signs but some didn’t, and some signs were consistent for a long time but some weren’t. This same situation is reflected in the other rules where some are clear, followed, and consistent, but others aren’t.</p>
<p>So I decided to make a generative art project that creates random paths based on pandemic signs. For each image created, the maze generated has the same start and endpoints, but the path in between can be complicated or straightforward. On one end of the spectrum, the maze follows mostly straight lines into the middle and then back out of the maze with consistent signage. The other end has the maze meander all over with many different signs. There’s a parameter for all of this code that causes that. Changes in this parameter can express experiences or match data for different regions/times.</p>
<p>The program works in five steps:</p>
<ul>
<li>Create a base maze</li>
<li>Update the maze to double all the edges</li>
<li>Move through all edges in one path</li>
<li>Add in the images for signs</li>
<li>Finally, add the background and save</li>
</ul>
<br>
<hr>
<center>
<h2 class="anchored">
Create a base maze
</h2>
</center>
<hr>
<p>A five-by-five square of nodes sets up each maze. A data set of edges connect the vertical and horizontal neighbors. The set for the labyrinth is marked here. The maze always starts at the bottom middle node. After that, edges are selected, checked if they can be included or if it would cause the maze to connect in on itself, and marked as part of the maze or as discard.</p>
<p>A parameter ranging from 0 to 1 determines how much the maze turns. A value of 0 yields a completely random maze and 1 for following a smooth labyrinth that spirals in and then back out to the start. Any value in between sets the probability of choosing a new step at random versus moving along the labyrinth.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>[<code>get_maze</code> function]</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">get_maze <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(structure_parameter) {</span>
<span id="cb1-2"></span>
<span id="cb1-3">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sets up base data set of potential edges for the maze</span></span>
<span id="cb1-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># size is always 5 for right now</span></span>
<span id="cb1-5">  size <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb1-6">  edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">CJ</span>(</span>
<span id="cb1-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, size), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb1-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, size)</span>
<span id="cb1-9">  )</span>
<span id="cb1-10">  edges[, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(.I <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, x1),</span>
<span id="cb1-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(.I <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, y1))]</span>
<span id="cb1-12">  edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> edges[x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> size, ]</span>
<span id="cb1-13">  edges[, id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(edges))]</span>
<span id="cb1-14">  edges[, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">node1 =</span> (x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb1-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">node2 =</span> (x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> size <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)]</span>
<span id="cb1-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setkey</span>(edges, id)</span>
<span id="cb1-17"></span>
<span id="cb1-18">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set up the path for the labyrinth</span></span>
<span id="cb1-19">  edges[, labyrinth <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb1-20">  edges[</span>
<span id="cb1-21">    .(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">29</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">37</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">38</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">39</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span>, </span>
<span id="cb1-22">        <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">27</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">18</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, </span>
<span id="cb1-23">         <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,  <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">14</span>, </span>
<span id="cb1-24">        <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">17</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">26</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">32</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">22</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>)),</span>
<span id="cb1-25">    labyrinth <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">24</span>)</span>
<span id="cb1-26">  ]</span>
<span id="cb1-27"></span>
<span id="cb1-28">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># data set of nodes</span></span>
<span id="cb1-29">  nodes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(edges[, .(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> node1)], edges[, .(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> node2)]))</span>
<span id="cb1-30">  nodes[, connected <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>]</span>
<span id="cb1-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setkey</span>(nodes, id)</span>
<span id="cb1-32"></span>
<span id="cb1-33">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># data set of node id to edge ids</span></span>
<span id="cb1-34">  nodes_edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(edges[, .(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> node1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">edge =</span> id)][], </span>
<span id="cb1-35">                              edges[, .(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> node2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">edge =</span> id)]))</span>
<span id="cb1-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setkey</span>(nodes_edges, id)</span>
<span id="cb1-37"></span>
<span id="cb1-38">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># location : 1 for maze, 0 for frontier, -1 for uncharted, -2 for discarded</span></span>
<span id="cb1-39">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># starting point : bottom middle</span></span>
<span id="cb1-40">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># include bottom middle then either off to the sides or up</span></span>
<span id="cb1-41">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> structure_parameter) {</span>
<span id="cb1-42">    starting_edge <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> edges[x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ]</span>
<span id="cb1-43">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb1-44">    starting_edge <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> edges[(x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span></span>
<span id="cb1-45">      (x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), ][<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(.N, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), ]</span>
<span id="cb1-46">  }</span>
<span id="cb1-47"></span>
<span id="cb1-48">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set up base columns</span></span>
<span id="cb1-49">  edges[, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">location =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb1-50">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probability =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)]</span>
<span id="cb1-51">  edges[.(starting_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>id), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">location =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb1-52">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probability =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)]</span>
<span id="cb1-53">  nodes[.(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(starting_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>node1, starting_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>node2)), connected <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb1-54">  edges[.(nodes_edges[.(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(starting_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>node1, starting_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>node2)), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"edge"</span>]), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span></span>
<span id="cb1-55">  (<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">location =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fifelse</span>(location <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, location),</span>
<span id="cb1-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probability =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fifelse</span>(location <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, probability))]</span>
<span id="cb1-57"></span>
<span id="cb1-58">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">#### Loop through maze generation ----</span></span>
<span id="cb1-59">  num_edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-60">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> (num_edges <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> (size<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) {</span>
<span id="cb1-61"></span>
<span id="cb1-62">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># select next edge</span></span>
<span id="cb1-63">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> structure_parameter) {</span>
<span id="cb1-64">      selected_edge <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> edges[edges<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>location <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, </span>
<span id="cb1-65">                             ][<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(labyrinth) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> labyrinth, </span>
<span id="cb1-66">                               ][<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(.N, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), ]</span>
<span id="cb1-67">    } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb1-68">      selected_edge <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> edges[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(.N, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">prob =</span> probability), ]</span>
<span id="cb1-69">    }</span>
<span id="cb1-70"></span>
<span id="cb1-71">    <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## if it's good, then</span></span>
<span id="cb1-72">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add it to the maze</span></span>
<span id="cb1-73">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add connecting edges to the frontier</span></span>
<span id="cb1-74">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># else add it to discard</span></span>
<span id="cb1-75">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">any</span>(nodes[.(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(selected_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>node1, selected_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>node2))</span>
<span id="cb1-76">                  , connected] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) {</span>
<span id="cb1-77"></span>
<span id="cb1-78">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add to maze</span></span>
<span id="cb1-79">      edges[.(selected_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>id), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">location =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb1-80">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probability =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)]</span>
<span id="cb1-81"></span>
<span id="cb1-82">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update nodes</span></span>
<span id="cb1-83">      nodes[.(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(selected_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>node1, selected_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>node2)), connected <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]</span>
<span id="cb1-84"></span>
<span id="cb1-85">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update frontier</span></span>
<span id="cb1-86">      edges[.(nodes_edges[.(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(selected_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>node1, selected_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>node2))</span>
<span id="cb1-87">                          , <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"edge"</span>]), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span></span>
<span id="cb1-88">      (<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">location =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fifelse</span>(location <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, location),</span>
<span id="cb1-89">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probability =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fifelse</span>(location <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, probability))]</span>
<span id="cb1-90"></span>
<span id="cb1-91">      num_edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> num_edges <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-92">    } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb1-93">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># drop from frontier</span></span>
<span id="cb1-94">      edges[.(selected_edge<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>id), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">location =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb1-95">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">probability =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)]</span>
<span id="cb1-96">    }</span>
<span id="cb1-97">  }</span>
<span id="cb1-98"></span>
<span id="cb1-99">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(edges[location <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, ])</span>
<span id="cb1-100">}</span></code></pre></div>
</details>
</div>
<p>The following image displays the base maze layout. The edges are numbered with their x1/y1 coordinates at their left/bottom and x2/y2 at their right/top. The labyrinth pattern is highlighted in blue.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-03-pandemic-mazes/post_1.png" class="img-fluid figure-img"></p>
<figcaption>Maze edges with labyrinth highlighted</figcaption>
</figure>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
Update the maze to double all the edges
</h2>
</center>
<hr>
<p>For the final image, the path needs to start at one point, move through all the nodes, then exit at one other point. To ensure this capability, the path will travel through the maze and backtrack to the starting point. This is typically done using a graph setup, but I wanted to keep the table data structure. So instead of following those instructions, I take every edge and double for each direction. The code works by replacing all possible edges with either two parallel edges (if the edge was in the maze) or two perpendicular ones (if the edge was discarded).</p>
<div class="cell">
<details open="" class="code-fold">
<summary>[<code>update_maze</code> function]</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1">update_maze <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(edges) {</span>
<span id="cb2-2"></span>
<span id="cb2-3">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># list out all possible edges</span></span>
<span id="cb2-4">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># (basically same code as setting up the maze)</span></span>
<span id="cb2-5">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># plus adds edges that stick out on the outside</span></span>
<span id="cb2-6">  all_possible_edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">CJ</span>(</span>
<span id="cb2-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-9">  )</span>
<span id="cb2-10">  all_possible_edges[, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(.I <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, x1),</span>
<span id="cb2-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ifelse</span>(.I <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, y1))]</span>
<span id="cb2-12">  all_possible_edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_possible_edges[(x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb2-13">    (y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>), ]</span>
<span id="cb2-14"></span>
<span id="cb2-15">  edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> edges[, .(x1, x2, y1, y2, id)]</span>
<span id="cb2-16"></span>
<span id="cb2-17">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># merge maze and all possible edges to see which ones weren't used</span></span>
<span id="cb2-18">  all_possible_edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">merge</span>(all_possible_edges, edges,</span>
<span id="cb2-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y2"</span>),</span>
<span id="cb2-20">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">all.x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb2-21">  )</span>
<span id="cb2-22"></span>
<span id="cb2-23">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># This function subs in the new edges appropriately</span></span>
<span id="cb2-24">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># basically, any path edge needs to be updated to two edges so the maze</span></span>
<span id="cb2-25">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># starts at the bottom middle, travels through the maze, and back to the start</span></span>
<span id="cb2-26">  create_new_edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x1, y1, x2, y2, id) {</span>
<span id="cb2-27">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># if no edges, add block</span></span>
<span id="cb2-28">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(id)) {</span>
<span id="cb2-29">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> y2) { <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># horizontal edge</span></span>
<span id="cb2-30">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb2-31">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x1,</span>
<span id="cb2-32">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-33">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x1,</span>
<span id="cb2-34">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y1,</span>
<span id="cb2-35">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-36">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-37">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-38">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y2</span>
<span id="cb2-39">        )</span>
<span id="cb2-40">      } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> { <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># vertical edge</span></span>
<span id="cb2-41">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb2-42">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-43">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y1,</span>
<span id="cb2-44">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x1,</span>
<span id="cb2-45">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y1,</span>
<span id="cb2-46">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-47">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-48">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x2,</span>
<span id="cb2-49">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-50">        )</span>
<span id="cb2-51">      }</span>
<span id="cb2-52">    } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> { <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># has edge, add connections</span></span>
<span id="cb2-53">      <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> y2) { <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># horizontal edge</span></span>
<span id="cb2-54">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb2-55">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x1,</span>
<span id="cb2-56">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-57">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-58">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-59">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x1,</span>
<span id="cb2-60">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y1,</span>
<span id="cb2-61">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-62">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y2</span>
<span id="cb2-63">        )</span>
<span id="cb2-64">      } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> { <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># vertical edge</span></span>
<span id="cb2-65">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(</span>
<span id="cb2-66">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-67">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y1,</span>
<span id="cb2-68">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-69">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2_1 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-70">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x1,</span>
<span id="cb2-71">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y1,</span>
<span id="cb2-72">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x2,</span>
<span id="cb2-73">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2_2 =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb2-74">        )</span>
<span id="cb2-75">      }</span>
<span id="cb2-76">    }</span>
<span id="cb2-77">  }</span>
<span id="cb2-78"></span>
<span id="cb2-79">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># fill in blocks and paths</span></span>
<span id="cb2-80">  all_possible_edges[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb2-81">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x1_1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y1_1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x2_1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y2_1"</span>,</span>
<span id="cb2-82">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x1_2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y1_2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x2_2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y2_2"</span></span>
<span id="cb2-83">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">create_new_edges</span>(x1, y1, x2, y2, id),</span>
<span id="cb2-84">  by <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(all_possible_edges))</span>
<span id="cb2-85">  ]</span>
<span id="cb2-86"></span>
<span id="cb2-87">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># clean everything up</span></span>
<span id="cb2-88">  all_possible_edges[, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1 =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb2-89">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1 =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb2-90">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2 =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb2-91">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2 =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>,</span>
<span id="cb2-92">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>)]</span>
<span id="cb2-93"></span>
<span id="cb2-94">  all_possible_edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">melt</span>(all_possible_edges,</span>
<span id="cb2-95">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">measure.vars =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">patterns</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y2"</span>),</span>
<span id="cb2-96">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">value.name =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y2"</span>)</span>
<span id="cb2-97">  )[, variable <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NULL</span>]</span>
<span id="cb2-98"></span>
<span id="cb2-99">  all_possible_edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> all_possible_edges[(x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb2-100">    y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb2-101">    x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb2-102">    y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">11</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb2-103">    (x1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span></span>
<span id="cb2-104">      y1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span></span>
<span id="cb2-105">      x2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span></span>
<span id="cb2-106">      y2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), ]</span>
<span id="cb2-107"></span>
<span id="cb2-108">  all_possible_edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(</span>
<span id="cb2-109">    all_possible_edges,</span>
<span id="cb2-110">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(</span>
<span id="cb2-111">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>),</span>
<span id="cb2-112">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb2-113">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>),</span>
<span id="cb2-114">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-115">    )</span>
<span id="cb2-116">  )</span>
<span id="cb2-117">}</span></code></pre></div>
</details>
</div>
<p>The following two images show a randomly generated maze and output for doubling the edges. The image on the left has the maze in red with all possible edges in blue. Note the extra blue edges are pointing out of the original five-by-five square. These will provide the walls for paths on the maze’s outside edge. The image on the right displays the result of substituting every edge with a parallel set for maze edges and a perpendicular set for non-maze edges. So, each red line has two new black lines running next to it, while each blue line has two new black lines cutting through it. Note that the coordinates’ ranges have changed from one to five to zero to eleven (everything is times two then minus one).</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-03-pandemic-mazes/post_2.png" class="img-fluid figure-img"></p>
<figcaption>Randomly generated maze</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-03-pandemic-mazes/post_3.png" class="img-fluid figure-img"></p>
<figcaption>Doubling maze edges</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>This image shows the cleaned-up final output for this function. The unconnected outside edges are removed. The start and end edges are added to the bottom middle with the connection between them severed.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-03-pandemic-mazes/post_4.png" class="img-fluid figure-img"></p>
<figcaption>Cleaned-up output</figcaption>
</figure>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
Move through all edges in one path
</h2>
</center>
<hr>
<p>Now, the edges from the previous step can be connected into one path. The path starts at the bottom middle and then moves to the next node. After that, the path connects to the unconnected node. Because of the previous setup, each node (except starting and end ones) connects to exactly two other nodes. So, we don’t have to worry about hitting dead ends.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>[<code>maze_to_path</code> function]</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1">maze_to_path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(edges) {</span>
<span id="cb3-2">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set up id</span></span>
<span id="cb3-3">  edges[, id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> .I]</span>
<span id="cb3-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setkey</span>(edges, id)</span>
<span id="cb3-5"></span>
<span id="cb3-6">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set up nodes data set</span></span>
<span id="cb3-7">  nodes <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(edges[, .(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y1)]</span>
<span id="cb3-8">                        , edges[, .(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y2)]))</span>
<span id="cb3-9">  nodes[, id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> .I]</span>
<span id="cb3-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setkey</span>(nodes, id)</span>
<span id="cb3-11"></span>
<span id="cb3-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add node ids to edges data set</span></span>
<span id="cb3-13">  edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">merge</span>(edges, nodes,</span>
<span id="cb3-14">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y1"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>),</span>
<span id="cb3-15">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">suffixes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_node_1"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">all.x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb3-16">  )</span>
<span id="cb3-17">  edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">merge</span>(edges, nodes,</span>
<span id="cb3-18">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y2"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"x"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"y"</span>),</span>
<span id="cb3-19">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">suffixes =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_node_2"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">all.x =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span></span>
<span id="cb3-20">  )</span>
<span id="cb3-21"></span>
<span id="cb3-22">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># nodes to edges look up table</span></span>
<span id="cb3-23">  nodes_edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(</span>
<span id="cb3-24">    edges[, .(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> id_node_1, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">edge =</span> id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">connecting_node =</span> id_node_2)],</span>
<span id="cb3-25">    edges[, .(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id =</span> id_node_2, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">edge =</span> id, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">connecting_node =</span> id_node_1)]</span>
<span id="cb3-26">  ))</span>
<span id="cb3-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">setkey</span>(nodes_edges, id)</span>
<span id="cb3-28"></span>
<span id="cb3-29">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># save spot for path</span></span>
<span id="cb3-30">  path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">vector</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">mode =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"numeric"</span>)</span>
<span id="cb3-31"></span>
<span id="cb3-32">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># variables to keep track of progress through the mase</span></span>
<span id="cb3-33">  last_node <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nodes[y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, id]</span>
<span id="cb3-34">  current_node <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nodes[y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, id]</span>
<span id="cb3-35"></span>
<span id="cb3-36">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># update path</span></span>
<span id="cb3-37">  path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">append</span>(path, current_node)</span>
<span id="cb3-38">  previous_node <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> current_node</span>
<span id="cb3-39"></span>
<span id="cb3-40">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># keep going to unexplored nodes</span></span>
<span id="cb3-41">  current_node <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nodes_edges[.(current_node), </span>
<span id="cb3-42">                              ][connecting_node <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> previous_node</span>
<span id="cb3-43">                                , connecting_node]</span>
<span id="cb3-44"></span>
<span id="cb3-45">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># continue through the whole path</span></span>
<span id="cb3-46">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">while</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(current_node) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb3-47">    path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">append</span>(path, current_node)</span>
<span id="cb3-48">    future_node <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> nodes_edges[.(current_node), </span>
<span id="cb3-49">                               ][connecting_node <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> previous_node</span>
<span id="cb3-50">                                 , connecting_node]</span>
<span id="cb3-51">    previous_node <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> current_node</span>
<span id="cb3-52">    current_node <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> future_node</span>
<span id="cb3-53">  }</span>
<span id="cb3-54"></span>
<span id="cb3-55">  path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(</span>
<span id="cb3-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">order =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(path)),</span>
<span id="cb3-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">node =</span> path</span>
<span id="cb3-58">  )</span>
<span id="cb3-59">  path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">merge</span>(path, nodes, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by.x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"node"</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by.y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"id"</span>))</span>
<span id="cb3-60">}</span></code></pre></div>
</details>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
Add in the images for signs
</h2>
</center>
<hr>
<p>Creating the signs takes place before creating the maze. Each image name has three parts: sign, course, and direction. The sign contains essential information on what the image is. The course is how the path moves (straight, turn right, etc.). Direction is where the path is coming from (east, north, etc.).</p>
<div class="cell">
<details open="" class="code-fold">
<summary>[first part of <code>create_signs</code> code]</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(data.table)</span>
<span id="cb4-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># do not enter</span></span>
<span id="cb4-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb4-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi, pi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> pi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.082</span>,</span>
<span id="cb4-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi, pi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> pi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.082</span></span>
<span id="cb4-9">  ), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#90091E"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#90091E"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"DO NOT</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">ENTER"</span>), </span>
<span id="cb4-11">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb4-16"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/do_not_enter_straight_south.png"</span>),</span>
<span id="cb4-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb4-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb4-19">)</span></code></pre></div>
</details>
</div>
<p>You can see the rest of the code here.</p>
<div class="cell">
<details class="code-fold">
<summary>[second part of <code>create_signs</code> code]</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">directions <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(</span>
<span id="cb5-2">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(</span>
<span id="cb5-3">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"east"</span>,</span>
<span id="cb5-4">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"north"</span>,</span>
<span id="cb5-5">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"west"</span>,</span>
<span id="cb5-6">    <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"south"</span></span>
<span id="cb5-7">  ),</span>
<span id="cb5-8">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">270</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)</span>
<span id="cb5-9">)</span>
<span id="cb5-10"></span>
<span id="cb5-11">circle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(</span>
<span id="cb5-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>)),</span>
<span id="cb5-13">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>))</span>
<span id="cb5-14">)</span>
<span id="cb5-15"></span>
<span id="cb5-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># square</span></span>
<span id="cb5-17">square <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(</span>
<span id="cb5-18">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb5-19">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-20">)</span>
<span id="cb5-21"></span>
<span id="cb5-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># diamond</span></span>
<span id="cb5-23">diamond <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(</span>
<span id="cb5-24">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb5-25">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb5-26">)</span>
<span id="cb5-27"></span>
<span id="cb5-28"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(directions)) {</span>
<span id="cb5-29">  current_direction <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> directions[i, direction]</span>
<span id="cb5-30">  current_angle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> directions[i, angle]</span>
<span id="cb5-31"></span>
<span id="cb5-32">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># light green dot</span></span>
<span id="cb5-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-34">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> circle, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), </span>
<span id="cb5-35">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#6FBD4B"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#6FBD4B"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-36">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-37">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-38">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-39">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb5-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/light_green_dot_straight_"</span>, </span>
<span id="cb5-41">                current_direction, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".png"</span>),</span>
<span id="cb5-42">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-43">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-44">  )</span>
<span id="cb5-45"></span>
<span id="cb5-46">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dark green dot</span></span>
<span id="cb5-47">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-48">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> circle, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>), </span>
<span id="cb5-49">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#235C09"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#235C09"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-50">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-51">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-52">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-53">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb5-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/dark_green_dot_straight_"</span>, </span>
<span id="cb5-55">                current_direction, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".png"</span>),</span>
<span id="cb5-56">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-57">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-58">  )</span>
<span id="cb5-59"></span>
<span id="cb5-60">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># yellow tape</span></span>
<span id="cb5-61">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (current_direction <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"north"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"south"</span>)) {</span>
<span id="cb5-62">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-63">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_rect</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-64">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">075</span>,</span>
<span id="cb5-65">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">075</span></span>
<span id="cb5-66">      ),</span>
<span id="cb5-67">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#EDE24C"</span>,</span>
<span id="cb5-68">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#EDE24C"</span></span>
<span id="cb5-69">      ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-70">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-71">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-72">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-73">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb5-74">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/yellow_tape_straight_"</span>, </span>
<span id="cb5-75">                  current_direction, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".png"</span>),</span>
<span id="cb5-76">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-77">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-78">    )</span>
<span id="cb5-79">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb5-80">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-81">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_rect</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-82">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">075</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb5-83">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">075</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb5-84">      ),</span>
<span id="cb5-85">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#EDE24C"</span>,</span>
<span id="cb5-86">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#EDE24C"</span></span>
<span id="cb5-87">      ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-88">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-89">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-90">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-91">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb5-92">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/yellow_tape_straight_"</span>, </span>
<span id="cb5-93">                  current_direction, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".png"</span>),</span>
<span id="cb5-94">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-95">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-96">    )</span>
<span id="cb5-97">  }</span>
<span id="cb5-98"></span>
<span id="cb5-99">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># wait here</span></span>
<span id="cb5-100">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-101">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> square, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y), </span>
<span id="cb5-102">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#4D8235"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#4D8235"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-103">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WAIT</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">HERE"</span>),</span>
<span id="cb5-104">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb5-105">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> current_angle</span>
<span id="cb5-106">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-107">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-108">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-109">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-110">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb5-111">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/wait_here_straight_"</span>, </span>
<span id="cb5-112">                current_direction, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".png"</span>),</span>
<span id="cb5-113">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-114">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-115">  )</span>
<span id="cb5-116"></span>
<span id="cb5-117">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (turn <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>)) {</span>
<span id="cb5-118">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-119">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> square, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y), </span>
<span id="cb5-120">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#4D8235"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#4D8235"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-121">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WAIT</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">HERE"</span>),</span>
<span id="cb5-122">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb5-123">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> current_angle</span>
<span id="cb5-124">      ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-125">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-126">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-127">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-128">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb5-129">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/wait_here_"</span>, turn, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, </span>
<span id="cb5-130">                  current_direction, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".png"</span>),</span>
<span id="cb5-131">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-132">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-133">    )</span>
<span id="cb5-134">  }</span>
<span id="cb5-135"></span>
<span id="cb5-136">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># wash your hands</span></span>
<span id="cb5-137">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-138">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> circle, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y), </span>
<span id="cb5-139">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#4D4D7A"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#4D4D7A"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-140">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WASH YOUR</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">HANDS"</span>),</span>
<span id="cb5-141">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb5-142">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> current_angle</span>
<span id="cb5-143">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-144">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-145">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-146">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-147">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb5-148">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/wash_your_hands_straight_"</span>, </span>
<span id="cb5-149">                current_direction, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".png"</span>),</span>
<span id="cb5-150">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-151">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-152">  )</span>
<span id="cb5-153"></span>
<span id="cb5-154">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (turn <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>)) {</span>
<span id="cb5-155">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-156">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> circle, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y), </span>
<span id="cb5-157">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#4D4D7A"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#4D4D7A"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-158">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WASH YOUR</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">HANDS"</span>),</span>
<span id="cb5-159">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb5-160">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> current_angle</span>
<span id="cb5-161">      ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-162">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-163">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-164">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-165">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb5-166">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/wash_your_hands_"</span>, turn, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, </span>
<span id="cb5-167">                  current_direction, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".png"</span>),</span>
<span id="cb5-168">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-169">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-170">    )</span>
<span id="cb5-171">  }</span>
<span id="cb5-172"></span>
<span id="cb5-173">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># wear a mask</span></span>
<span id="cb5-174">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-175">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> circle, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y), </span>
<span id="cb5-176">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#538479"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#538479"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-177">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WEAR A</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">MASK"</span>),</span>
<span id="cb5-178">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb5-179">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> current_angle</span>
<span id="cb5-180">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-181">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-182">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-183">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-184">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb5-185">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/wear_a_mask_straight_"</span>, </span>
<span id="cb5-186">                current_direction, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".png"</span>),</span>
<span id="cb5-187">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-188">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-189">  )</span>
<span id="cb5-190"></span>
<span id="cb5-191">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (turn <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>)) {</span>
<span id="cb5-192">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-193">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> circle, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y), </span>
<span id="cb5-194">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#538479"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#538479"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-195">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WEAR A</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">MASK"</span>),</span>
<span id="cb5-196">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb5-197">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> current_angle</span>
<span id="cb5-198">      ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-199">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-200">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-201">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-202">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb5-203">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/wear_a_mask_"</span>, turn, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, </span>
<span id="cb5-204">                  current_direction, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".png"</span>),</span>
<span id="cb5-205">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-206">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-207">    )</span>
<span id="cb5-208">  }</span>
<span id="cb5-209"></span>
<span id="cb5-210">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># wait six feet</span></span>
<span id="cb5-211">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-212">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> circle, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y), </span>
<span id="cb5-213">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#54707C"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#54707C"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-214">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WAIT </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">SIX FEET"</span>),</span>
<span id="cb5-215">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb5-216">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> current_angle</span>
<span id="cb5-217">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-218">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-219">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-220">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-221">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb5-222">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/wait_six_feet_straight_"</span>, </span>
<span id="cb5-223">                current_direction, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".png"</span>),</span>
<span id="cb5-224">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-225">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-226">  )</span>
<span id="cb5-227"></span>
<span id="cb5-228">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (turn <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>)) {</span>
<span id="cb5-229">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-230">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> circle, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y), </span>
<span id="cb5-231">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#54707C"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#54707C"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-232">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"WAIT </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">SIX FEET"</span>),</span>
<span id="cb5-233">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb5-234">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> current_angle</span>
<span id="cb5-235">      ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-236">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-237">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-238">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-239">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb5-240">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/wait_six_feet_"</span>, turn, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, </span>
<span id="cb5-241">                  current_direction, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".png"</span>),</span>
<span id="cb5-242">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-243">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-244">    )</span>
<span id="cb5-245">  }</span>
<span id="cb5-246"></span>
<span id="cb5-247">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 6 feet</span></span>
<span id="cb5-248">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> (current_direction <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%in%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"north"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"south"</span>)) {</span>
<span id="cb5-249">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-250">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> diamond, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y), </span>
<span id="cb5-251">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E1AD0F"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E1AD0F"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-252">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"6 FEET"</span>),</span>
<span id="cb5-253">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb5-254">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> current_angle</span>
<span id="cb5-255">      ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-256">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-257">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb5-258">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>),</span>
<span id="cb5-259">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb5-260">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>)</span>
<span id="cb5-261">      ),</span>
<span id="cb5-262">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineend =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"butt"</span>,</span>
<span id="cb5-263">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linejoin =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mitre"</span>,</span>
<span id="cb5-264">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb5-265">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>), </span>
<span id="cb5-266">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"closed"</span>),</span>
<span id="cb5-267">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb5-268">      ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-269">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-270">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-271">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-272">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb5-273">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/six_feet_straight_"</span>, </span>
<span id="cb5-274">                  current_direction, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".png"</span>),</span>
<span id="cb5-275">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-276">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-277">    )</span>
<span id="cb5-278">  } <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">else</span> {</span>
<span id="cb5-279">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-280">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> diamond, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y), </span>
<span id="cb5-281">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E1AD0F"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#E1AD0F"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-282">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"6 FEET"</span>),</span>
<span id="cb5-283">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,</span>
<span id="cb5-284">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> current_angle</span>
<span id="cb5-285">      ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-286">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-287">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>),</span>
<span id="cb5-288">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb5-289">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>),</span>
<span id="cb5-290">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb5-291">      ),</span>
<span id="cb5-292">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lineend =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"butt"</span>,</span>
<span id="cb5-293">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">linejoin =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"mitre"</span>,</span>
<span id="cb5-294">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>,</span>
<span id="cb5-295">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">arrow =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrow</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unit</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">0.05</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"npc"</span>), </span>
<span id="cb5-296">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"closed"</span>),</span>
<span id="cb5-297">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb5-298">      ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-299">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-300">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-301">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-302">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb5-303">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/six_feet_straight_"</span>, </span>
<span id="cb5-304">                  current_direction, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".png"</span>),</span>
<span id="cb5-305">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-306">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-307">    )</span>
<span id="cb5-308">  }</span>
<span id="cb5-309"></span>
<span id="cb5-310">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># one way</span></span>
<span id="cb5-311">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-312">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> square, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y), </span>
<span id="cb5-313">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#AB4343"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#AB4343"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-314">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ONE</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">WAY"</span>),</span>
<span id="cb5-315">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb5-316">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> current_angle</span>
<span id="cb5-317">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-318">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-319">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-320">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-321">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb5-322">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/one_way_straight_"</span>, </span>
<span id="cb5-323">                current_direction, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".png"</span>),</span>
<span id="cb5-324">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-325">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-326">  )</span>
<span id="cb5-327"></span>
<span id="cb5-328">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (turn <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>)) {</span>
<span id="cb5-329">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-330">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> square, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y), </span>
<span id="cb5-331">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#AB4343"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#AB4343"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-332">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"ONE</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">WAY"</span>),</span>
<span id="cb5-333">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>,</span>
<span id="cb5-334">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> current_angle</span>
<span id="cb5-335">      ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-336">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-337">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-338">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-339">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb5-340">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/one_way_"</span>, turn, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, </span>
<span id="cb5-341">                  current_direction, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".png"</span>),</span>
<span id="cb5-342">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-343">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-344">    )</span>
<span id="cb5-345">  }</span>
<span id="cb5-346">}</span>
<span id="cb5-347"></span>
<span id="cb5-348"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># arrow</span></span>
<span id="cb5-349"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-350">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-351">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>),</span>
<span id="cb5-352">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>)</span>
<span id="cb5-353">  ), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#444444"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#444444"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-354">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-355">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-356">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-357">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb5-358"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/arrow_straight_north.png"</span>),</span>
<span id="cb5-359">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-360">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-361">)</span>
<span id="cb5-362"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/arrow_right_north.png"</span>),</span>
<span id="cb5-363">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-364">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-365">)</span>
<span id="cb5-366"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/arrow_left_north.png"</span>),</span>
<span id="cb5-367">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-368">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-369">)</span>
<span id="cb5-370"></span>
<span id="cb5-371"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-372">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-373">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>),</span>
<span id="cb5-374">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>)</span>
<span id="cb5-375">  ), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#444444"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#444444"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-376">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-377">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-378">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-379">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb5-380"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/arrow_straight_south.png"</span>),</span>
<span id="cb5-381">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-382">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-383">)</span>
<span id="cb5-384"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/arrow_right_south.png"</span>),</span>
<span id="cb5-385">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-386">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-387">)</span>
<span id="cb5-388"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/arrow_left_south.png"</span>),</span>
<span id="cb5-389">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-390">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-391">)</span>
<span id="cb5-392"></span>
<span id="cb5-393"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-394">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-395">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>),</span>
<span id="cb5-396">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>)</span>
<span id="cb5-397">  ), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#444444"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#444444"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-398">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-399">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-400">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-401">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb5-402"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/arrow_straight_east.png"</span>),</span>
<span id="cb5-403">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-404">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-405">)</span>
<span id="cb5-406"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/arrow_right_east.png"</span>),</span>
<span id="cb5-407">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-408">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-409">)</span>
<span id="cb5-410"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/arrow_left_east.png"</span>),</span>
<span id="cb5-411">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-412">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-413">)</span>
<span id="cb5-414"></span>
<span id="cb5-415"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-416">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_polygon</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb5-417">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>),</span>
<span id="cb5-418">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>)</span>
<span id="cb5-419">  ),</span>
<span id="cb5-420">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#444444"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#444444"</span></span>
<span id="cb5-421">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-422">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-423">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-424">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-425">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb5-426"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/arrow_straight_west.png"</span>),</span>
<span id="cb5-427">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-428">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-429">)</span>
<span id="cb5-430"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/arrow_right_west.png"</span>),</span>
<span id="cb5-431">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-432">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-433">)</span>
<span id="cb5-434"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/arrow_left_west.png"</span>),</span>
<span id="cb5-435">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb5-436">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb5-437">)</span></code></pre></div>
</details>
</div>
<p>We’ll need to determine how the path moves and which images display that to add the images. Using information from the previous and next steps, we can determine which direction the path moves and whether it turns or stays straight. This data can be paired with information from the image names to choose images that fit in the maze.</p>
<p>For each node on the path, several images could work. So, we select one at random from a bag. A parameter determines the number of available images in the bag. A value of 0 has all possible images on each draw. A value of 1 only yields one image for each course (straight vs.&nbsp;turn).</p>
<div class="cell">
<details open="" class="code-fold">
<summary>[<code>get_image_data</code> function]</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">get_image_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(path, structure_parameter) {</span>
<span id="cb6-2"></span>
<span id="cb6-3">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Set up variables used to determine which images can be used</span></span>
<span id="cb6-4">  path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> path[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">order</span>(order), ]</span>
<span id="cb6-5">  path[, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">previous_x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shift</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lag"</span>),</span>
<span id="cb6-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">previous_y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shift</span>(y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lag"</span>),</span>
<span id="cb6-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">next_x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shift</span>(x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lead"</span>),</span>
<span id="cb6-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">next_y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">shift</span>(y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">type =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"lead"</span>))]</span>
<span id="cb6-9"></span>
<span id="cb6-10">  path[, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">course =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fifelse</span>(</span>
<span id="cb6-11">    previous_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> next_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> previous_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> next_y, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"straight"</span>,</span>
<span id="cb6-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fifelse</span>((y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> previous_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> next_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span></span>
<span id="cb6-13">      (x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> previous_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> next_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> y) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span></span>
<span id="cb6-14">      (y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> previous_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> next_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span></span>
<span id="cb6-15">      (x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> previous_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> next_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> y), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"right"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"left"</span>)</span>
<span id="cb6-16">  ),</span>
<span id="cb6-17">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fifelse</span>(</span>
<span id="cb6-18">    x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> next_x, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"east"</span>,</span>
<span id="cb6-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fifelse</span>(</span>
<span id="cb6-20">      y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> next_y, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"north"</span>,</span>
<span id="cb6-21">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fifelse</span>(</span>
<span id="cb6-22">        x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> next_x, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"west"</span>,</span>
<span id="cb6-23">        <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"south"</span></span>
<span id="cb6-24">      )</span>
<span id="cb6-25">    )</span>
<span id="cb6-26">  ))]</span>
<span id="cb6-27"></span>
<span id="cb6-28">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set up bag to hold the images</span></span>
<span id="cb6-29">  bag_pull <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(this_course, this_direction, bag) {</span>
<span id="cb6-30">    bag[course <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> this_course <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> direction <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> this_direction, </span>
<span id="cb6-31">        ][<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(.N, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), file]</span>
<span id="cb6-32">  }</span>
<span id="cb6-33"></span>
<span id="cb6-34">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># fill bag</span></span>
<span id="cb6-35">  bag <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.table</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">file =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list.files</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">full.names =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))</span>
<span id="cb6-36">  bag <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> bag[file <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/do_not_enter_straight_south.png"</span>, ]</span>
<span id="cb6-37"></span>
<span id="cb6-38">  bag[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sign"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"direction"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> </span>
<span id="cb6-39">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tstrsplit</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/|.png"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, file), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_(?!.*_)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perl =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)]</span>
<span id="cb6-40">  bag[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sign"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"course"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tstrsplit</span>(sign, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_(?!.*_)"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perl =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)]</span>
<span id="cb6-41">  bag[, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sub_course =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fifelse</span>(course <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"straight"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"straight"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"turn"</span>))]</span>
<span id="cb6-42"></span>
<span id="cb6-43">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># filter down to a smaller amount if the structure_parameter is large</span></span>
<span id="cb6-44">  bag_subset <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(bag[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sign"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sub_course"</span>)])</span>
<span id="cb6-45">  bag_subset <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(bag_subset[</span>
<span id="cb6-46">    , .SD[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(.N, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ceiling</span>(</span>
<span id="cb6-47">      (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (structure_parameter)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (.N <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))]</span>
<span id="cb6-48">    , <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> sub_course][, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sign"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sub_course"</span>)])</span>
<span id="cb6-49">  bag <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">merge</span>(bag, bag_subset, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sign"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"sub_course"</span>))</span>
<span id="cb6-50"></span>
<span id="cb6-51">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add images from bag</span></span>
<span id="cb6-52">  path[, image <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bag_pull</span>(course, direction, bag), by <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(path))]</span>
<span id="cb6-53"></span>
<span id="cb6-54">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Start and end</span></span>
<span id="cb6-55">  path[y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>, image <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/wait_here_straight_north.png"</span>]</span>
<span id="cb6-56">  path[y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, image <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"signs/do_not_enter_straight_south.png"</span>]</span>
<span id="cb6-57">}</span></code></pre></div>
</details>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
Finally, add the background and save
</h2>
</center>
<hr>
<p>After setting up the appropriate images, we only need to add a background. The background works by stacking small gray rectangles of various sizes with a low alpha value. This is supposed to resemble a grocery store floor.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>[final code]</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(data.table)</span>
<span id="cb7-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggplot2)</span>
<span id="cb7-3"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(ggimage)</span>
<span id="cb7-4"></span>
<span id="cb7-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"get_maze.R"</span>)</span>
<span id="cb7-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"update_maze.R"</span>)</span>
<span id="cb7-7"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"maze_to_path.R"</span>)</span>
<span id="cb7-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">source</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"get_image_data.R"</span>)</span>
<span id="cb7-9"></span>
<span id="cb7-10"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb7-11"><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (structure_parameter <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>)) {</span>
<span id="cb7-12">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> (num <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) {</span>
<span id="cb7-13">    edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_maze</span>(structure_parameter)</span>
<span id="cb7-14">    edges <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">update_maze</span>(edges)</span>
<span id="cb7-15">    path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">maze_to_path</span>(edges)</span>
<span id="cb7-16">    path <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_image_data</span>(path, structure_parameter)</span>
<span id="cb7-17"></span>
<span id="cb7-18">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># set up background floor</span></span>
<span id="cb7-19">    floor <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">CJ</span>(</span>
<span id="cb7-20">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>),</span>
<span id="cb7-21">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">10.5</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>)</span>
<span id="cb7-22">    )</span>
<span id="cb7-23">    floor[, color <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">9</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"D"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"E"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"F"</span>)), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb7-24">      by <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(floor))</span>
<span id="cb7-25">    ]</span>
<span id="cb7-26">    floor[, color <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="er" style="color: #AD0000;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#"</span>, color, color, color, color, color, color)]</span>
<span id="cb7-27">    floor[, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">":="</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>),</span>
<span id="cb7-28">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>),</span>
<span id="cb7-29">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>),</span>
<span id="cb7-30">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>)),</span>
<span id="cb7-31">    by <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq_len</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(floor))</span>
<span id="cb7-32">    ]</span>
<span id="cb7-33"></span>
<span id="cb7-34">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-35">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_rect</span>(</span>
<span id="cb7-36">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> floor,</span>
<span id="cb7-37">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(</span>
<span id="cb7-38">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> xmin, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> ymin,</span>
<span id="cb7-39">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> xmax, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> ymax,</span>
<span id="cb7-40">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color</span>
<span id="cb7-41">        ),</span>
<span id="cb7-42">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>,</span>
<span id="cb7-43">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span></span>
<span id="cb7-44">      ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-45">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-46">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_image</span>(</span>
<span id="cb7-47">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> path,</span>
<span id="cb7-48">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">image =</span> image)</span>
<span id="cb7-49">      ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-50">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-51">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">aspect.ratio =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb7-52">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"output/image_"</span>, structure_parameter <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, </span>
<span id="cb7-53">                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>, num, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".jpeg"</span>),</span>
<span id="cb7-54">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb7-55">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>,</span>
<span id="cb7-56">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">bg =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"#F3F3F3"</span></span>
<span id="cb7-57">    )</span>
<span id="cb7-58">  }</span>
<span id="cb7-59">}</span></code></pre></div>
</details>
</div>
<p>Now we can see the final outputs.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-03-pandemic-mazes/image_0_1.jpeg" class="img-fluid figure-img"></p>
<figcaption>Structure Parameter = 0, Run 1</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-03-pandemic-mazes/image_0_2.jpeg" class="img-fluid figure-img"></p>
<figcaption>Structure Parameter = 0, Run 2</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-03-pandemic-mazes/image_25_1.jpeg" class="img-fluid figure-img"></p>
<figcaption>Structure Parameter = .25, Run 1</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-03-pandemic-mazes/image_25_2.jpeg" class="img-fluid figure-img"></p>
<figcaption>Structure Parameter = .25, Run 2</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-03-pandemic-mazes/image_50_1.jpeg" class="img-fluid figure-img"></p>
<figcaption>Structure Parameter = .5, Run 1</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-03-pandemic-mazes/image_50_2.jpeg" class="img-fluid figure-img"></p>
<figcaption>Structure Parameter = .5, Run 2</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-03-pandemic-mazes/image_75_1.jpeg" class="img-fluid figure-img"></p>
<figcaption>Structure Parameter = .75, Run 1</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-03-pandemic-mazes/image_75_2.jpeg" class="img-fluid figure-img"></p>
<figcaption>Structure Parameter = .75, Run 2</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-03-pandemic-mazes/image_100_1.jpeg" class="img-fluid figure-img"></p>
<figcaption>Structure Parameter = 1, Run 1</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-05-03-pandemic-mazes/image_100_2.jpeg" class="img-fluid figure-img"></p>
<figcaption>Structure Parameter = 1, Run 2</figcaption>
</figure>
</div>
</div>
</div>
</div>



 ]]></description>
  <category>R</category>
  <category>Generative Art</category>
  <guid>https://www.williamtylerbradley.com/posts/2022-05-03-pandemic-mazes/</guid>
  <pubDate>Tue, 03 May 2022 04:00:00 GMT</pubDate>
  <media:content url="https://www.williamtylerbradley.com/posts/2022-05-03-pandemic-mazes/image_75_1.jpeg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Cohesive Graphs</title>
  <link>https://www.williamtylerbradley.com/posts/2022-03-01-cohesive-graphs/</link>
  <description><![CDATA[ 





<p>When creating a set of related graphs, it’s crucial to get all the details to match. This way, your document (report, dashboard, presentation, etc.) is easy to follow, reduces the chance of confusion or mistakes, and generally looks better. This blog post covers significant features to double-check before submitting graphics to someone. This way, you can learn from my experience of getting it wrong, getting told it was wrong by end-users, and then fixing it.</p>
<p>I think this subject isn’t covered in many visualization courses because they tend to focus on one chart at a time. You can see this in a lot of infographics where they only feature one large detailed graphic. These are helpful for many settings but less useful in business scenarios. Large singular images can help you answer detailed questions on one subject. For example, a line chart of revenue by day can show the change from May 5th to June 7th or which Monday had the highest amount. So you end up with one big graph that answers a lot of small questions.</p>
<p>However, you probably need a lot of small charts that answer one big vague question, like “how’s this initiative going?” or “what’s the effect of a changing population?”. These questions don’t need detailed information on one metric but smoother information on several. When you have multiple metrics, you’ll end up with many graphs, and they’ll need to work together to answer the big question.</p>
<p>This post won’t cover how much detail to remove since that’s dependent on the situation (sometimes you do need daily data), but it will focus on smoothing out differences in a set of charts. I’ll cover colors, order, and text. The process is pretty similar to branding, and following advice on that (<a href="https://drsimonj.svbtle.com/creating-corporate-colour-palettes-for-ggplot2">here</a> and <a href="https://michaeltoth.me/you-need-to-start-branding-your-graphs-heres-how-with-ggplot.html">here</a>) can help.</p>
<p>The graphs will appear side-by-side in the blog post but not in your actual document. So, there will be some redundancy (like having the legend in each one) on display. For each chart, imagine it’s multiple pages or clicks away from the other ones.</p>
<p><br></p>
<hr>
<center>
<h2 class="anchored">
Color
</h2>
</center>
<hr>
<p>People like your colors to match across all your graphs. The colors could be for discrete groups (like purple and green for different subpopulations), continuous scales (blue for low and yellow for high amounts), or emphasis (red for highlighting concern). We’ll compare inconsistent graphs to those that match in the following examples.</p>
<p>For discrete color matches across charts, make sure to use the same color for the same entity. In this example, classes A and B’s colors should be the same for all charts.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-03-01-cohesive-graphs/plot_1.png" class="img-fluid figure-img"></p>
<figcaption>Bad plots with changing color</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-03-01-cohesive-graphs/plot_2.png" class="img-fluid figure-img"></p>
<figcaption>Good plots with consistent color</figcaption>
</figure>
</div>
<p><br></p>
<p>Adding new levels will often break the matching colors. Here Class B changes drastically.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-03-01-cohesive-graphs/plot_3.png" class="img-fluid figure-img"></p>
<figcaption>Bad plots with changing color when adding new levels</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-03-01-cohesive-graphs/plot_4.png" class="img-fluid figure-img"></p>
<figcaption>Good plots with consistent color when adding new levels</figcaption>
</figure>
</div>
<p><br></p>
<p>For continuous color (and other scales), ensure the limits match across charts. If the charts need to be comparable, the color limits (and other limits, like the x-axis range) should match.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-03-01-cohesive-graphs/plot_5.png" class="img-fluid figure-img"></p>
<figcaption>Bad plots with changing color when expanding axes</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-03-01-cohesive-graphs/plot_6.png" class="img-fluid figure-img"></p>
<figcaption>Good plots with consistent color when expanding axes</figcaption>
</figure>
</div>
<p><br></p>
<p>This one is more of a judgment call than for discrete color. Sometimes you’ll want to focus on some detail, and having the broader limits won’t show that. So having different limits might be the better call as long as end-users can tell the differences quickly.</p>
<p><br></p>
<hr>
<center>
<h2 class="anchored">
Order
</h2>
</center>
<hr>
<p>Even if color is cohesive or unused, the order also needs to stick.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-03-01-cohesive-graphs/plot_7.png" class="img-fluid figure-img"></p>
<figcaption>Bad plots with changing order</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-03-01-cohesive-graphs/plot_8.png" class="img-fluid figure-img"></p>
<figcaption>Good plots with consistent order</figcaption>
</figure>
</div>
<p><br></p>
<p>There are options for determining the order that might change across graphs. As long as it’s evident that the change occurred because of the ordering process and that the process is more important than consistency, it should be fine.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-03-01-cohesive-graphs/plot_9.png" class="img-fluid figure-img"></p>
<figcaption>Order options</figcaption>
</figure>
</div>
<p>You can set the main entity first if it’s the most important or serves as a baseline.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-03-01-cohesive-graphs/plot_10.png" class="img-fluid figure-img"></p>
<figcaption>Order options with base level C</figcaption>
</figure>
</div>
<p><br></p>
<hr>
<center>
<h2 class="anchored">
Text
</h2>
</center>
<hr>
<p>Finally, ensuring consistency of the text across graphs smooths out transitions and easily builds up a big picture. There are fewer minor differences to compare, so important ones stand out.</p>
<p>In the following example, titles contain synonyms for “Customers” and “by Quarter.” These might be incorrect if members, accounts, customers, and users are different, especially for various end-users. In addition, the disparity for “by Quarter” can add confusion if end-users believe there is a difference when there isn’t one. Having consistency in the graphs’ text reduces the cognitive load and makes focusing on what the charts are showing easy.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-03-01-cohesive-graphs/plot_11.png" class="img-fluid figure-img"></p>
<figcaption>Bad plots with changing text</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-03-01-cohesive-graphs/plot_12.png" class="img-fluid figure-img"></p>
<figcaption>Good plots with consistent text</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>[Code]</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(patchwork)</span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Colors</span></span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Color schemes</span></span>
<span id="cb1-7">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>),</span>
<span id="cb1-8">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">56</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">87</span>))</span>
<span id="cb1-9"></span>
<span id="cb1-10">plot_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df,</span>
<span id="cb1-11">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Class, Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Class)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dark2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bad Plot 1"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-17"></span>
<span id="cb1-18">df_next <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>),</span>
<span id="cb1-19">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">78</span>))</span>
<span id="cb1-20"></span>
<span id="cb1-21">plot_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_next,</span>
<span id="cb1-22">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Class, Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Class)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Other Value"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bad Plot 2"</span>,</span>
<span id="cb1-26">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The colors are inconsistent."</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-29"></span>
<span id="cb1-30">plot_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_spacer</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">widths =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb1-31"></span>
<span id="cb1-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot_1.png"</span>,</span>
<span id="cb1-33">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb1-34">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>)</span>
<span id="cb1-35"></span>
<span id="cb1-36">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>),</span>
<span id="cb1-37">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">56</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">87</span>))</span>
<span id="cb1-38"></span>
<span id="cb1-39">plot_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df,</span>
<span id="cb1-40">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Class, Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Class)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dark2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Good Plot 1"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-46"></span>
<span id="cb1-47">df_next <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>),</span>
<span id="cb1-48">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">78</span>))</span>
<span id="cb1-49"></span>
<span id="cb1-50">plot_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_next,</span>
<span id="cb1-51">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Class, Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Class)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dark2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Other Value"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-55">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Good Plot 2"</span>,</span>
<span id="cb1-56">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The colors match across charts."</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-58">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-59"></span>
<span id="cb1-60">plot_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_spacer</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">widths =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb1-61"></span>
<span id="cb1-62"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot_2.png"</span>,</span>
<span id="cb1-63">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb1-64">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>)</span>
<span id="cb1-65"></span>
<span id="cb1-66"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Adding new level</span></span>
<span id="cb1-67">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>),</span>
<span id="cb1-68">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">56</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">87</span>))</span>
<span id="cb1-69"></span>
<span id="cb1-70">plot_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df,</span>
<span id="cb1-71">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Class, Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Class)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-73">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bad Plot 1"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-74">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-75">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-76"></span>
<span id="cb1-77">df_next <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"D"</span>),</span>
<span id="cb1-78">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">78</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">65</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>))</span>
<span id="cb1-79"></span>
<span id="cb1-80">plot_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_next,</span>
<span id="cb1-81">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Class, Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Class)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-82">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-83">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Other Value"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-84">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bad Plot 2"</span>,</span>
<span id="cb1-85">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The colors change when adding classes."</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-86">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-87">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-88"></span>
<span id="cb1-89">plot_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_spacer</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">widths =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb1-90"></span>
<span id="cb1-91"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot_3.png"</span>,</span>
<span id="cb1-92">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb1-93">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>)</span>
<span id="cb1-94"></span>
<span id="cb1-95">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>),</span>
<span id="cb1-96">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">56</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">87</span>))</span>
<span id="cb1-97"></span>
<span id="cb1-98">plot_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df,</span>
<span id="cb1-99">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Class, Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Class)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-100">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-101">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dark2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-102">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Good Plot 1"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-103">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-104">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-105"></span>
<span id="cb1-106">df_next <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"D"</span>),</span>
<span id="cb1-107">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">78</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">65</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>))</span>
<span id="cb1-108"></span>
<span id="cb1-109">plot_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_next,</span>
<span id="cb1-110">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Class, Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Class)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-111">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-112">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dark2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-113">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Other Value"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-114">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Good Plot 2"</span>,</span>
<span id="cb1-115">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The colors stay constant."</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-116">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-117">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-118"></span>
<span id="cb1-119">plot_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_spacer</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">widths =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb1-120"></span>
<span id="cb1-121"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot_4.png"</span>,</span>
<span id="cb1-122">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb1-123">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>)</span>
<span id="cb1-124"></span>
<span id="cb1-125"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># increasing/decreasing scales across graphs</span></span>
<span id="cb1-126"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">set.seed</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-127">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-128">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>),</span>
<span id="cb1-129">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>))</span>
<span id="cb1-130"></span>
<span id="cb1-131">plot_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df,</span>
<span id="cb1-132">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-133">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-134">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bad Plot 1"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-135">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-136">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-137"></span>
<span id="cb1-138">df_next <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-139">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>),</span>
<span id="cb1-140">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-141">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(df)</span>
<span id="cb1-142"></span>
<span id="cb1-143">plot_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_next,</span>
<span id="cb1-144">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-145">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-146">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bad Plot 2"</span>,</span>
<span id="cb1-147">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The scales change across charts."</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-148">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-149">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-150"></span>
<span id="cb1-151">plot_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_spacer</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">widths =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb1-152"></span>
<span id="cb1-153"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot_5.png"</span>,</span>
<span id="cb1-154">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb1-155">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>)</span>
<span id="cb1-156"></span>
<span id="cb1-157">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-158">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>),</span>
<span id="cb1-159">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>))</span>
<span id="cb1-160"></span>
<span id="cb1-161">plot_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df,</span>
<span id="cb1-162">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-163">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-164">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-165">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-166">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-167">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Good Plot 1"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-168">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-169">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-170"></span>
<span id="cb1-171">df_next <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-172">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>),</span>
<span id="cb1-173">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-174">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(df)</span>
<span id="cb1-175"></span>
<span id="cb1-176">plot_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_next,</span>
<span id="cb1-177">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-178">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-179">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-180">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-181">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-182">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Good Plot 2"</span>,</span>
<span id="cb1-183">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The scales match between charts."</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-184">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-185">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-186"></span>
<span id="cb1-187">plot_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_spacer</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">widths =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb1-188"></span>
<span id="cb1-189"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot_6.png"</span>,</span>
<span id="cb1-190">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb1-191">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>)</span>
<span id="cb1-192"></span>
<span id="cb1-193"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Category Order</span></span>
<span id="cb1-194"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># same order across graphs</span></span>
<span id="cb1-195">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>),</span>
<span id="cb1-196">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">56</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">87</span>))</span>
<span id="cb1-197"></span>
<span id="cb1-198">plot_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df,</span>
<span id="cb1-199">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Class, Value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-200">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-201">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bad Plot 1"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-202">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-203">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-204"></span>
<span id="cb1-205">df_next <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>),</span>
<span id="cb1-206">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">78</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-207">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(Class, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">levels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>)))</span>
<span id="cb1-208"></span>
<span id="cb1-209">plot_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_next,</span>
<span id="cb1-210">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Class, Value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-211">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-212">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Other Value"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-213">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bad Plot 2"</span>,</span>
<span id="cb1-214">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The class ordering changes."</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-215">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-216">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-217"></span>
<span id="cb1-218">plot_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_spacer</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">widths =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb1-219"></span>
<span id="cb1-220"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot_7.png"</span>,</span>
<span id="cb1-221">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb1-222">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>)</span>
<span id="cb1-223"></span>
<span id="cb1-224">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>),</span>
<span id="cb1-225">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">56</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">87</span>))</span>
<span id="cb1-226"></span>
<span id="cb1-227">plot_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df,</span>
<span id="cb1-228">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Class, Value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-229">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-230">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Good Plot 1"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-231">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-232">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-233"></span>
<span id="cb1-234">df_next <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>),</span>
<span id="cb1-235">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">78</span>))</span>
<span id="cb1-236"></span>
<span id="cb1-237">plot_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df_next,</span>
<span id="cb1-238">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Class, Value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-239">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-240">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Other Value"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-241">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Good Plot 2"</span>,</span>
<span id="cb1-242">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The ordering is constant"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-243">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-244">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-245"></span>
<span id="cb1-246">plot_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_spacer</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">widths =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb1-247"></span>
<span id="cb1-248"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot_8.png"</span>,</span>
<span id="cb1-249">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb1-250">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>)</span>
<span id="cb1-251"></span>
<span id="cb1-252"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Numeric (Values) vs Alphabet vs Importance</span></span>
<span id="cb1-253">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"D"</span>),</span>
<span id="cb1-254">                      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">36</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">78</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">65</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>))</span>
<span id="cb1-255"></span>
<span id="cb1-256">plot_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df,</span>
<span id="cb1-257">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Class, Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Class)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-258">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-259">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dark2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-260">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Alphabetical"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-261">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-262">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-263"></span>
<span id="cb1-264">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-265">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(Class, Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.desc =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>))</span>
<span id="cb1-266"></span>
<span id="cb1-267">plot_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df,</span>
<span id="cb1-268">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Class, Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Class)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-269">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-270">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dark2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-271">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Numerical"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-272">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-273">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-274"></span>
<span id="cb1-275">plot_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_spacer</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">widths =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb1-276"></span>
<span id="cb1-277"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot_9.png"</span>,</span>
<span id="cb1-278">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb1-279">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>)</span>
<span id="cb1-280"></span>
<span id="cb1-281">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-282">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">factor</span>(Class, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"A"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"B"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"D"</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-283">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">relevel</span>(Class, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span>))</span>
<span id="cb1-284"></span>
<span id="cb1-285">plot_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df,</span>
<span id="cb1-286">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Class, Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Class)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-287">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-288">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dark2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-289">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C is on the left"</span>,</span>
<span id="cb1-290">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Then alphabetical"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-291">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-292">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-293"></span>
<span id="cb1-294">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-295">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_reorder</span>(Class, Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">.desc =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">TRUE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-296">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Class =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">relevel</span>(Class, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C"</span>))</span>
<span id="cb1-297"></span>
<span id="cb1-298">plot_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df,</span>
<span id="cb1-299">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Class, Value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> Class)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-300">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_bar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">stat =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"identity"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-301">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_brewer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">palette =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Dark2"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-302">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C is on the left"</span>,</span>
<span id="cb1-303">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Then numerical"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-304">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-305">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-306"></span>
<span id="cb1-307">plot_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_spacer</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_layout</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">widths =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>))</span>
<span id="cb1-308"></span>
<span id="cb1-309"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot_10.png"</span>,</span>
<span id="cb1-310">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb1-311">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span>)</span>
<span id="cb1-312"></span>
<span id="cb1-313"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Text</span></span>
<span id="cb1-314">df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Quarter =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>),</span>
<span id="cb1-315">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">New =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1500</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3000</span>),</span>
<span id="cb1-316">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Left =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1500</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">500</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1250</span>),</span>
<span id="cb1-317">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Stayed =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">57000</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">54000</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-318">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">Total =</span> Stayed <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> New <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> Left)</span>
<span id="cb1-319"></span>
<span id="cb1-320">plot_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df,</span>
<span id="cb1-321">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Quarter, Total)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-322">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-323">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_limits</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-324">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Members by Quarter"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-325">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Members"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-326">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-327">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-328"></span>
<span id="cb1-329">plot_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df,</span>
<span id="cb1-330">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Quarter, New)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-331">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-332">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_limits</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-333">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"New Accounts Over Time"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-334">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"New Accounts"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-335">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-336">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-337"></span>
<span id="cb1-338">plot_3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df,</span>
<span id="cb1-339">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Quarter, Left)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-340">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-341">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_limits</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-342">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Customer Attrition Trend"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-343">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Customers"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-344">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-345">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-346"></span>
<span id="cb1-347">plot_4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df,</span>
<span id="cb1-348">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Quarter, Stayed)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-349">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-350">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_limits</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-351">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Retained Users"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-352">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Users"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-353">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-354">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-355"></span>
<span id="cb1-356">(plot_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (plot_3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_4) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-357">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Bad Plots"</span>,</span>
<span id="cb1-358">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>)</span>
<span id="cb1-359"></span>
<span id="cb1-360"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot_11.png"</span>,</span>
<span id="cb1-361">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb1-362">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb1-363"></span>
<span id="cb1-364">plot_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df,</span>
<span id="cb1-365">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Quarter, Total)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-366">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-367">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_limits</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-368">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Customers by Quarter"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-369">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Customers"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-370">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-371">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-372"></span>
<span id="cb1-373">plot_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df,</span>
<span id="cb1-374">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Quarter, New)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-375">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-376">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_limits</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-377">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"New Customers by Quarter"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-378">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"New Customers"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-379">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-380">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-381"></span>
<span id="cb1-382">plot_3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df,</span>
<span id="cb1-383">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Quarter, Left)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-384">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-385">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_limits</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-386">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Customer Attrition by Quarter"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-387">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Customers Lost"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-388">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-389">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-390"></span>
<span id="cb1-391">plot_4 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> df,</span>
<span id="cb1-392">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(Quarter, Stayed)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-393">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_line</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-394">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_limits</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-395">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Retained Customers by Quarter"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-396">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ylab</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Customers Retained"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-397">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_linedraw</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-398">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">text =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>))</span>
<span id="cb1-399"></span>
<span id="cb1-400">(plot_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (plot_3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> plot_4) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-401">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot_annotation</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">title =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Good Plots"</span>,</span>
<span id="cb1-402">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">subtitle =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"The plot text matches."</span>)</span>
<span id="cb1-403"></span>
<span id="cb1-404"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggsave</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"plot_12.png"</span>,</span>
<span id="cb1-405">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">width =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,</span>
<span id="cb1-406">       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">height =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span></code></pre></div>
</details>
</div>



 ]]></description>
  <category>Data Science</category>
  <guid>https://www.williamtylerbradley.com/posts/2022-03-01-cohesive-graphs/</guid>
  <pubDate>Tue, 01 Mar 2022 05:00:00 GMT</pubDate>
  <media:content url="https://www.williamtylerbradley.com/posts/2022-03-01-cohesive-graphs/plot_12.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>Constellations</title>
  <link>https://www.williamtylerbradley.com/posts/2022-02-28-constellations/</link>
  <description><![CDATA[ 





<p>This is a small generative art project based on constellations. The math behind it is pretty neat because it uses points on a sphere then projects to 2D. However, there’s no noticeable difference between this approach and starting from 2D. So I was disappointed in the results compared to the amount of work. I figured I’d go ahead and write this up in case someone else decides to attempt something similar.</p>
<p>The code can be found <a href="https://github.com/WilliamTylerBradley/constellations">here</a>. Unfortunately, the code and the outputs are not as polished as I would like. I got tired of the project and decided to wrap it up where it was, but I hope this can be useful.</p>
<p>Setting up the projection function first is crucial because I continuously use it to check the code. I’m using the <a href="https://en.wikipedia.org/wiki/Stereographic_projection">stereographic projection</a>. This projection will graph both hemispheres as big circles. I tried Nicolosi globular projection but found the lines curved too much. I also tried gnomonic projection since all great circles are straight lines, but it doesn’t graph the whole hemisphere nicely. Stereographic is an excellent compromise, but I wish all the lines connecting the stars were straight.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-2"></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># df needs:</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># x, y, z on unit sphere</span></span>
<span id="cb1-5">projection <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(df) {</span>
<span id="cb1-6">  </span>
<span id="cb1-7">  df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">lat =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">asin</span>(z),</span>
<span id="cb1-9">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">long =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">atan2</span>(y, x)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">new_x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> z), x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> z) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb1-11">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">new_y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> z), y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> z)))</span>
<span id="cb1-12">  </span>
<span id="cb1-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(df)</span>
<span id="cb1-14">}</span></code></pre></div>
</div>
<p>To set the stars and constellation centers, I used <a href="https://gist.github.com/mbostock/1893974">Mitchell’s best candidate algorithm</a> for the disk sampling method. This algorithm will space out points without putting any too close together. The code starts with one random point on the unit sphere, creates <code>candidates_n</code> new points, finds the one farthest away from the previously drawn point, and accepts it if it’s past the <code>distance_limit</code> from the already selected point. Then, for the following <code>points_n</code> times, random points are drawn, compared, and possibly selected. The function can return fewer than <code>points_n</code> points if either the <code>points_n</code> or <code>distance_limit</code> is too large.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># points_n, approx. number of final points</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># candidates_n, number of attempts per point</span></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># distance_limit, minimum distance between points</span></span>
<span id="cb2-4">disk_sampling <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(points_n, candidates_n, distance_limit) {</span>
<span id="cb2-5">  </span>
<span id="cb2-6">  df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb2-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, points_n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb2-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, points_n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb2-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, points_n <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb2-10">  ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normalize =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> z<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normalize =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(normalize <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, normalize)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normalize,</span>
<span id="cb2-14">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normalize,</span>
<span id="cb2-15">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normalize) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-16">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>normalize) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-17">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowid_to_column</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"id"</span>) </span>
<span id="cb2-18">  </span>
<span id="cb2-19">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, points_n)) {</span>
<span id="cb2-20">    </span>
<span id="cb2-21">    candidates <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb2-22">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">can_x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(candidates_n),</span>
<span id="cb2-23">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">can_y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(candidates_n),</span>
<span id="cb2-24">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">can_z =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(candidates_n)</span>
<span id="cb2-25">    ) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-26">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normalize =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(can_x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> can_y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> can_z<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-27">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">can_x =</span> can_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normalize,</span>
<span id="cb2-28">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">can_y =</span> can_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normalize,</span>
<span id="cb2-29">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">can_z =</span> can_z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normalize) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-30">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>normalize) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-31">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowid_to_column</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"can_id"</span>) </span>
<span id="cb2-32">    </span>
<span id="cb2-33">    best_candidate <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-34">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-35">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_grid</span>(candidates) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-36">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">distance =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">acos</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> can_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-37">                               y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> can_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-38">                               z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> can_z)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-39">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(can_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-40">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">summarise</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">distance =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(distance)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-41">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(distance <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(distance)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-42">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(distance <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> distance_limit) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-43">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">slice</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-44">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(can_id)</span>
<span id="cb2-45">    </span>
<span id="cb2-46">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(best_candidate) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb2-47">      best_candidate <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> candidates <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-48">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(can_id <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> best_candidate) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-49">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">can_id =</span> i) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-50">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename_with</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"can_"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, .x))</span>
<span id="cb2-51">      </span>
<span id="cb2-52">      df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-53">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rows_update</span>(best_candidate, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"id"</span>)</span>
<span id="cb2-54">    }</span>
<span id="cb2-55">    </span>
<span id="cb2-56">  }</span>
<span id="cb2-57">  </span>
<span id="cb2-58">  df <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-59">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span>
<span id="cb2-60">  </span>
<span id="cb2-61">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(df)</span>
<span id="cb2-62">}</span></code></pre></div>
</div>
<p>The following function chooses the lines that connect the stars for a single constellation. All of the lines are great circles on the unit sphere. That changes the math from typical line intersections. I don’t want any of the lines to cross. So we’ll first list out all the intersections. Then we’ll select one star at random and pull one of the lines connected to that star. I want higher probabilities on shorter lines. So the selection is weighted by the inverse of the line length. We’ll use the intersection list we previously found to avoid line crossing by removing any crossing lines from future selection. Then, we select the next star and repeat until all stars are connected.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># df needs x, y, z</span></span>
<span id="cb3-2">connections <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(df) {</span>
<span id="cb3-3">  </span>
<span id="cb3-4">  lines <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(</span>
<span id="cb3-5">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">line_id_1_2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb3-6">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id_2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb3-7">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id_1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">integer</span>(),</span>
<span id="cb3-8">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x_2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(),</span>
<span id="cb3-9">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x_1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(),</span>
<span id="cb3-10">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y_2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(),</span>
<span id="cb3-11">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y_1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(),</span>
<span id="cb3-12">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z_2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>(),</span>
<span id="cb3-13">    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z_1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">numeric</span>()</span>
<span id="cb3-14">  )</span>
<span id="cb3-15">  </span>
<span id="cb3-16">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(df) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) {</span>
<span id="cb3-17">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(lines)</span>
<span id="cb3-18">  }</span>
<span id="cb3-19">  </span>
<span id="cb3-20">  connections <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">starts_with</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"star"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename_with</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"star_"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, .x), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_1"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-23">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(id_1, x_1, y_1, z_1)</span>
<span id="cb3-24">  </span>
<span id="cb3-25">  connections <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> connections <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-26">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename_with</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, .x), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-27">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_grid</span>(connections) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-28">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(id_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> id_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-29">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">a_1_2 =</span> y_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> z_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> z_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y_2,</span>
<span id="cb3-30">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">b_1_2 =</span> z_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> z_2,</span>
<span id="cb3-31">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">c_1_2 =</span> x_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-32">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowid_to_column</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"line_id_1_2"</span>)</span>
<span id="cb3-33">  </span>
<span id="cb3-34">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://blog.mbedded.ninja/mathematics/geometry/spherical-geometry/finding-the-intersection-of-two-arcs-that-lie-on-a-sphere/</span></span>
<span id="cb3-35">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://www.dirkbertels.net/computing/greatCircles_files/great_circles_070206.pdf</span></span>
<span id="cb3-36">  intersections <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> connections <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-37">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename_with</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"1"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"3"</span>, .x)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-38">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename_with</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"2"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"4"</span>, .x)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> </span>
<span id="cb3-39">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_grid</span>(connections) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-40">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(line_id_1_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> line_id_3_4) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-41">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>((id_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> id_3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> id_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> id_4) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span></span>
<span id="cb3-42">             (id_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> id_3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> id_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!=</span> id_4)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># remove ones that share a star</span></span>
<span id="cb3-43">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">l_1 =</span> b_1_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> c_3_4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> c_1_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> b_3_4,</span>
<span id="cb3-44">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">m_1 =</span> c_1_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> a_3_4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> a_1_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> c_3_4,</span>
<span id="cb3-45">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_1 =</span> a_1_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> b_3_4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> b_1_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> a_3_4) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-46">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normal =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(l_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> m_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> n_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-47">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">l_1 =</span> l_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normal,</span>
<span id="cb3-48">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">m_1 =</span> m_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normal,</span>
<span id="cb3-49">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_1 =</span> n_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normal) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-50">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">l_2 =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>l_1,</span>
<span id="cb3-51">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">m_2 =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>m_1,</span>
<span id="cb3-52">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n_2 =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>n_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-53">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normal_1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(x_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> z_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb3-54">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normal_2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(x_2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y_2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> z_2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb3-55">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normal_3 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(x_3<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y_3<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> z_3<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb3-56">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normal_4 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(x_4<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y_4<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> z_4<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb3-57">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normal_l_1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(l_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> m_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> n_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb3-58">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normal_l_2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(l_2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> m_2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> n_2<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># technically, all 1's</span></span>
<span id="cb3-59">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle_1_l_1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">acos</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>((x_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> l_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> m_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> z_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> n_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> </span>
<span id="cb3-60">                                      (normal_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> normal_l_1), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>pi,</span>
<span id="cb3-61">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle_l_1_2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">acos</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>((x_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> l_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> m_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> z_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> n_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> </span>
<span id="cb3-62">                                      (normal_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> normal_l_1), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>pi,</span>
<span id="cb3-63">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle_1_l_2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">acos</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>((x_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> l_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> m_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> z_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> n_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> </span>
<span id="cb3-64">                                      (normal_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> normal_l_2), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>pi,</span>
<span id="cb3-65">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle_l_2_2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">acos</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>((x_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> l_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> m_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> z_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> n_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> </span>
<span id="cb3-66">                                      (normal_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> normal_l_2), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>pi,</span>
<span id="cb3-67">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle_1_2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">acos</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>((x_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> z_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> z_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> </span>
<span id="cb3-68">                                    (normal_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> normal_2), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>pi,</span>
<span id="cb3-69">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle_3_l_1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">acos</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>((x_3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> l_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y_3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> m_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> z_3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> n_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> </span>
<span id="cb3-70">                                      (normal_3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> normal_l_1), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>pi,</span>
<span id="cb3-71">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle_l_1_4 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">acos</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>((x_4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> l_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y_4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> m_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> z_4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> n_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> </span>
<span id="cb3-72">                                      (normal_4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> normal_l_1), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>pi,</span>
<span id="cb3-73">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle_3_l_2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">acos</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>((x_3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> l_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y_3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> m_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> z_3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> n_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> </span>
<span id="cb3-74">                                      (normal_3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> normal_l_2), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>pi,</span>
<span id="cb3-75">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle_l_2_4 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">acos</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>((x_4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> l_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y_4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> m_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> z_4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> n_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> </span>
<span id="cb3-76">                                      (normal_4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> normal_l_2), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>pi,</span>
<span id="cb3-77">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle_3_4 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">acos</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">round</span>((x_3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x_4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y_3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y_4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> z_3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> z_4) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> </span>
<span id="cb3-78">                                    (normal_3 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> normal_4), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>pi) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-79">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sum_angle_1_l_1_2 =</span> angle_1_l_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> angle_l_1_2,</span>
<span id="cb3-80">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sum_angle_1_l_2_2 =</span> angle_1_l_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> angle_l_2_2,</span>
<span id="cb3-81">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sum_angle_3_l_1_4 =</span> angle_3_l_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> angle_l_1_4,</span>
<span id="cb3-82">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sum_angle_3_l_2_4 =</span> angle_3_l_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> angle_l_2_4) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-83">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">on_segment_1_l_1_2 =</span> </span>
<span id="cb3-84">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(sum_angle_1_l_1_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> angle_1_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">001</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb3-85">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">on_segment_1_l_2_2 =</span> </span>
<span id="cb3-86">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(sum_angle_1_l_2_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> angle_1_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">001</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb3-87">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">on_segment_3_l_1_4 =</span> </span>
<span id="cb3-88">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(sum_angle_3_l_1_4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> angle_3_4) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">001</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>),</span>
<span id="cb3-89">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">on_segment_3_l_2_4 =</span> </span>
<span id="cb3-90">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(sum_angle_3_l_2_4 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> angle_3_4) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">001</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-91">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intersects =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>((on_segment_1_l_1_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> on_segment_3_l_1_4) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span></span>
<span id="cb3-92">                                  (on_segment_1_l_2_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> on_segment_3_l_2_4),</span>
<span id="cb3-93">                                <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-94">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(intersects <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb3-95">  </span>
<span id="cb3-96">  <span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Loop through adding one at a time</span></span>
<span id="cb3-97">  star_list <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> df <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-98">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>())) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-99">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pull</span>(star_id)</span>
<span id="cb3-100">  </span>
<span id="cb3-101">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span>(i <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">length</span>(star_list))) {</span>
<span id="cb3-102">    current_star <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> star_list[i]</span>
<span id="cb3-103">    potential_lines <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> connections <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-104">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(id_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> current_star <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> id_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> current_star) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-105">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anti_join</span>(lines, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"line_id_1_2"</span>)</span>
<span id="cb3-106">    </span>
<span id="cb3-107">    <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># remove intersections</span></span>
<span id="cb3-108">    limit_lines <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> intersections <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-109">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(line_id_1_2, line_id_3_4)</span>
<span id="cb3-110">    limit_lines <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> intersections <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-111">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(line_id_1_2, line_id_3_4) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-112">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">line_id_1_2 =</span> line_id_3_4,</span>
<span id="cb3-113">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">line_id_3_4 =</span> line_id_1_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-114">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(limit_lines) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-115">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">inner_join</span>(lines, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"line_id_1_2"</span>)</span>
<span id="cb3-116">    limit_lines <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> limit_lines <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-117">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(line_id_1_2, line_id_3_4)</span>
<span id="cb3-118">    limit_lines <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> limit_lines <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-119">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(line_id_1_2, line_id_3_4) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-120">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">line_id_1_2 =</span> line_id_3_4,</span>
<span id="cb3-121">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">line_id_3_4 =</span> line_id_1_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-122">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(limit_lines)</span>
<span id="cb3-123">    </span>
<span id="cb3-124">    potential_lines <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> potential_lines <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-125">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">anti_join</span>(limit_lines, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"line_id_1_2"</span>))</span>
<span id="cb3-126">    </span>
<span id="cb3-127">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nrow</span>(potential_lines) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) {</span>
<span id="cb3-128">      lines <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> potential_lines <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-129">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weight =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">acos</span>(x_1<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>x_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-130">                               y_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-131">                               z_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> z_2)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-132">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample_n</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">weight =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>weight) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># add weights here</span></span>
<span id="cb3-133">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>weight) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-134">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(lines)</span>
<span id="cb3-135">    }</span>
<span id="cb3-136">  }</span>
<span id="cb3-137">  </span>
<span id="cb3-138">  lines <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> lines <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-139">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>a_1_2, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>b_1_2, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>c_1_2)</span>
<span id="cb3-140">  </span>
<span id="cb3-141">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(lines)</span>
<span id="cb3-142">}</span></code></pre></div>
</div>
<p>For the sky, we’ll start with 88 constellation centers using the disk sampling method. For the stars, we’ll set up eight sets of 33 stars. Each set of 33 stars is spaced nicely, while having eight groups adds a little noise.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1">constellations <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">disk_sampling</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">88</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowid_to_column</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"id"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename_with</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"constellation_"</span>, .x))</span>
<span id="cb4-5"></span>
<span id="cb4-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 88 * 3</span></span>
<span id="cb4-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># 264 / 8 = 33</span></span>
<span id="cb4-8">stars <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">disk_sampling</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">33</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>),</span>
<span id="cb4-9">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">disk_sampling</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">33</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>),</span>
<span id="cb4-10">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">disk_sampling</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">33</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>),</span>
<span id="cb4-11">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">disk_sampling</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">33</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>),</span>
<span id="cb4-12">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">disk_sampling</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">33</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>),</span>
<span id="cb4-13">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">disk_sampling</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">33</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>),</span>
<span id="cb4-14">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">disk_sampling</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">33</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>),</span>
<span id="cb4-15">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">disk_sampling</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">33</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowid_to_column</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"id"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename_with</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"star_"</span>, .x))</span></code></pre></div>
</div>
<p>We’ll find the closest star to each constellation center and combine them. Checking that they don’t cross over from one hemisphere to the other keeps the constellation in only one of the big circles after projecting. We’ll move each star a little closer to the constellation center to create a bit more distance between the constellations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1">sky <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> constellations <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_grid</span>(stars) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">distance =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">acos</span>(constellation_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> star_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-4">                           constellation_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> star_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-5">                           constellation_z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> star_z)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign</span>(star_z) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign</span>(constellation_z)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># make sure they cross over line</span></span>
<span id="cb5-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(star_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-8">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(distance <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">min</span>(distance))</span>
<span id="cb5-9"></span>
<span id="cb5-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://math.stackexchange.com/questions/2375102/parametric-equation-of-a-circle-in-3d-given-center-and-two-points-on-the-circle</span></span>
<span id="cb5-11">move_percentage <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span></span>
<span id="cb5-12">star_movement <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> sky <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normal_x =</span> star_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> constellation_z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> star_z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> constellation_y,</span>
<span id="cb5-14">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normal_y =</span> star_z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> constellation_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> star_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> constellation_z,</span>
<span id="cb5-15">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normal_z =</span> star_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> constellation_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> star_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> constellation_x,</span>
<span id="cb5-16">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">interior =</span> star_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> constellation_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-17">           star_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> constellation_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb5-18">           star_z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> constellation_z) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normal_norm =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(normal_x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> normal_y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> normal_z<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normal_x =</span> normal_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normal_norm,</span>
<span id="cb5-21">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normal_y =</span> normal_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normal_norm,</span>
<span id="cb5-22">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normal_z =</span> normal_z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normal_norm) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">angle =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">acos</span>(interior) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> move_percentage,</span>
<span id="cb5-24">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perp_x =</span> normal_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> star_z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> normal_z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> star_y,</span>
<span id="cb5-25">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perp_y =</span> normal_z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> star_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> normal_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> star_z,</span>
<span id="cb5-26">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perp_z =</span> normal_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> star_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> normal_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> star_x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perp_norm =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(perp_x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> perp_y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> perp_z<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perp_x =</span> perp_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> perp_norm,</span>
<span id="cb5-29">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perp_y =</span> perp_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> perp_norm,</span>
<span id="cb5-30">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perp_z =</span> perp_z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> perp_norm) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-31">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">star_x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(angle) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> star_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(angle) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> perp_x,</span>
<span id="cb5-32">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">star_y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(angle) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> star_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(angle) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> perp_y,</span>
<span id="cb5-33">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">star_z =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(angle) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> star_z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(angle) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> perp_z)</span>
<span id="cb5-34">         </span>
<span id="cb5-35">star_movement <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> star_movement <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(star_id, star_x, star_y, star_z) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename_with</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">gsub</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"star_"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>, .x)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rename_with</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste0</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"star_"</span>, .x))</span>
<span id="cb5-39"></span>
<span id="cb5-40">sky <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> sky <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rows_update</span>(star_movement, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">by =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"star_id"</span>)</span>
<span id="cb5-42"></span>
<span id="cb5-43">sky <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> sky <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>distance) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rownames_to_column</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"row"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-46">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">cols =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>row,</span>
<span id="cb5-47">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"object"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".value"</span>),</span>
<span id="cb5-48">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_sep =</span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">projection</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id_cols =</span> row,</span>
<span id="cb5-51">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> object,</span>
<span id="cb5-52">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_glue =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"{object}_{.value}"</span>,</span>
<span id="cb5-53">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(id, x, y, z, lat, long,</span>
<span id="cb5-54">                              new_x, new_y)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-55">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>row)</span></code></pre></div>
</div>
<p>Now that we have the stars in their final positions and set to a constellation, we can add the lines.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1">lines <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> sky <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(constellation_id, star_id,</span>
<span id="cb6-3">         star_x, star_y, star_z) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-4">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">nest</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(star_id, star_x, star_y, star_z)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-5">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map</span>(data, connections)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unnest</span>(data)</span>
<span id="cb6-7"></span>
<span id="cb6-8">lines <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> lines <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_longer</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(constellation_id, line_id_1_2),</span>
<span id="cb6-10">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_to =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">".value"</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"star"</span>),</span>
<span id="cb6-11">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_sep =</span>  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"_"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">projection</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pivot_wider</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">id_cols =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(constellation_id, line_id_1_2),</span>
<span id="cb6-14">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">names_from =</span> star,</span>
<span id="cb6-15">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">values_from =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(id, x, y, z, lat, long,</span>
<span id="cb6-16">                              new_x, new_y))</span>
<span id="cb6-17"></span>
<span id="cb6-18"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://math.stackexchange.com/questions/383711/parametric-equation-for-great-circle</span></span>
<span id="cb6-19">curves <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> lines <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">f =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">d =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">acos</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(lat_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(lat_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(lat_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(lat_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(long_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> long_2))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">A =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> f) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> d) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(d),</span>
<span id="cb6-23">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">B =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(f <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> d) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(d)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> A <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(lat_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(long_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> B <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(lat_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(long_2),</span>
<span id="cb6-25">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> A <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(lat_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(long_1) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> B <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(lat_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(long_2),</span>
<span id="cb6-26">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> A <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(lat_1)               <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> B <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(lat_2)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(constellation_id, line_id_1_2, x, y, z) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">projection</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(constellation_id, line_id_1_2) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">next_new_x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lead</span>(new_x),</span>
<span id="cb6-31">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">next_new_y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lead</span>(new_y)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(next_new_x))</span></code></pre></div>
</div>
<p>The last part adds some background stars, the outline circles, and randomizes the features a little bit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">base_hue <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">260</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)</span>
<span id="cb7-2">base_chroma <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb7-3">dark_luminance <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb7-4">med_luminance <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb7-5">light_luminance <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb7-6">bright_luminance <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)</span>
<span id="cb7-7"></span>
<span id="cb7-8">background_stars_n <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span></span>
<span id="cb7-9">background_stars <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb7-10">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(background_stars_n),</span>
<span id="cb7-11">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(background_stars_n),</span>
<span id="cb7-12">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(background_stars_n)</span>
<span id="cb7-13">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normalize =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> z<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normalize =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(normalize <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, normalize)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normalize,</span>
<span id="cb7-17">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normalize,</span>
<span id="cb7-18">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normalize) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>normalize) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rowid_to_column</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"id"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">projection</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hue =</span> base_hue <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>),</span>
<span id="cb7-23">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">chroma =</span> base_chroma <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>),</span>
<span id="cb7-24">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">luminance =</span> med_luminance <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">chroma =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(chroma <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, base_chroma, chroma),</span>
<span id="cb7-26">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">luminance =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(luminance <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">|</span> luminance <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, </span>
<span id="cb7-27">                             med_luminance, luminance)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(hue, chroma, luminance),</span>
<span id="cb7-29">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(), .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(color_value), </span>
<span id="cb7-31">                               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(base_hue, base_chroma, med_luminance),</span>
<span id="cb7-32">                               color_value))</span>
<span id="cb7-33"></span>
<span id="cb7-34">outline_circles <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tibble</span>(</span>
<span id="cb7-35">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">circle_id =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">each =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb7-36">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb7-37">  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb7-38">) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(circle_id<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>),</span>
<span id="cb7-40">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(y)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(circle_id) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lead</span>(x),</span>
<span id="cb7-43">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lead</span>(y)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(xend)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hue =</span> base_hue,</span>
<span id="cb7-46">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">chroma =</span> base_chroma,</span>
<span id="cb7-47">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">luminance =</span> med_luminance) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-48">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(hue, chroma, luminance))</span>
<span id="cb7-49"></span>
<span id="cb7-50">sky <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> sky <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hue =</span> base_hue <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>),</span>
<span id="cb7-52">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">chroma =</span> (base_chroma <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb7-53">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">luminance =</span> bright_luminance <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(), <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">sd =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-54">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(hue, chroma, luminance),</span>
<span id="cb7-55">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>(), .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">if_else</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(color_value), </span>
<span id="cb7-57">                               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(base_hue, base_chroma, bright_luminance),</span>
<span id="cb7-58">                               color_value))</span></code></pre></div>
</div>
<p>Finally, we graph everything.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> outline_circles, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y, </span>
<span id="cb8-3">                                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> xend, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> yend,</span>
<span id="cb8-4">                                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">group =</span> circle_id,</span>
<span id="cb8-5">                                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color_value),</span>
<span id="cb8-6">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> background_stars, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> new_x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> new_y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color_value,</span>
<span id="cb8-8">                                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> size_value),</span>
<span id="cb8-9">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> curves, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> new_x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> new_y,</span>
<span id="cb8-11">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> next_new_x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> next_new_y),</span>
<span id="cb8-12">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(base_hue, base_chroma, light_luminance),</span>
<span id="cb8-13">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> sky, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> star_new_x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> star_new_y, </span>
<span id="cb8-15">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(base_hue, base_chroma, dark_luminance),</span>
<span id="cb8-16">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> size_value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> sky, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> star_new_x, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> star_new_y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color_value,</span>
<span id="cb8-18">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> size_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_radius</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">range =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">01</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb8-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">plot.background =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_rect</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(base_hue, base_chroma, dark_luminance)),</span>
<span id="cb8-26">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"none"</span>)</span></code></pre></div>
</div>
<p>Here are the first five images using <code>set.seed(x)</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-02-28-constellations/constellations_1.jpeg" class="img-fluid figure-img"></p>
<figcaption>Image 1</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-02-28-constellations/constellations_2.jpeg" class="img-fluid figure-img"></p>
<figcaption>Image 2</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-02-28-constellations/constellations_3.jpeg" class="img-fluid figure-img"></p>
<figcaption>Image 3</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-02-28-constellations/constellations_4.jpeg" class="img-fluid figure-img"></p>
<figcaption>Image 4</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2022-02-28-constellations/constellations_5.jpeg" class="img-fluid figure-img"></p>
<figcaption>Image 5</figcaption>
</figure>
</div>



 ]]></description>
  <category>R</category>
  <category>Generative Art</category>
  <guid>https://www.williamtylerbradley.com/posts/2022-02-28-constellations/</guid>
  <pubDate>Mon, 28 Feb 2022 05:00:00 GMT</pubDate>
  <media:content url="https://www.williamtylerbradley.com/posts/2022-02-28-constellations/constellations_1.jpeg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>AZ-900 Exam Flashcards</title>
  <link>https://www.williamtylerbradley.com/posts/2021-12-20-az-900-exam-flashcards/</link>
  <description><![CDATA[ 





<p>I recently passed the <a href="https://docs.microsoft.com/en-us/learn/certifications/exams/az-900">AZ-900: Microsoft Azure Fundamentals</a> exam. To help study, I created a set of flashcards using a reveal.js presentation from an Excel file of terms/definitions. The repo is <a href="https://github.com/WilliamTylerBradley/az_900">here</a>, with the presentation found <a href="https://williamtylerbradley.github.io/az_900/az_900_flashcards.html#/">here</a> The terms come from the official skills measured document for 2021.</p>
<p>The R code is pretty simple. To set up the presentation, you’ll need the latest version of the revealjs package (Any version of reveal.js past version 4 should work for the r-stack option.). The following front-matter setup should work fine. You can turn on the shuffle option to shuffle the cards every time the document is re-knitted.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">---</span></span>
<span id="cb1-2">output<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> </span>
<span id="cb1-3">  revealjs<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">::</span>revealjs_presentation<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb1-4">    incremental<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> false</span>
<span id="cb1-5">    transition<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span></span>
<span id="cb1-6">    background_transition<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'none'</span></span>
<span id="cb1-7">    slide_level<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span></span>
<span id="cb1-8">    css<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> custom.css</span>
<span id="cb1-9">    reveal_options<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span></span>
<span id="cb1-10">      controls<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> false</span>
<span id="cb1-11">      slideNumber<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> false</span>
<span id="cb1-12">      progress<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> false</span>
<span id="cb1-13">      <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># shuffle: true # uncomment to randomize cards</span></span>
<span id="cb1-14">    self_contained<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span> false</span>
<span id="cb1-15"><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">---</span></span></code></pre></div>
</div>
<p>The following code is the only markdown needed. It’ll read in the Excel file and loop through the rows to create the presentation. Each flashcard is a different slide. The term is the first fragment with the definition second because the r-stack places them on top of each other. The data-fragment-index is the same for both, so the term will fade out while the definition fades in on the same click. The line of breaks moves the term up a little. I just think it looks a little better.</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">```</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">{r results='asis', echo=FALSE}</span></span>
<span id="cb2-2"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">library(readxl)</span></span>
<span id="cb2-3"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">terms &lt;- read_excel(here::here("az 900 Skills.xlsx"))</span></span>
<span id="cb2-4"></span>
<span id="cb2-5"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">for(i in 1:nrow(terms)) {</span></span>
<span id="cb2-6"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  term &lt;- terms$Term[i]</span></span>
<span id="cb2-7"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  definition &lt;- terms$Definition[i]</span></span>
<span id="cb2-8"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span></span>
<span id="cb2-9"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  cat(paste("</span></span>
<span id="cb2-10"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    &lt;section class=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">center</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">&gt;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span></span>
<span id="cb2-11"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    &lt;div class=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">r-stack</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">&gt;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span></span>
<span id="cb2-12"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    &lt;div class=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fragment fade-out</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> data-fragment-index=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">&gt;&lt;b&gt;",</span></span>
<span id="cb2-13"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    term,</span></span>
<span id="cb2-14"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    "&lt;/b&gt;&lt;br&gt; </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> &lt;br&gt; </span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> &lt;br&gt;</span></span>
<span id="cb2-15"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    &lt;/div&gt;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">"))</span></span>
<span id="cb2-16"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  </span></span>
<span id="cb2-17"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">  cat(paste(</span></span>
<span id="cb2-18"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    "&lt;div class=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fragment fade-in</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;"> data-fragment-index=</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\"</span><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">&gt;",</span></span>
<span id="cb2-19"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    definition,</span></span>
<span id="cb2-20"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    "&lt;/div&gt;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span></span>
<span id="cb2-21"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    &lt;/div&gt;</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">\n</span></span>
<span id="cb2-22"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">    &lt;/section&gt;"))</span></span>
<span id="cb2-23"><span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">}</span></span>
<span id="cb2-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">```</span></span></code></pre></div>
<p>There are opportunities to color the slides based on the subject area, add additional information in the notes, or filter the terms.</p>



 ]]></description>
  <category>R</category>
  <category>Azure</category>
  <guid>https://www.williamtylerbradley.com/posts/2021-12-20-az-900-exam-flashcards/</guid>
  <pubDate>Mon, 20 Dec 2021 05:00:00 GMT</pubDate>
  <media:content url="https://www.williamtylerbradley.com/posts/2021-12-20-az-900-exam-flashcards/test_1_960x700.png" medium="image" type="image/png" height="105" width="144"/>
</item>
<item>
  <title>Deep Blue versus Garry Kasparov</title>
  <link>https://www.williamtylerbradley.com/posts/2021-12-09-deep-blue-versus-gary-kasparov/</link>
  <description><![CDATA[ 





<p>I recently finished a small generative art project on <a href="https://en.wikipedia.org/wiki/Deep_Blue_versus_Garry_Kasparov">Deep Blue versus Garry Kasparov</a>. The main goals were creating a new visualization of the chess games and playing around with colors. In the end, I think it turned out ok, but it still needs more work. (For example, it doesn’t handle pawn promotion well.)</p>
<p>The idea came out of watching <a href="https://en.wikipedia.org/wiki/The_Queen%27s_Gambit_(miniseries)"><em>The Queen’s Gambit</em></a> last year. There’s a terrific scene where the main character says, “Chess isn’t always competitive … chess can also be beautiful.” I thought that was interesting because the series happened in 1950’s/1960’s before computers were winning chess. So today, the most competitive setup involves computers, but that still leaves room for the beautiful part from humans. There’s a neat comparison between chess and generative art. This project uses moves from Deep Blue for the generative aspect, connecting to when computers started taking over competitively. Also, I think using chess data for generative art is neat for a found materials project.</p>
<p>Each of the games has a grid layout. Horizontally, the pieces lay across the columns. Vertically, the games’ actions move down the grid, with pieces dropping out when captured. Horizontal lines connect the pieces when captured. The square’s color tells the location on the board. Rank follows luminance (white is lighter, black is darker) while files move along hue/chroma in the HCL color space. As pieces move on the board, their color changes from one row to the next.</p>
<p>The code uses the <a href="http://jkunst.com/rchess/"><code>rchess</code> package</a> with game files from <a href="https://www.chessgames.com">chessgames.com</a>. <code>data.table</code> handles the data manipulation and image setup. The code can be found <a href="https://github.com/WilliamTylerBradley/DeepBlueVersusGarryKasparov">here</a>.</p>
<p>Here is the piece order. This also shows the first row in each grid (notices the notches separating the types). The order starts in the middle of the king and queen, works outward, moves to the pawns, works inwards, then reverses to the other side. The two kings end up on the outside edges. The winning side’s king will drop down into the final row. If there is no winner, the kings end on the same row.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-12-09-deep-blue-versus-gary-kasparov/piece_order.png" class="img-fluid figure-img"></p>
<figcaption>Piece Order</figcaption>
</figure>
</div>
<p>A different grid of colors exists for each board of the 14 games (seven for 1996 and seven for 1997). The colors sets are eight by eight grids that maximize the distance between points in the HCL color space as they move around the hue values.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-12-09-deep-blue-versus-gary-kasparov/colors_1.jpeg" class="img-fluid figure-img"></p>
<figcaption>Color Grids</figcaption>
</figure>
</div>
<p>The following graph shows all the colors with their hue/chroma values. I found moving chroma out as hue moves give some distinction between the sides of the board without creating too much of a striping effect. There are different luminance values for each grid to maximize the space they can take.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-12-09-deep-blue-versus-gary-kasparov/colors_2.jpeg" class="img-fluid figure-img"></p>
<figcaption>Colors’ Hue and Chroma Values</figcaption>
</figure>
</div>
<p>Finally, here are the two works. The background colors are from the middle of the grid then rotated around the space.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-12-09-deep-blue-versus-gary-kasparov/DeepBlueVersusGarryKasparov1996.png" class="img-fluid figure-img"></p>
<figcaption>1996 Games</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-12-09-deep-blue-versus-gary-kasparov/DeepBlueVersusGarryKasparov1997.png" class="img-fluid figure-img"></p>
<figcaption>1997 Games</figcaption>
</figure>
</div>
<p>We can see how the number of turns affects the length of the grids, how some pieces (some pawns) get taken more often than others, and how there’s a lot of exchanges in pieces.</p>



 ]]></description>
  <category>R</category>
  <category>Generative Art</category>
  <guid>https://www.williamtylerbradley.com/posts/2021-12-09-deep-blue-versus-gary-kasparov/</guid>
  <pubDate>Thu, 09 Dec 2021 05:00:00 GMT</pubDate>
  <media:content url="https://www.williamtylerbradley.com/posts/2021-12-09-deep-blue-versus-gary-kasparov/DeepBlueVersusGarryKasparov1996.png" medium="image" type="image/png" height="103" width="144"/>
</item>
<item>
  <title>Power BI and Missing Values</title>
  <link>https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/</link>
  <description><![CDATA[ 





<p>This presentation covers how to handle missing values in Power BI. The focus is on missing months, but other features will fit the setups mentioned here. You can check out the project on Github <a href="https://github.com/WilliamTylerBradley/powerbi_missing_values_pres">here</a> or go <a href="https://williamtylerbradley.github.io/powerbi_missing_values_pres/presentation.html">here</a> and press ‘s’ to get speaker notes.</p>
<div id="slide_1" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_1_960x700.png" class="img-fluid"></p>
</div>
<p>This presentation comes from a project I worked on involving these issues with missing values in Power BI. For this presentation, I’m assuming you have some familiarity with Power BI. So, I won’t walk through all the basics like pulling in data but start after the beginning steps.</p>
</div>
<div id="slide_2" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_2_960x700.png" class="img-fluid"></p>
</div>
<p>For today’s setup, we’ll cover a background example that explains the issues, go through some basic strategies that might solve your problem, a better strategy that’s more work but a lot more robust, and then some additional options for polishing the dashboard.</p>
</div>
<div id="slide_3" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_3_960x700.png" class="img-fluid"></p>
</div>
<p>We’ll start with an orders table called orders_small. Each row is an order that contains the order number, the product that was sold, a customer id, the date, and the dollar amount. The goal here is to get information on sales over time for each product. So we basically need to sum the dollar amount by date.</p>
</div>
<div id="slide_4" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_4_960x700.png" class="img-fluid"></p>
</div>
<p>Showing the data by day will be too granular, so we want to get it into months. We can add in some DAX code to create a new column for the month of each order. We’ll also just use the date as a date hierarchy and compare the methods.</p>
</div>
<div id="slide_5" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_5_960x700.png" class="img-fluid"></p>
</div>
<p>This graph uses the month column we just created. You can see there are some missing values at the start and end of the dark blue line. However, the orange line is suspiciously straight.</p>
</div>
<div id="slide_6" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_6_960x700.png" class="img-fluid"></p>
</div>
<p>This graph uses the date column from the data at the month level. You still see the missing values for the dark blue line, but now the orange line has missing values. This is because the other graph was just connecting the segments across January to November.</p>
</div>
<div id="slide_7" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_7_960x700.png" class="img-fluid"></p>
</div>
<p>Looking closely at the graph, we see that these three products sell at different times of the year. Product A sells year-round. Product B is only in the summer, while product C is only in the winter.</p>
</div>
<div id="slide_8" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_8_960x700.png" class="img-fluid"></p>
</div>
<p>What we really want to see are all the lines filled in down to zero. The poorly drawn lines display what we want to get at the end.</p>
</div>
<div id="slide_9" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_9_960x700.png" class="img-fluid"></p>
</div>
<p>We can also see that this can mess up any calculations. In this example, the monthly_average is wrong because distinct_months is incorrect for selling over an entire year.</p>
</div>
<div id="slide_10" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_10_960x700.png" class="img-fluid"></p>
</div>
<p>For this presentation, we’ll focus on creating an end product that has the following features. Line graphs and tables by product over time. Graphs and tables for dollar amounts, number of distinct customers, and number of orders. The ability to filter by product and month. And finally, fill in zeros when the product was available.</p>
</div>
<div id="slide_11" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_11_960x700.png" class="img-fluid"></p>
</div>
<p>The following section will cover some basic strategies to fill in zeros for missing values. These techniques will handle a lot of problems and are pretty easy to implement.</p>
</div>
<div id="slide_12" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_12_960x700.png" class="img-fluid"></p>
</div>
<p>If you click on the down arrow on your axis, there will be an option for ‘Show items with no data’. This is always the first option I try. Unfortunately, it only works in some situations and doesn’t work in this example.</p>
</div>
<div id="slide_13" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_13_960x700.png" class="img-fluid"></p>
</div>
<p>We can just fix the math if you know it’s a constant. All we need to do is add 0 to the end of our measure, and it will fill in for us. But, unfortunately, this only fixes the graph and not the table.</p>
</div>
<div id="slide_14" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_14_960x700.png" class="img-fluid"></p>
</div>
<p>We can fix the table by skipping the DISTINCTCOUNT on months and replace it all with 12. This will get the correct monthly_average. However, this only works when we know it’s always 12. Also, it doesn’t fix the graph.</p>
</div>
<div id="slide_15" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_15_960x700.png" class="img-fluid"></p>
</div>
<p>Finally, we can always just fix the issues in the data. For example, we can clean up data by importing monthly data from the start and importing rows with zeros. There are ways to do that in SQL and Power Query. We won’t go into them in this presentation, but it’s a great option if you know you’ll never need more granular data.</p>
</div>
<div id="slide_16" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_16_960x700.png" class="img-fluid"></p>
</div>
<p>These strategies tend to work very easily. None of them took a lot of effort to implement from where we started. However, they tend to not be extendable. We have to mix and match these strategies to get everything, and that’s annoying. They can fall apart for more advanced calculations and become messy when trying to keep it all together. In my experience, if you just need basic graphs and tables, these are great. However, a more thorough setup can be better if you know you’ll need more advanced calculations and interactivity.</p>
</div>
<div id="slide_17" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_17_960x700.png" class="img-fluid"></p>
</div>
<p>This next section goes through that more thorough setup. We’ll reset everything and build a stronger start that enables us to get any calculations we need.</p>
</div>
<div id="slide_18" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_18_960x700.png" class="img-fluid"></p>
</div>
<p>There’s still a year of data but a lot more products. There are other trends, including decreasing or increasing over time, and even products that only sold for one month (those are the points). We’ll call this orders_big.</p>
</div>
<div id="slide_19" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_19_960x700.png" class="img-fluid"></p>
</div>
<p>This is just a reminder of what we’re looking to create by the end. Line graphs and tables by product over time. Graphs and tables for dollar amounts, number of distinct customers, and number of orders. The ability to filter by product and month. And finally, fill in zeros when the product was available.</p>
</div>
<div id="slide_20" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_20_960x700.png" class="img-fluid"></p>
</div>
<p>There are three parts to this section. The first part is setting up a calendar table to use as a date dimension.</p>
</div>
<div id="slide_21" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_21_960x700.png" class="img-fluid"></p>
</div>
<p>A calendar table is a table created in Power BI that contains all the dates you need and associated information. We’ll use the Calendar Dax function. This function requires a start and end date. It’ll then fill out all the dates in between (including the start and end dates). We’ll go through three examples.</p>
</div>
<div id="slide_22" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_22_960x700.png" class="img-fluid"></p>
</div>
<p>We have three different ways to create a date table using the CALENDAR function. The first way provides specific dates. This is useful if you need the graph to keep the same date range even if your data changes. The second way uses the TODAY function to get the current date. This will keep your dashboard current no matter what happens with your data. The last way pulls the start and end dates from the data. This will keep your graphs matching the data even if it doesn’t refresh. I tend to use either of the last two depending on the business need.</p>
<p>There are other options like CALENDARAUTO or setting a date table, but we’ll stick with CALENDAR for this presentation. It’s definitely worth your time to spend an afternoon looking into the other options if you’re going to implement this at your work.</p>
</div>
<div id="slide_23" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_23_960x700.png" class="img-fluid"></p>
</div>
<p>Since we’ll want to group by month, we’ll add in a month column. We’ll also change the format to match our data. You typically always want it to match as this can speed up calculations.</p>
</div>
<div id="slide_24" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_24_960x700.png" class="img-fluid"></p>
</div>
<p>Then the last step here is connecting the date table to our data.</p>
</div>
<div id="slide_25" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_25_960x700.png" class="img-fluid"></p>
</div>
<p>The next step for a great setup is using a star schema.</p>
</div>
<div id="slide_26" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_26_960x700.png" class="img-fluid"></p>
</div>
<p>The star schema will work by placing the main orders_big table in the middle. Then have essential dimensions on the outside, like our date table. Often you’ll see this has a ‘suggestion’ from Microsoft, but it’s almost always a good idea from the beginning.</p>
</div>
<div id="slide_27" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_27_960x700.png" class="img-fluid"></p>
</div>
<p>Let’s add in two other dimension tables, product, and customer. We’ll just summarize the columns from the orders_big table. If they were in other tables in a database, you could bring them in separately. We can sort of see the star shape. It’s just missing the two legs at the bottom. This setup will make our data easy to use with functions.</p>
</div>
<div id="slide_28" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_28_960x700.png" class="img-fluid"></p>
</div>
<p>That brings us to our last step with using the ADDMISSINGITEMS function. This will complete our setup.</p>
</div>
<div id="slide_29" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_29_960x700.png" class="img-fluid"></p>
</div>
<p>This function is defined as ‘Adds rows with empty values to a table returned by SUMMARIZECOLUMNS.’ from the Microsoft documentation or ‘Add the rows with empty measure values back.’ from the Dax guide. I don’t find either of those definitions intuitive, but working through the parameters, output, and examples will help explain what it does.</p>
</div>
<div id="slide_30" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_30_960x700.png" class="img-fluid"></p>
</div>
<p>There are four parameters. ShowAll_ColumnName is what you want to fill in. The Table parameter will be output from SUMMARIZECOLUMNS with the missing data. It’ll be based on orders_big for us. The GroupBy_ColumnName is also what you want to fill in unless you’re using ROLLUP. We won’t be using ROLLUP in any of the examples, so it’ll always match ShowAll_ColumnName. Finally, you can add filter tables to remove filled-in values you don’t actually want to add.</p>
</div>
<div id="slide_31" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_31_960x700.png" class="img-fluid"></p>
</div>
<p>For our setup, we’ll want to fill in any missing combinations of month and product. We can pull these from our dimensions in the star schema. The Table parameter is the sum of the dollar_amount by month and product. Ideally, we’ll see all combinations of month and product with the dollar_amount summed if there were sales that month.</p>
</div>
<div id="slide_32" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_32_960x700.png" class="img-fluid"></p>
</div>
<p>Putting it all into the ADDMISSINGITEMS function, you can see ShowAll_ColumnName cal_month and product, the table is the SUMMARIZECOLUMNS, the GroupBy_ColumnName is the same as the ShowAll_ColumnName, no filters for now. This is basically a full join between calendar months and products, then a left join to our summarized data. Finally, we can see some of the missing months in the image.</p>
</div>
<div id="slide_33" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_33_960x700.png" class="img-fluid"></p>
</div>
<p>I like to add in the amount filled, but you can replace the amount if you want.</p>
</div>
<div id="slide_34" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_34_960x700.png" class="img-fluid"></p>
</div>
<p>And now we finally have the graph we wanted.</p>
</div>
<div id="slide_35" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_35_960x700.png" class="img-fluid"></p>
</div>
<p>If you have a lot of data, you might get a warning about not seeing all the data in the top corner. There’s an option that samples the data to increase speed. You can turn that off to see more lines. There’s not a strict cutoff on data size. It just depends on what you’re graphing.</p>
</div>
<div id="slide_36" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_36_960x700.png" class="img-fluid"></p>
</div>
<p>Now we can compare the summary stats. We can see all the months are filled in, so the average monthly amount is now correct.</p>
</div>
<div id="slide_37" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_37_960x700.png" class="img-fluid"></p>
</div>
<p>Now that we have the main setup, we can move to the last big section on polishing up the dashboard.</p>
</div>
<div id="slide_38" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_38_960x700.png" class="img-fluid"></p>
</div>
<p>The first part is filtering the data to exclude months where the product wasn’t available for sale. We should end up with filled-in months only when the product was an option.</p>
</div>
<div id="slide_39" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_39_960x700.png" class="img-fluid"></p>
</div>
<p>Let’s say different products were available for different months. We’ll have this in a table called product_dates. This would be saved in a database then pulled into Power BI.</p>
</div>
<div id="slide_40" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_40_960x700.png" class="img-fluid"></p>
</div>
<p>We can join this to our products table. In the product_dates table, there are multiple rows per product for cases when there are jumps in the dates. So, for example, products available during the summer could have a row for January to March 2020 and a row for November to December 2020. Therefore you can’t just join to orders_big table because that would be a many-to-many join.</p>
</div>
<div id="slide_41" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_41_960x700.png" class="img-fluid"></p>
</div>
<p>We’re going to build a table with months filled down by using CROSSJOIN on our date table and product_dates. Then filter down to the combinations we want. (There are other ways to do this, especially when bringing the data into Power BI)</p>
</div>
<div id="slide_42" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_42_960x700.png" class="img-fluid"></p>
</div>
<p>Then we just join to our other tables.</p>
</div>
<div id="slide_43" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_43_960x700.png" class="img-fluid"></p>
</div>
<p>To use this table as a filter, we just need to add it to the end of our ADDMISSINGITEMS call. This will filter out combinations that weren’t in our product_availability table.</p>
</div>
<div id="slide_44" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_44_960x700.png" class="img-fluid"></p>
</div>
<p>Same as previous orders_zeros_added table, but with product_availability used as a filter.</p>
</div>
<div id="slide_45" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_45_960x700.png" class="img-fluid"></p>
</div>
<p>Now we can see gaps in the data where there are months without product availability. However, it’s still not quite right. Notice the orange line across the middle.</p>
</div>
<div id="slide_46" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_46_960x700.png" class="img-fluid"></p>
</div>
<p>To fix the issue of joining over missing dates, the X-axis needs to be set to Categorical. And now, everything is good.</p>
</div>
<div id="slide_47" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_47_960x700.png" class="img-fluid"></p>
</div>
<p>Checking the summary tables shows everything is working here too.</p>
</div>
<div id="slide_48" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_48_960x700.png" class="img-fluid"></p>
</div>
<p>Let’s say you either don’t want the X-axis to be categorical, or you want all the months missing for no product availability. We’ll go back before we filter on availability and reset a little bit.</p>
</div>
<div id="slide_49" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_49_960x700.png" class="img-fluid"></p>
</div>
<p>We’ll create a new star schema around our orders_big table. We can’t reuse the same tables, or we’ll get a circular dependency error. So, we’ll add in product and date dimensions and recreate the table to check product availability. We can reduce our date table to just months since we have already summarized the data.</p>
</div>
<div id="slide_50" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_50_960x700.png" class="img-fluid"></p>
</div>
<p>On this slide, we can see the two star schemas.</p>
</div>
<div id="slide_51" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_51_960x700.png" class="img-fluid"></p>
</div>
<p>To incorporate the product availability check, we’ll create a measure using LOOKUPVALUE to see if the month-product combination existed. Then build another measure to fill in zeros or keep the missing value.</p>
</div>
<div id="slide_53" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_53_960x700.png" class="img-fluid"></p>
</div>
<p>We have our continuous axis graph. Note that you need to use cal_table_month for the axis.</p>
</div>
<div id="slide_53" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_53_960x700.png" class="img-fluid"></p>
</div>
<p>Our summary tables are still good.</p>
</div>
<div id="slide_54" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_54_960x700.png" class="img-fluid"></p>
</div>
<p>One big catch for mixing missing and zeros in Power BI is that BLANK is not like SQL NULL. BLANK will convert to 0 in summations and substractions but will stay BLANK in division and multiplication. For example, if you had this equation and B is BLANK, the left side will equal 1 because A divided by B is BLANK, then 1 minus BLANK is 1. However, the right side is BLANK because B minus A is negative A, then negative A divided by B is BLANK. Even though these should match. So, depending on how you set up your measures, you can get different results. You’ll need to watch this in calculations.</p>
</div>
<div id="slide_55" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_55_960x700.png" class="img-fluid"></p>
</div>
<p>In addition to the amount, we wanted measures for customers and orders.</p>
</div>
<div id="slide_56" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_56_960x700.png" class="img-fluid"></p>
</div>
<p>All we need to add is DISTINCTCOUNT of customer_id and carry through, exactly like using amount.</p>
</div>
<div id="slide_57" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_57_960x700.png" class="img-fluid"></p>
</div>
<p>We can see the appropriate graph.</p>
</div>
<div id="slide_58" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_58_960x700.png" class="img-fluid"></p>
</div>
<p>And the appropriate tables.</p>
</div>
<div id="slide_59" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_59_960x700.png" class="img-fluid"></p>
</div>
<p>Adding in the number of orders is also exactly the same.</p>
</div>
<div id="slide_60" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_60_960x700.png" class="img-fluid"></p>
</div>
<p>Similar graphs.</p>
</div>
<div id="slide_61" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_61_960x700.png" class="img-fluid"></p>
</div>
<p>Similar tables.</p>
</div>
<div id="slide_62" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_62_960x700.png" class="img-fluid"></p>
</div>
<p>In some cases, you’ll need to use DISTINCTCOUNT after filling in the missing months. Like if you need more advanced filtering or calculations. For example, distinct customers over a year will only equal the sum of distinct customers every month if there are no repeated customers. To solve this problem, you can bring customer_id in the SUMMARIZECOLUMNS in ADDMISSINGITEMS but not place it in the ShowAll_ColumnName parameter. This will bring the individual customer_id’s through but not fill in missing months for them. You’ll end up with month-product rows that have missing values for customer_id and order_id.</p>
</div>
<div id="slide_63" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_63_960x700.png" class="img-fluid"></p>
</div>
<p>Finally, the last step is to add filters for product and month.</p>
</div>
<div id="slide_64" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_64_960x700.png" class="img-fluid"></p>
</div>
<p>You can use built-in filters for the table either in the filter panel or slicers. You can also build out a star schema again if you want. That’s pretty much it. All the usual Power BI features work from here.</p>
</div>
<div id="slide_65" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_65_960x700.png" class="img-fluid"></p>
</div>
<p>And that’s the presentation. Thanks!</p>
</div>



 ]]></description>
  <category>Power BI</category>
  <category>Presentations</category>
  <guid>https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/</guid>
  <pubDate>Tue, 19 Oct 2021 04:00:00 GMT</pubDate>
  <media:content url="https://www.williamtylerbradley.com/posts/2021-10-19-power-bi-and-missing-values/screenshots_1_960x700.png" medium="image" type="image/png" height="105" width="144"/>
</item>
<item>
  <title>Penrose Tiling</title>
  <link>https://www.williamtylerbradley.com/posts/2021-10-25-penrsose-tiling/</link>
  <description><![CDATA[ 





<hr>
<center>
<h2 class="anchored">
R package
</h2>
</center>
<hr>
<p>I recently worked on a generative art project around <a href="https://en.wikipedia.org/wiki/Penrose_tiling">Penrose tiling</a> patterns. As I worked through the functions, I decided to throw them into a package, <code>penrosetiling</code>. You can find it <a href="https://williamtylerbradley.github.io/penrosetiling/">here</a>. This package has base data sets and functions to substitute the pattern down through the shapes. There are also vignettes to help get started, use <code>purrr</code> for looping, and clean up images. Hopefully, it will work for you.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-25-penrsose-tiling/penrosetiling.png" height="175" class="figure-img"></p>
<figcaption>penrosetiling hex sticker</figcaption>
</figure>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
Outputs
</h2>
</center>
<hr>
<p>The outputs from the project are displayed below. The code can be found <a href="https://github.com/WilliamTylerBradley/penrosetiling_art">here</a>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-25-penrsose-tiling/variations1.png" class="img-fluid figure-img"></p>
<figcaption>Variations 1</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-25-penrsose-tiling/variations2.png" class="img-fluid figure-img"></p>
<figcaption>Variations 2</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-25-penrsose-tiling/cathedral.jpeg" class="img-fluid figure-img"></p>
<figcaption>Cathedral</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-25-penrsose-tiling/warnings.png" class="img-fluid figure-img"></p>
<figcaption>Warnings</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-25-penrsose-tiling/vacay.jpeg" class="img-fluid figure-img"></p>
<figcaption>Vacay</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-10-25-penrsose-tiling/sbwn.gif" class="img-fluid figure-img"></p>
<figcaption>SBWN (Standard Black and White Noise)</figcaption>
</figure>
</div>



 ]]></description>
  <category>R</category>
  <category>Generative Art</category>
  <guid>https://www.williamtylerbradley.com/posts/2021-10-25-penrsose-tiling/</guid>
  <pubDate>Tue, 19 Oct 2021 04:00:00 GMT</pubDate>
  <media:content url="https://www.williamtylerbradley.com/posts/2021-10-25-penrsose-tiling/penrosetiling.png" medium="image" type="image/png" height="144" width="144"/>
</item>
<item>
  <title>Bertrand Paradox</title>
  <link>https://www.williamtylerbradley.com/posts/2021-08-12-bertrand-paradox/</link>
  <description><![CDATA[ 





<p>This project is based on the <a href="https://en.wikipedia.org/wiki/Bertrand_paradox_(probability)">Bertrand Paradox</a>. The Bertrand Paradox deals with patterns that develop from sampling points/chords in a circle. The paradox occurs when different sampling methods seem like they should have the same output but don’t. The first method for this project samples two points on the perimeter then connects them to get the line and the midpoint to get the point. The second method samples a radius at a random angle around the circle, then a random distance on that radius for the midpoint. The line at a right angle is the chord. The last method samples a random point at uniform in the circle for the midpoint. Then the line at a right angle to the segment from that point to the center is the chord. Each of these produces a different distribution of lines and points.</p>
<p>The code can be found <a href="https://github.com/WilliamTylerBradley/bertrand_paradox">here</a>. We’ll walk through a subset of it in this post. For each method, we generate some features at random, then get lines and points from them.</p>
<br>
<hr>
<center>
<h2 class="anchored">
Randomization Methods
</h2>
</center>
<hr>
<p>For these methods, we’ll build a function called <code>line_points</code> that takes in the center and radius of the circle along with the features we randomly generated for each method. The function outputs the two endpoints for the chord and the midpoint. After creating <code>line_points</code>, we’ll generate the random features then run them through <code>pmap_dfr</code> from the <code>purrr</code> package to apply the <code>line_points</code> function.</p>
<p>For the following code snippets, <code>circle_h</code>, <code>circle_k</code>, and <code>circle_radius</code> are the circle’s center x coordinate, center y coordinates, and radius.</p>
<p>For method 1, we generate the two points on the perimeter as uniform distances from <code>0</code> to <code>2 * pi</code>. Then we take each of those and convert them to coordinates based on the circle’s center and radius. Finally, get the midpoint and return.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">### Transformation</span></span>
<span id="cb1-2"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Parameters</span></span>
<span id="cb1-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># circle_x is x value of center</span></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># circle_y is y value of center</span></span>
<span id="cb1-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># circle_radius is radius</span></span>
<span id="cb1-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># point_1 is one point from 0 to 2*pi</span></span>
<span id="cb1-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># point_2 is one point from 0 to 2*pi</span></span>
<span id="cb1-8"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Returns</span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dataframe with</span></span>
<span id="cb1-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># point_1_x, point_1_y, point_2_x, point_2_y, midpoint_x, midpoint_y</span></span>
<span id="cb1-11">line_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(circle_x, circle_y, circle_radius, point_1, point_2) {</span>
<span id="cb1-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get x,y values</span></span>
<span id="cb1-13">  point_1_x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> circle_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> circle_r <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(point_1)</span>
<span id="cb1-14">  point_1_y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> circle_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> circle_r <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(point_1)</span>
<span id="cb1-15">  point_2_x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> circle_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> circle_r <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(point_2)</span>
<span id="cb1-16">  point_2_y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> circle_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> circle_r <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(point_2)</span>
<span id="cb1-17">  </span>
<span id="cb1-18">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Get midpoints</span></span>
<span id="cb1-19">  midpoint_x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> (point_1_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> point_2_x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb1-20">  midpoint_y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> (point_1_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> point_2_y) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb1-21">  </span>
<span id="cb1-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_1_x =</span> point_1_x,</span>
<span id="cb1-23">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_1_y =</span> point_1_y,</span>
<span id="cb1-24">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_2_x =</span> point_2_x, </span>
<span id="cb1-25">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_2_y =</span> point_2_y,</span>
<span id="cb1-26">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">midpoint_x =</span> midpoint_x,</span>
<span id="cb1-27">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">midpoint_y =</span> midpoint_y))</span>
<span id="cb1-28">}</span>
<span id="cb1-29"></span>
<span id="cb1-30"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##-------------</span></span>
<span id="cb1-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Dataset setup</span></span>
<span id="cb1-32"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##-------------</span></span>
<span id="cb1-33">lines <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">line =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, n_lines),</span>
<span id="cb1-34">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_1 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(n_lines, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi),</span>
<span id="cb1-35">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_2 =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(n_lines, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi))</span>
<span id="cb1-36"></span>
<span id="cb1-37">lines <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> lines <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_cols</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pmap_dfr</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">circle_x =</span> circle_h,</span>
<span id="cb1-39">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">circle_y =</span> circle_k,</span>
<span id="cb1-40">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">circle_radius =</span> circle_r, </span>
<span id="cb1-41">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_1 =</span> .<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point_1,</span>
<span id="cb1-42">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_2 =</span> .<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point_2), line_points))</span></code></pre></div>
</div>
<p>For method 2, our <code>line_points</code> function needs a radius (random uniform from <code>0</code> to <code>2 * pi</code>) and the proportionate distance from the center to the perimeter (random uniform from <code>0</code> to <code>1</code>). The <code>line_points</code> function takes those values, converts the proportion to the actual distance, finds the ends of a chord crossing that point if the angle was 0, rotates everything to the appropriate angle, then moves to the circle’s location.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">### Transformation</span></span>
<span id="cb2-2"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Parameters</span></span>
<span id="cb2-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># circle_x is x value of center</span></span>
<span id="cb2-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># circle_y is y value of center</span></span>
<span id="cb2-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># circle_radius is radius</span></span>
<span id="cb2-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># radius is radian</span></span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># chord is fraction along the radius </span></span>
<span id="cb2-8"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Returns</span></span>
<span id="cb2-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dataframe with</span></span>
<span id="cb2-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># point_1_x, point_1_y, point_2_x, point_2_y, midpoint_x, midpoint_y</span></span>
<span id="cb2-11">line_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(circle_x, circle_y, circle_radius, radius, chord) {</span>
<span id="cb2-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># move out to radius from origin</span></span>
<span id="cb2-13">  x_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> circle_radius <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(radius)</span>
<span id="cb2-14">  y_1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> circle_radius <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(radius)</span>
<span id="cb2-15">  x_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> circle_radius <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(radius)</span>
<span id="cb2-16">  y_2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> circle_radius <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(radius)</span>
<span id="cb2-17">  </span>
<span id="cb2-18">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># https://www.mathsisfun.com/algebra/trig-solving-ssa-triangles.html</span></span>
<span id="cb2-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># we know one angle is 90*</span></span>
<span id="cb2-20">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># one side is circle_radius</span></span>
<span id="cb2-21">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># one side is chord</span></span>
<span id="cb2-22">  new_angle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> pi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">asin</span>(((chord <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> circle_radius) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> </span>
<span id="cb2-23">                                  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> circle_radius)</span>
<span id="cb2-24">  </span>
<span id="cb2-25">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># now rotate these points around to the radius</span></span>
<span id="cb2-26">  x_1_moved <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(new_angle) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(new_angle) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y_1</span>
<span id="cb2-27">  y_1_moved <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(new_angle) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x_1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(new_angle) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y_1</span>
<span id="cb2-28">  x_2_moved <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>new_angle) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>new_angle) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y_2</span>
<span id="cb2-29">  y_2_moved <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>new_angle) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x_2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>new_angle) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y_2</span>
<span id="cb2-30">  </span>
<span id="cb2-31">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># move back to where the circle is</span></span>
<span id="cb2-32">  x_1_moved <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> x_1_moved <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> circle_x</span>
<span id="cb2-33">  y_1_moved <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> y_1_moved <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> circle_y</span>
<span id="cb2-34">  x_2_moved <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> x_2_moved <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> circle_x</span>
<span id="cb2-35">  y_2_moved <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> y_2_moved <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> circle_y</span>
<span id="cb2-36">  </span>
<span id="cb2-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_1_x =</span> x_1_moved,</span>
<span id="cb2-38">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_1_y =</span> y_1_moved,</span>
<span id="cb2-39">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_2_x =</span> x_2_moved, </span>
<span id="cb2-40">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_2_y =</span> y_2_moved,</span>
<span id="cb2-41">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">midpoint_x =</span> (x_1_moved <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x_2_moved) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb2-42">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">midpoint_y =</span> (y_1_moved <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y_2_moved) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb2-43">}</span>
<span id="cb2-44"></span>
<span id="cb2-45"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##-------------</span></span>
<span id="cb2-46"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Dataset setup</span></span>
<span id="cb2-47"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##-------------</span></span>
<span id="cb2-48">lines <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">line =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, n_lines),</span>
<span id="cb2-49">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">radius =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(n_lines, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>pi),</span>
<span id="cb2-50">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">chord =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(n_lines, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>))</span>
<span id="cb2-51">lines <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> lines <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_cols</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pmap_dfr</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">circle_x =</span> circle_h,</span>
<span id="cb2-53">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">circle_y =</span> circle_k,</span>
<span id="cb2-54">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">circle_radius =</span> circle_r, </span>
<span id="cb2-55">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">radius =</span> .<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>radius,</span>
<span id="cb2-56">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">chord =</span> .<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>chord), line_points))</span></code></pre></div>
</div>
<p>For method 3, <code>line_points</code> now needs a point’s x and y coordinates in the unit circle. We then find the chord by rotating the point to angle 0 then finding the vertical line through that point. The chord’s endpoints are where the vertical line crosses the circle. We then rotate those points back, so their midpoint matches the original point.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">### Transformation</span></span>
<span id="cb3-2"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Parameters</span></span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># circle_x is x value of center</span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># circle_y is y value of center</span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># circle_radius is radius</span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># point_x is the x value of the random point</span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># point_y is the y value of the random point</span></span>
<span id="cb3-8"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Returns</span></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># dataframe with</span></span>
<span id="cb3-10"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># point_1_x, point_1_y, point_2_x, point_2_y, midpoint_x, midpoint_y</span></span>
<span id="cb3-11">line_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(circle_x, circle_y, circle_radius, point_x, point_y) {</span>
<span id="cb3-12">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># move out to radius from origin</span></span>
<span id="cb3-13">  point_x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> circle_radius <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> point_x</span>
<span id="cb3-14">  point_y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> circle_radius <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> point_y</span>
<span id="cb3-15">  </span>
<span id="cb3-16">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rotate so just dealing with y</span></span>
<span id="cb3-17">  flatten_by <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">atan2</span>(point_y, point_x)</span>
<span id="cb3-18">  </span>
<span id="cb3-19">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># now rotate these points around to the radius</span></span>
<span id="cb3-20">  x_rotated <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>flatten_by) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> point_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>flatten_by) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> point_y</span>
<span id="cb3-21">  y_rotated <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>flatten_by) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> point_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>flatten_by) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> point_y <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Should be zero</span></span>
<span id="cb3-22">  </span>
<span id="cb3-23">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># find y values </span></span>
<span id="cb3-24">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># x^2 + y^2 = r^2</span></span>
<span id="cb3-25">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># y^2 = r^2 - x^2</span></span>
<span id="cb3-26">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># y = +/- sqrt(r^2 - x^2)</span></span>
<span id="cb3-27">  y1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(circle_radius<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x_rotated<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb3-28">  y2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(circle_radius<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> x_rotated<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)</span>
<span id="cb3-29">  </span>
<span id="cb3-30">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rotate back</span></span>
<span id="cb3-31">  point_1_x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(flatten_by) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x_rotated <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(flatten_by) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y1</span>
<span id="cb3-32">  point_1_y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(flatten_by) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x_rotated <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(flatten_by) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y1</span>
<span id="cb3-33">  point_2_x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(flatten_by) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x_rotated <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(flatten_by) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y2</span>
<span id="cb3-34">  point_2_y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(flatten_by) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> x_rotated <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(flatten_by) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> y2</span>
<span id="cb3-35"></span>
<span id="cb3-36">  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># move back to where the circle is</span></span>
<span id="cb3-37">  point_1_x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> point_1_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> circle_x</span>
<span id="cb3-38">  point_1_y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> point_1_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> circle_y</span>
<span id="cb3-39">  point_2_x <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> point_2_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> circle_x</span>
<span id="cb3-40">  point_2_y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span> point_2_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> circle_y</span>
<span id="cb3-41">  </span>
<span id="cb3-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">return</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_1_x =</span> point_1_x,</span>
<span id="cb3-43">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_1_y =</span> point_1_y,</span>
<span id="cb3-44">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_2_x =</span> point_2_x, </span>
<span id="cb3-45">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_2_y =</span> point_2_y,</span>
<span id="cb3-46">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">midpoint_x =</span> (point_1_x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> point_2_x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb3-47">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">midpoint_y =</span> (point_1_y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> point_2_y) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>))</span>
<span id="cb3-48">}</span>
<span id="cb3-49"></span>
<span id="cb3-50"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##-------------</span></span>
<span id="cb3-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Dataset setup</span></span>
<span id="cb3-52"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##-------------</span></span>
<span id="cb3-53">lines <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">line =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, n_lines),</span>
<span id="cb3-54">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">r =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(n_lines, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)),</span>
<span id="cb3-55">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theta =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(n_lines, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>pi))</span>
<span id="cb3-56">lines <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> lines <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_x =</span> r <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(theta),</span>
<span id="cb3-58">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_y =</span> r <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(theta)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(line, point_x, point_y)</span>
<span id="cb3-60">lines <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> lines <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-61">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">bind_cols</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">pmap_dfr</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">list</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">circle_x =</span> circle_h,</span>
<span id="cb3-62">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">circle_y =</span> circle_k,</span>
<span id="cb3-63">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">circle_radius =</span> circle_r, </span>
<span id="cb3-64">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_x =</span> .<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point_x,</span>
<span id="cb3-65">                          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">point_y =</span> .<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>point_y), line_points))</span></code></pre></div>
</div>
<p>Now that we have the basic attributes for the three methods, we can talk about coloring them.</p>
<br>
<hr>
<center>
<h2 class="anchored">
Color Selection
</h2>
</center>
<hr>
<p>For the methods, I wanted each one to be colored based on different hues. So, I selected them from a yellow-orange/blue-green/purple-red triad. The colors are sampled from ellipses in the HCL color space. The following images show samples from the same ellipses. The line colors are on top and points on the bottom.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-12-bertrand-paradox/1_2_info.jpeg" class="img-fluid figure-img"></p>
<figcaption>Method 1: Colors</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-12-bertrand-paradox/3_4_info.jpeg" class="img-fluid figure-img"></p>
<figcaption>Method 2: Colors</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-12-bertrand-paradox/5_6_info.jpeg" class="img-fluid figure-img"></p>
<figcaption>Method 3: Colors</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>In addition to the lines having a lower base Luminance value, the lines’ ellipses are tilted down towards the center while the points’ slope upwards on the Chroma-Luminance plane for their respective Hue values.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-12-bertrand-paradox/1_c_l.jpeg" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-12-bertrand-paradox/3_c_l.jpeg" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-12-bertrand-paradox/5_c_l.jpeg" class="img-fluid"></p>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-12-bertrand-paradox/2_c_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Method 1: Chroma-Luminance Plane</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-12-bertrand-paradox/4_c_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Method 2: Chroma-Luminance Plane</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-12-bertrand-paradox/6_c_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Method 3: Chroma-Luminance Plane</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Each of the lines is closer to the secondary colors in Hue than the points. For the order, the revolve around the color wheel counter-clockwise. We can see this when looking at the Hue-Chroma plane at their respective Luminance values.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-12-bertrand-paradox/1_h_c.jpeg" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-12-bertrand-paradox/3_h_c.jpeg" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: center;">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-12-bertrand-paradox/5_h_c.jpeg" class="img-fluid"></p>
</div>
</div>
</div>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="3">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-12-bertrand-paradox/2_h_c.jpeg" class="img-fluid figure-img"></p>
<figcaption>Method 1: Hue-Chroma Plane</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-12-bertrand-paradox/4_h_c.jpeg" class="img-fluid figure-img"></p>
<figcaption>Method 2: Hue-Chroma Plane</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-12-bertrand-paradox/6_h_c.jpeg" class="img-fluid figure-img"></p>
<figcaption>Method 3: Hue-Chroma Plane</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>I tried picking the colors by algorithm, but I couldn’t get that to work as well as I wanted. I often ended up with too much brown or blue. So, the base colors are hand-picked.</p>
<br>
<hr>
<center>
<h2 class="anchored">
Final Output
</h2>
</center>
<hr>
<p>Now that we can generate the lines/point and colors let’s stick it together. We’ll add diagrams towards the bottom of the images to explain the methods along with borders. The <a href="https://github.com/WilliamTylerBradley/bertrand_paradox">Github repo</a> contains the complete code if you want to see it. The diagrams are affected by the random seed, so any example lines/points can be chosen. I used <code>grid</code> for this instead of <code>ggplot2</code> because I wanted the points and lines to overlap back and forth. That was easier to do with <code>grid</code>. Later I changed and put all the points on top of all the lines, but by then, I had it all done in <code>grid</code>. I also found this setup easier to control where to place everything on the page instead of worrying about margins or other artifacts getting in the way.</p>
<p>From here to the end are the final products. Better 18” x 24” jpeg files can be found <a href="https://github.com/WilliamTylerBradley/bertrand_paradox">here</a>.</p>
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-12-bertrand-paradox/method_1_small.jpeg" class="img-fluid" alt="Method 1"> <br> <br> <img src="https://www.williamtylerbradley.com/posts/2021-08-12-bertrand-paradox/method_2_small.jpeg" class="img-fluid" alt="Method 2"> <br> <br> <img src="https://www.williamtylerbradley.com/posts/2021-08-12-bertrand-paradox/method_3_small.jpeg" class="img-fluid" alt="Method 3"></p>



 ]]></description>
  <category>R</category>
  <category>Generative Art</category>
  <guid>https://www.williamtylerbradley.com/posts/2021-08-12-bertrand-paradox/</guid>
  <pubDate>Thu, 12 Aug 2021 04:00:00 GMT</pubDate>
  <media:content url="https://www.williamtylerbradley.com/posts/2021-08-12-bertrand-paradox/thumbnail.jpeg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Choosing Nearby Colors Part 2</title>
  <link>https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/</link>
  <description><![CDATA[ 





<p>This blog post follows up on the previous one. Code in that post finds colors in the HCL color space by sampling points from a sphere centered on a base point. There’s a mismatch between how the sphere is determined (Cartesian coordinates of x, y, L) and the colors are parameterized (polar coordinates of H, C, L), so a conversion happens in the code.</p>
<p>This post looks into what happens if you just start with a “sphere” based on Hue, Chroma, Luminance values. So we’ll set up shapes that expand out from the base point along Hue, Chroma, and Luminance directly.<sup>1</sup></p>
<br>
<hr>
<center>
<h2 class="anchored">
Base Point Location
</h2>
</center>
<hr>
<div class="cell">
<details class="code-fold">
<summary>[A Lot of Setup Code]</summary>
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##---------</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Libraries</span></span>
<span id="cb1-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##---------</span></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(patchwork)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(colorspace)</span>
<span id="cb1-7"></span>
<span id="cb1-8"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##------------</span></span>
<span id="cb1-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pick a color</span></span>
<span id="cb1-10"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##------------</span></span>
<span id="cb1-11">H_point <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">322</span></span>
<span id="cb1-12">C_point <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">26</span></span>
<span id="cb1-13">L_point <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">69</span></span>
<span id="cb1-14"></span>
<span id="cb1-15">color_hex <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(H_point, </span>
<span id="cb1-16">                 C_point, </span>
<span id="cb1-17">                 L_point,</span>
<span id="cb1-18">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixup =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb1-19"></span>
<span id="cb1-20"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##--------------------------------</span></span>
<span id="cb1-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># See color in H, C, L color space </span></span>
<span id="cb1-22"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##--------------------------------</span></span>
<span id="cb1-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># C-L Plane ----</span></span>
<span id="cb1-24">get_C_L_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(H_point) {</span>
<span id="cb1-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H =</span> H_point,</span>
<span id="cb1-26">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),</span>
<span id="cb1-27">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-28">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(H, C, L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixup =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-29">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(color_value))</span>
<span id="cb1-30">}</span>
<span id="cb1-31">C_L_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_C_L_plane</span>(H_point)</span>
<span id="cb1-32"></span>
<span id="cb1-33">graph_C_L_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(C_L_plane, color_hex) {</span>
<span id="cb1-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-35">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> C_L_plane,</span>
<span id="cb1-36">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(C, L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color_value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-37">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> abs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-38">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-39">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-40">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> C_point,</span>
<span id="cb1-41">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> L_point),</span>
<span id="cb1-42">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>,</span>
<span id="cb1-43">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_hex,</span>
<span id="cb1-44">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,</span>
<span id="cb1-45">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-46">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb1-47">}</span>
<span id="cb1-48"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_L_plane</span>(C_L_plane, color_hex)</span>
<span id="cb1-49"></span>
<span id="cb1-50"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># H-L Curve ----</span></span>
<span id="cb1-51">get_H_L_curve <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(C_point) {</span>
<span id="cb1-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb1-53">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C =</span> C_point,</span>
<span id="cb1-54">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-55">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(H, C, L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixup =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-56">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(color_value))</span>
<span id="cb1-57">}</span>
<span id="cb1-58">H_L_curve <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_H_L_curve</span>(C_point)</span>
<span id="cb1-59"></span>
<span id="cb1-60">label_H_center <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(H_point, ...) {</span>
<span id="cb1-61">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>}</span>
<span id="cb1-62">}</span>
<span id="cb1-63"></span>
<span id="cb1-64">graph_H_L_curve <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(H_L_curve, color_hex, H_point) {</span>
<span id="cb1-65">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-66">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> H_L_curve,</span>
<span id="cb1-67">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>((H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, L, </span>
<span id="cb1-68">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color_value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-69">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-70">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-71">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Because we rotated points to not drop over edge</span></span>
<span id="cb1-72">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> L_point),</span>
<span id="cb1-73">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>,</span>
<span id="cb1-74">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_hex,</span>
<span id="cb1-75">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,</span>
<span id="cb1-76">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-77">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_reverse</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'H'</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Like you're standing on the inside</span></span>
<span id="cb1-78">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_H_center</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H_point =</span> H_point),</span>
<span id="cb1-79">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-80">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb1-81">}</span>
<span id="cb1-82"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_L_curve</span>(H_L_curve, color_hex, H_point)</span>
<span id="cb1-83"></span>
<span id="cb1-84"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># H-C plane ----</span></span>
<span id="cb1-85">get_H_C_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(L_point){</span>
<span id="cb1-86">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb1-87">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),</span>
<span id="cb1-88">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L =</span> L_point) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-89">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(H, C, L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixup =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-90">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(color_value))</span>
<span id="cb1-91">}</span>
<span id="cb1-92">H_C_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_H_C_plane</span>(L_point)</span>
<span id="cb1-93"></span>
<span id="cb1-94">graph_H_C_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(H_C_plane, color_hex) {</span>
<span id="cb1-95">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-96">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> H_C_plane,</span>
<span id="cb1-97">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(H, C, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color_value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-98">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-99">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-100">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>),</span>
<span id="cb1-101">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">minor_breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">315</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb1-102">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'45'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'90'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'135'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'180'</span>, </span>
<span id="cb1-103">                                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'225'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'270'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'315'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'0|360'</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-104">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-105">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> H_point,</span>
<span id="cb1-106">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> C_point),</span>
<span id="cb1-107">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>,</span>
<span id="cb1-108">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_hex,</span>
<span id="cb1-109">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,</span>
<span id="cb1-110">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-111">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_polar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">270</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>,</span>
<span id="cb1-112">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-113">}</span>
<span id="cb1-114"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_C_plane</span>(H_C_plane, color_hex)</span>
<span id="cb1-115"></span>
<span id="cb1-116"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># C tangent plane ----</span></span>
<span id="cb1-117">C_circle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>),</span>
<span id="cb1-118">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C =</span> C_point,</span>
<span id="cb1-119">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)</span>
<span id="cb1-120">C_tangent_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> C_point, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plane perpendicular to H at C</span></span>
<span id="cb1-121">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perpendicular_from_C_L =</span> </span>
<span id="cb1-122">                                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> C_point<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> C_point<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)),</span>
<span id="cb1-123">                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-124">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x_rotate =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rotate</span></span>
<span id="cb1-125">           perpendicular_from_C_L <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>),</span>
<span id="cb1-126">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y_rotate =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-127">           perpendicular_from_C_L <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-128">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x_rotate,</span>
<span id="cb1-129">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y_rotate) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-130">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x_rotate, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>y_rotate)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-131">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H =</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">atan2</span>(y, x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>pi) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>,</span>
<span id="cb1-132">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-133">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)</span>
<span id="cb1-134"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> H_C_plane,</span>
<span id="cb1-135">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(H, C, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color_value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-136">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-137">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-138">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-139">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>),</span>
<span id="cb1-140">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">minor_breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">315</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb1-141">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'45'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'90'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'135'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'180'</span>, </span>
<span id="cb1-142">                                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'225'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'270'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'315'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'0|360'</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-143">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-144">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_path</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> C_circle) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-145">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> H_point,</span>
<span id="cb1-146">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb1-147">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> H_point,</span>
<span id="cb1-148">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> C_point,</span>
<span id="cb1-149">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-150">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> C_tangent_plane, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-151">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> H_point,</span>
<span id="cb1-152">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> C_point,</span>
<span id="cb1-153">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>,</span>
<span id="cb1-154">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_hex,</span>
<span id="cb1-155">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-156">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_polar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">270</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>,</span>
<span id="cb1-157">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb1-158"></span>
<span id="cb1-159">get_C_tangent_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(H_point, C_point) {</span>
<span id="cb1-160">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> C_point, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plane perpendicular to H at C</span></span>
<span id="cb1-161">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perpendicular_from_C_L =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),</span>
<span id="cb1-162">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-163">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x_rotate =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rotate</span></span>
<span id="cb1-164">             perpendicular_from_C_L <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>),</span>
<span id="cb1-165">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y_rotate =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb1-166">             perpendicular_from_C_L <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-167">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x_rotate,</span>
<span id="cb1-168">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y_rotate) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-169">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x_rotate, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>y_rotate)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-170">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H =</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">atan2</span>(y, x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>pi) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>,</span>
<span id="cb1-171">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-172">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(H, C, L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixup =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb1-173">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(color_value))</span>
<span id="cb1-174">}</span>
<span id="cb1-175">C_tangent_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_C_tangent_plane</span>(H_point, C_point)</span>
<span id="cb1-176"></span>
<span id="cb1-177">graph_C_tangent_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(C_tangent_plane, color_hex) {</span>
<span id="cb1-178">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-179">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> C_tangent_plane,</span>
<span id="cb1-180">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(perpendicular_from_C_L, L, </span>
<span id="cb1-181">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color_value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-182">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-183">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-184">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_reverse</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance Perpendicular to C-L Plane"</span>,</span>
<span id="cb1-185">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> abs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-186">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb1-187">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> L_point),</span>
<span id="cb1-188">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>,</span>
<span id="cb1-189">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_hex,</span>
<span id="cb1-190">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,</span>
<span id="cb1-191">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb1-192">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb1-193">}</span>
<span id="cb1-194"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_tangent_plane</span>(C_tangent_plane, color_hex)</span></code></pre></div>
</details>
</div>
<p>Let’s first look at all our graphs for our base color. This time I’m picking pink. Next, we can see the C-L Plane, H-C Plane, and H-L Curve images to understand the color in the HCL color space.</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; justify-items: center; grid-column-gap: 1px;">
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/c_l_plane.jpeg" class="img-fluid figure-img"></p>
<figcaption>Base Color: C-L Plane</figcaption>
</figure>
</div>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/h_c_plane.jpeg" class="img-fluid figure-img"></p>
<figcaption>Base Color: H-C Plane</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/h_l_curve.jpeg" class="img-fluid figure-img"></p>
<figcaption>Base Color: H-L Curve</figcaption>
</figure>
</div>
<p>Then we can look at the plane tangent to the H-L Curve to see the space perpendicular to the C-L plane.</p>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; justify-items: center; grid-column-gap: 1px;">
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/c_tangent_plane_setup.jpeg" class="img-fluid figure-img"></p>
<figcaption>C Tangent Plane setup</figcaption>
</figure>
</div>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/c_tangent_plane.jpeg" class="img-fluid figure-img"></p>
<figcaption>Base Color: Plane Perpendicular to C-L Plane</figcaption>
</figure>
</div>
</div>
</div>
<p>After the base color is understood, we can see what happens if you extend out to a sphere.</p>
<br>
<hr>
<center>
<h2 class="anchored">
xyL Perimeter
</h2>
</center>
<hr>
<p>We’ll only pull points on the perimeter for this code, unlike the previous post that had points randomly throughout the sphere. We’ll move away from the base point using the Cartesian coordinates of x, y, and L for the first main section. This is exactly what we did in the last post, so it should look familiar. The main new addition is cutting the shape into pieces and graphing them on facets.</p>
<div class="cell">
<details class="code-fold">
<summary>[xyL Perimeter Code]</summary>
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##------------------</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># x, y, L perimeter</span></span>
<span id="cb2-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##------------------</span></span>
<span id="cb2-4">width <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">15</span></span>
<span id="cb2-5">n_color <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb2-6"></span>
<span id="cb2-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># http://extremelearning.com.au/how-to-evenly-distribute-points-on-a-sphere-more-effectively-than-the-canonical-fibonacci-lattice/#more-3069</span></span>
<span id="cb2-8">get_xyl_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(H_point, C_point, L_point, width, n_color) {</span>
<span id="cb2-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theta =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, n_color <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> ((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb2-10">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">phi =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">acos</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, n_color <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n_color)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(theta) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(phi),</span>
<span id="cb2-12">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(theta) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(phi),</span>
<span id="cb2-13">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(phi)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>),</span>
<span id="cb2-15">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>),</span>
<span id="cb2-16">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L =</span> L <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> L_point) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-17">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H =</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">atan2</span>(y, x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>pi) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>,</span>
<span id="cb2-18">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(L <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> L <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> C <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">h =</span> H,</span>
<span id="cb2-21">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">c =</span> C,</span>
<span id="cb2-22">                             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">l =</span> L)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-23">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> C <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>),</span>
<span id="cb2-24">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> C <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-25">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perpendicular_from_C_L =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb2-26">             y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>),</span>
<span id="cb2-27">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">parallel_along_C_L =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> </span>
<span id="cb2-28">             y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-29">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>(), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()),</span>
<span id="cb2-30">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ceiling</span>(row_value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n_color))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-31">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_value =</span> (row_value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n_color)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-32">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(</span>
<span id="cb2-33">      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span>(L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(L_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb2-34">                                  L_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width, </span>
<span id="cb2-35">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), </span>
<span id="cb2-36">                        <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>),</span>
<span id="cb2-37">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(L_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb2-38">                     <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(L_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb2-39">                         L_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb2-40">                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), </span>
<span id="cb2-41">                     L_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width))),</span>
<span id="cb2-42">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(</span>
<span id="cb2-43">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span>(C,</span>
<span id="cb2-44">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>, </span>
<span id="cb2-45">                       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb2-46">                           C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width, </span>
<span id="cb2-47">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), </span>
<span id="cb2-48">                       <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>),</span>
<span id="cb2-49">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb2-50">                       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb2-51">                           C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb2-52">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), </span>
<span id="cb2-53">                       C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width))),</span>
<span id="cb2-54">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(</span>
<span id="cb2-55">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span>((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> </span>
<span id="cb2-56">              <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> </span>
<span id="cb2-57">              <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point),</span>
<span id="cb2-58">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>, </span>
<span id="cb2-59">                       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb2-60">                           <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width, </span>
<span id="cb2-61">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), </span>
<span id="cb2-62">                       <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>),</span>
<span id="cb2-63">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb2-64">                       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb2-65">                           H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb2-66">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), </span>
<span id="cb2-67">                       H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>)),</span>
<span id="cb2-68">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perpendicular_from_C_L_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(</span>
<span id="cb2-69">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span>(perpendicular_from_C_L,</span>
<span id="cb2-70">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb2-71">                                 <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width, </span>
<span id="cb2-72">                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), </span>
<span id="cb2-73">                       <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>),</span>
<span id="cb2-74">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb2-75">                       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb2-76">                           <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb2-77">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), </span>
<span id="cb2-78">                       <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width))),</span>
<span id="cb2-79">      <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">parallel_along_C_L_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(</span>
<span id="cb2-80">        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span>(parallel_along_C_L,</span>
<span id="cb2-81">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>, </span>
<span id="cb2-82">                       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb2-83">                           C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width, </span>
<span id="cb2-84">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), </span>
<span id="cb2-85">                       <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>),</span>
<span id="cb2-86">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb2-87">                       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb2-88">                           C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb2-89">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), </span>
<span id="cb2-90">                       C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width)))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-91">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(L_cut)),</span>
<span id="cb2-92">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(C_cut)),</span>
<span id="cb2-93">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(H_cut)),</span>
<span id="cb2-94">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perpendicular_from_C_L_cut =</span> </span>
<span id="cb2-95">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(perpendicular_from_C_L_cut)),</span>
<span id="cb2-96">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">parallel_along_C_L_cut =</span> </span>
<span id="cb2-97">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(parallel_along_C_L_cut))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-98">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_expand</span>(H_cut, </span>
<span id="cb2-99">                              <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb2-100">                                             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb2-101">                                                 H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb2-102">                                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), </span>
<span id="cb2-103">                                             H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>)),</span>
<span id="cb2-104">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perpendicular_from_C_L_cut =</span> </span>
<span id="cb2-105">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_expand</span>(perpendicular_from_C_L_cut,</span>
<span id="cb2-106">                        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb2-107">                                       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb2-108">                                           <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb2-109">                                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), </span>
<span id="cb2-110">                                       <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width)))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-111">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_relevel</span>(H_cut, </span>
<span id="cb2-112">                               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb2-113">                                              <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb2-114">                                                  H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb2-115">                                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), </span>
<span id="cb2-116">                                              H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>)),</span>
<span id="cb2-117">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perpendicular_from_C_L_cut =</span> </span>
<span id="cb2-118">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_relevel</span>(perpendicular_from_C_L_cut,</span>
<span id="cb2-119">                         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb2-120">                                        <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb2-121">                                            <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb2-122">                                            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), </span>
<span id="cb2-123">                                        <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width)))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-124">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_rev</span>(H_cut),</span>
<span id="cb2-125">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perpendicular_from_C_L_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_rev</span>(perpendicular_from_C_L_cut))</span>
<span id="cb2-126">}</span>
<span id="cb2-127"></span>
<span id="cb2-128">xyl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_xyl_data</span>(H_point, C_point, L_point, width, n_color)</span>
<span id="cb2-129"></span>
<span id="cb2-130">graph_info <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(H_point, C_point, L_point) {</span>
<span id="cb2-131">  color_hex <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(H_point, </span>
<span id="cb2-132">                   C_point,</span>
<span id="cb2-133">                   L_point,</span>
<span id="cb2-134">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixup =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb2-135">  </span>
<span id="cb2-136">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-137">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_rect</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb2-138">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> color_hex, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_hex) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-139">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb2-140">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>),</span>
<span id="cb2-141">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HEX Value:"</span>, color_hex), </span>
<span id="cb2-142">                                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"H Value:"</span>, H_point),</span>
<span id="cb2-143">                                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C Value:"</span>, C_point),</span>
<span id="cb2-144">                                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L Value:"</span>, L_point))),</span>
<span id="cb2-145">              <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-146">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-147">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>()</span>
<span id="cb2-148">}</span>
<span id="cb2-149"></span>
<span id="cb2-150">graph_sample <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(color_points) {</span>
<span id="cb2-151">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points,</span>
<span id="cb2-152">         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> row_value,</span>
<span id="cb2-153">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> col_value,</span>
<span id="cb2-154">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-155">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_tile</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-156">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-157">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-158">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>()</span>
<span id="cb2-159">}</span>
<span id="cb2-160"></span>
<span id="cb2-161">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_info</span>(H_point, C_point, L_point)</span>
<span id="cb2-162">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_sample</span>(xyl)</span>
<span id="cb2-163">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span>
<span id="cb2-164"></span>
<span id="cb2-165"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># C L plane by H</span></span>
<span id="cb2-166">graph_C_L_by_H <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(color_points) {</span>
<span id="cb2-167">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(C, L, </span>
<span id="cb2-168">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> color_value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-169">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-170">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-171">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-172">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> H_cut, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-173">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() </span>
<span id="cb2-174">}</span>
<span id="cb2-175"></span>
<span id="cb2-176">get_C_L_plane_by_H <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(color_points, H_point, width) {</span>
<span id="cb2-177">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_dfr</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(color_points<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>H_cut))), </span>
<span id="cb2-178">          get_C_L_plane) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-179">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(H)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-180">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_expand</span>(H_cut, </span>
<span id="cb2-181">                              <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb2-182">                                             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb2-183">                                                 H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb2-184">                                                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), </span>
<span id="cb2-185">                                             H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-186">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_relevel</span>(H_cut, </span>
<span id="cb2-187">                               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb2-188">                                              <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb2-189">                                                  H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb2-190">                                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), </span>
<span id="cb2-191">                                              H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-192">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_rev</span>(H_cut))</span>
<span id="cb2-193">}</span>
<span id="cb2-194">C_L_plane_by_H <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_C_L_plane_by_H</span>(xyl, H_point, width)</span>
<span id="cb2-195"></span>
<span id="cb2-196">graph_C_L_plane_by_H <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(C_L_plane, color_points) {</span>
<span id="cb2-197">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-198">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> C_L_plane,</span>
<span id="cb2-199">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(C, L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color_value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-200">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points,</span>
<span id="cb2-201">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(C, L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-202">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> abs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-203">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-204">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-205">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> H_cut, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-206">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb2-207">}</span>
<span id="cb2-208"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_L_plane_by_H</span>(C_L_plane_by_H, xyl)</span>
<span id="cb2-209"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_L_by_H</span>(xyl)</span>
<span id="cb2-210"></span>
<span id="cb2-211"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># H L curve</span></span>
<span id="cb2-212">graph_H_L_by_C <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(color_points, H_point) {</span>
<span id="cb2-213">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>((H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, L, </span>
<span id="cb2-214">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color_value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-215">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-216">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-217">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-218">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_reverse</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'H'</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Like you're standing on the inside</span></span>
<span id="cb2-219">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_H_center</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H_point =</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-220">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> C_cut, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-221">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb2-222">}</span>
<span id="cb2-223"></span>
<span id="cb2-224">get_H_L_curve_by_C <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(color_points) {</span>
<span id="cb2-225">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_dfr</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(</span>
<span id="cb2-226">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(color_points<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>C_cut))), get_H_L_curve) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-227">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(C))</span>
<span id="cb2-228">}</span>
<span id="cb2-229">H_L_curve_by_C <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_H_L_curve_by_C</span>(xyl)</span>
<span id="cb2-230"></span>
<span id="cb2-231">graph_H_L_curve_by_C <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(H_L_curve_by_C, color_points, H_point) {</span>
<span id="cb2-232">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-233">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> H_L_curve_by_C,</span>
<span id="cb2-234">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>((H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, L, </span>
<span id="cb2-235">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color_value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-236">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points,</span>
<span id="cb2-237">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>((H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, L, </span>
<span id="cb2-238">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-239">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-240">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-241">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_reverse</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'H'</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Like you're standing on the inside</span></span>
<span id="cb2-242">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_H_center</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H_point =</span> H_point),</span>
<span id="cb2-243">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-244">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> C_cut, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-245">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb2-246">}</span>
<span id="cb2-247"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_L_curve_by_C</span>(H_L_curve_by_C, xyl, H_point)</span>
<span id="cb2-248"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_L_by_C</span>(xyl, H_point)</span>
<span id="cb2-249"></span>
<span id="cb2-250"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># H C plane by L</span></span>
<span id="cb2-251">graph_x_y_by_L <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(color_points, H_point) {</span>
<span id="cb2-252">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y, </span>
<span id="cb2-253">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> color_value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-254">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slope =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tan</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">67.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>), </span>
<span id="cb2-255">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tan</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>), </span>
<span id="cb2-256">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tan</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">22.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>),</span>
<span id="cb2-257">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100000</span>,</span>
<span id="cb2-258">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tan</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">22.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>), </span>
<span id="cb2-259">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tan</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>), </span>
<span id="cb2-260">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tan</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">67.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)), </span>
<span id="cb2-261">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb2-262">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-263">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slope =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tan</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>), </span>
<span id="cb2-264">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb2-265">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-266">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-267">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-268">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-269">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> L_cut, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-270">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-271">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb2-272">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb2-273">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb2-274">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())</span>
<span id="cb2-275">}</span>
<span id="cb2-276"></span>
<span id="cb2-277">get_H_C_plane_by_L <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(color_points) {</span>
<span id="cb2-278">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">map_dfr</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(</span>
<span id="cb2-279">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">unique</span>(color_points<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>L_cut))), get_H_C_plane) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb2-280">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(L))</span>
<span id="cb2-281">}</span>
<span id="cb2-282">H_C_plane_by_L <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_H_C_plane_by_L</span>(xyl)</span>
<span id="cb2-283"></span>
<span id="cb2-284">graph_H_C_plane_by_L <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(H_C_plane_by_L, color_points) {</span>
<span id="cb2-285">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-286">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> H_C_plane_by_L,</span>
<span id="cb2-287">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(H, C, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color_value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-288">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points,</span>
<span id="cb2-289">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(H , C, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-290">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-291">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-292">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>),</span>
<span id="cb2-293">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">minor_breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">315</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb2-294">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'45'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'90'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'135'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'180'</span>, </span>
<span id="cb2-295">                                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'225'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'270'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'315'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'0|360'</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-296">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-297">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> L_cut, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-298">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_polar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">270</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>,</span>
<span id="cb2-299">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb2-300">}</span>
<span id="cb2-301"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_C_plane_by_L</span>(H_C_plane_by_L, xyl)</span>
<span id="cb2-302"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_x_y_by_L</span>(xyl, H_point)</span>
<span id="cb2-303"></span>
<span id="cb2-304"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># C tangent plane</span></span>
<span id="cb2-305">label_perpendicular_from_C_L_cut<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {</span>
<span id="cb2-306">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(x)))</span>
<span id="cb2-307">}</span>
<span id="cb2-308"></span>
<span id="cb2-309">graph_parallel_perpendicular_by_L <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(color_points) {</span>
<span id="cb2-310">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points, </span>
<span id="cb2-311">         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> parallel_along_C_L,</span>
<span id="cb2-312">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> perpendicular_from_C_L,</span>
<span id="cb2-313">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-314">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-315">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-316">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance Perpendicular to C-L Plane"</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># similar to H</span></span>
<span id="cb2-317">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> abs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-318">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance Parallel to C-L Plane"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># similar to C</span></span>
<span id="cb2-319">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> L_cut, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-320">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb2-321">}</span>
<span id="cb2-322"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_parallel_perpendicular_by_L</span>(xyl)</span>
<span id="cb2-323"></span>
<span id="cb2-324">graph_perpendicular_L_by_parallel <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(color_points) {</span>
<span id="cb2-325">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points, </span>
<span id="cb2-326">         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> perpendicular_from_C_L,</span>
<span id="cb2-327">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> L,</span>
<span id="cb2-328">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-329">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-330">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-331">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance Perpendicular to C-L Plane"</span>,</span>
<span id="cb2-332">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> abs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-333">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> abs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-334">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> parallel_along_C_L_cut, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-335">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb2-336">}</span>
<span id="cb2-337"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_perpendicular_L_by_parallel</span>(xyl)</span>
<span id="cb2-338"></span>
<span id="cb2-339">graph_parallel_L_by_perpendicular <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(color_points) {</span>
<span id="cb2-340">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points, </span>
<span id="cb2-341">         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> parallel_along_C_L,</span>
<span id="cb2-342">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> L,</span>
<span id="cb2-343">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-344">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-345">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-346">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance Parallel to C-L Plane"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-347">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> perpendicular_from_C_L_cut, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb2-348">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labeller =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_labeller</span>(label_perpendicular_from_C_L_cut)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb2-349">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb2-350">}</span>
<span id="cb2-351"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_parallel_L_by_perpendicular</span>(xyl)</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/xyl_info.jpeg" class="img-fluid figure-img"></p>
<figcaption>xyL: Info</figcaption>
</figure>
</div>
<p>Above, we see the basic information about the base color and the points sampled around the sphere’s perimeter (width is 15 units). Below, we see the sphere cut up by C-L Planes at different Hue values. We see that as we move across different values for our Hue, we slice through the sphere to get different shapes. For example, on the right image, the ends are moved left slightly, and the doughnuts in the middle values tend to have a little more width on the right side. The distortion occurs because our cuts are fanning across the sphere at an angle, not moving along in a straight line. So, one side gets a little more of the perimeter to plot.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/xyl_c_l_plane.jpeg" class="img-fluid figure-img"></p>
<figcaption>xyL: C-L Plane by H cuts</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/xyl_c_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>xyL: C-L by H cuts</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>The next set shows the H-L Curve by different Chroma values. Here, we might expect to see circles, but instead, we get ovals. These shapes occur because the ring made by moving Hue through the sphere cuts along a curve, then it’s flattened for these facets. Also, technically the facets are a little off because the width of the graph should be increasing as Chroma increases. So even though they show the same Hue values, the arc length of the circle should be getting longer. Therefore the graphs should be getting wider.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/xyl_h_l_curve.jpeg" class="img-fluid figure-img"></p>
<figcaption>xyL: H-L Curve by C cuts</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/xyl_h_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>xyL: H-L by C cuts</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>In the next set, we finally get our nice circles. As we slice through our sphere for different Luminance values, we get our circles in the H-C Planes.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/xyl_h_c_plane.jpeg" class="img-fluid figure-img"></p>
<figcaption>xyL: H-C Plane by L cuts</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/xyl_h_c.jpeg" class="img-fluid figure-img"></p>
<figcaption>xyL: H-C by L cuts</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>The following three images also have circles because we’re cutting our sphere along straight lines equal distances from each other. The first facet set looks at the sphere from up above as we cut through different Luminance values. This image is the same as the right side in the previous group, but each sub-image gets rotated, so the Hue angle moves flat left to right. The x-axis is the distance along the C-L Plane that cuts the sphere in half. This distance isn’t equivalent to Chroma because that moves at an angle determined by Hue, but it is related. The values are the Chroma values on the C-L Plane shifted in a straight line from the C-L Plane. The y-axis is the distance from the C-L Plane in either direction.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/xyl_par_per.jpeg" class="img-fluid figure-img"></p>
<figcaption>xyL: Parallel-Perpendicular Distances by L cuts</figcaption>
</figure>
</div>
<p>The next two images both have the Luminance values along the y-axis but cut the sphere differently. The left side slices the sphere moving out from the center of the HCL color space along the Chroma values. Here we see the nice circles instead of ovals for the images of the H-L cut by C. The right side cuts are made parallel to the C-L Plane and move along a straight line. We’re also getting circles that aren’t a little lop-sided, unlike the C-L cut by H ones.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/xyl_per_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>xyL: Perpendicular Distance-L by Parallel Distance cuts</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/xyl_par_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>xyL: Parallel Distance-L by Perpendicular Distance cuts</figcaption>
</figure>
</div>
</div>
</div>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
HCL Perimeter
</h2>
</center>
<hr>
<p>We’ll move away from the base color along Hue, Chroma, and Luminance for the second main section. So we’ll curve around when changing Hue values.</p>
<div class="cell">
<details class="code-fold">
<summary>[HCL Perimeter Code]</summary>
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##------------------</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># H, C, L, perimeter</span></span>
<span id="cb3-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##------------------</span></span>
<span id="cb3-4">get_hcl_data <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(H_point, C_point, L_point, width, n_color) {</span>
<span id="cb3-5"> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theta =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, n_color <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> ((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb3-6">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">phi =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">acos</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, n_color <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> n_color)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(theta) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(phi),</span>
<span id="cb3-8">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(theta) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(phi),</span>
<span id="cb3-9">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(phi)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-10">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H =</span> H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> H_point,</span>
<span id="cb3-11">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C =</span> C <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> C_point,</span>
<span id="cb3-12">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L =</span> L <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> L_point) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H =</span> H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># not really needed except for graphs</span></span>
<span id="cb3-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(L <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> L <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> C <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">h =</span> H,</span>
<span id="cb3-16">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">c =</span> C,</span>
<span id="cb3-17">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">l =</span> L)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> C <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>),</span>
<span id="cb3-19">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> C <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perpendicular_from_C_L =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb3-21">           y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># not a C value since we didn't rotate by H</span></span>
<span id="cb3-22">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">parallel_along_C_L =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> </span>
<span id="cb3-23">           y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>(), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()),</span>
<span id="cb3-25">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ceiling</span>(row_value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n_color))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_value =</span> (row_value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n_color)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(</span>
<span id="cb3-28">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span>(L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(L_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb3-29">                                L_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width, </span>
<span id="cb3-30">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), </span>
<span id="cb3-31">                      <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>),</span>
<span id="cb3-32">        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(L_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb3-33">                   <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(L_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb3-34">                       L_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb3-35">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), </span>
<span id="cb3-36">                   L_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width))),</span>
<span id="cb3-37">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(</span>
<span id="cb3-38">           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span>(C,</span>
<span id="cb3-39">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>, </span>
<span id="cb3-40">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb3-41">                              C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width, </span>
<span id="cb3-42">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), </span>
<span id="cb3-43">                          <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>),</span>
<span id="cb3-44">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb3-45">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb3-46">                              C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb3-47">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), </span>
<span id="cb3-48">                          C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width))),</span>
<span id="cb3-49">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(</span>
<span id="cb3-50">           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span>((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> </span>
<span id="cb3-51">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> </span>
<span id="cb3-52">                 <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point),</span>
<span id="cb3-53">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>, </span>
<span id="cb3-54">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb3-55">                              <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width, </span>
<span id="cb3-56">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), </span>
<span id="cb3-57">                          <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>),</span>
<span id="cb3-58">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb3-59">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb3-60">                              H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb3-61">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), </span>
<span id="cb3-62">                          H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>)),</span>
<span id="cb3-63">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perpendicular_from_C_L_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(</span>
<span id="cb3-64">           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span>(perpendicular_from_C_L,</span>
<span id="cb3-65">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb3-66">                                    <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width, </span>
<span id="cb3-67">                                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), </span>
<span id="cb3-68">                          <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>),</span>
<span id="cb3-69">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb3-70">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb3-71">                              <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb3-72">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), </span>
<span id="cb3-73">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width))),</span>
<span id="cb3-74">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">parallel_along_C_L_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(</span>
<span id="cb3-75">           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cut</span>(parallel_along_C_L,</span>
<span id="cb3-76">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>, </span>
<span id="cb3-77">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb3-78">                              C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width, </span>
<span id="cb3-79">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>), </span>
<span id="cb3-80">                          <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">Inf</span>),</span>
<span id="cb3-81">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb3-82">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb3-83">                              C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb3-84">                              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), </span>
<span id="cb3-85">                          C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width)))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-86">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(L_cut)),</span>
<span id="cb3-87">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(C_cut)),</span>
<span id="cb3-88">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(H_cut)),</span>
<span id="cb3-89">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perpendicular_from_C_L_cut =</span> </span>
<span id="cb3-90">           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(perpendicular_from_C_L_cut)),</span>
<span id="cb3-91">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">parallel_along_C_L_cut =</span> </span>
<span id="cb3-92">           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.factor</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.numeric</span>(parallel_along_C_L_cut))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-93">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_expand</span>(H_cut, </span>
<span id="cb3-94">                            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb3-95">                                           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb3-96">                                               H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb3-97">                                               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), </span>
<span id="cb3-98">                                           H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>)),</span>
<span id="cb3-99">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perpendicular_from_C_L_cut =</span> </span>
<span id="cb3-100">           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_expand</span>(perpendicular_from_C_L_cut,</span>
<span id="cb3-101">                      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb3-102">                                     <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb3-103">                                         <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb3-104">                                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), </span>
<span id="cb3-105">                                     <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width)))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-106">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_relevel</span>(H_cut, </span>
<span id="cb3-107">                             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb3-108">                                            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb3-109">                                                H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb3-110">                                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), </span>
<span id="cb3-111">                                            H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>)),</span>
<span id="cb3-112">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perpendicular_from_C_L_cut =</span> </span>
<span id="cb3-113">           <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_relevel</span>(perpendicular_from_C_L_cut,</span>
<span id="cb3-114">                      <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as.character</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> width, </span>
<span id="cb3-115">                                     <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb3-116">                                         <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (width <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">8</span>), </span>
<span id="cb3-117">                                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">length.out =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">6</span>), </span>
<span id="cb3-118">                                     <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> width)))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-119">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_rev</span>(H_cut),</span>
<span id="cb3-120">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perpendicular_from_C_L_cut =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">fct_rev</span>(perpendicular_from_C_L_cut))</span>
<span id="cb3-121">}</span>
<span id="cb3-122"></span>
<span id="cb3-123">hcl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_hcl_data</span>(H_point, C_point, L_point, width, n_color)</span>
<span id="cb3-124"></span>
<span id="cb3-125">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_info</span>(H_point, C_point, L_point)</span>
<span id="cb3-126">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_sample</span>(hcl)</span>
<span id="cb3-127">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span>
<span id="cb3-128"></span>
<span id="cb3-129"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># C L plane by H</span></span>
<span id="cb3-130">C_L_plane_by_H <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_C_L_plane_by_H</span>(hcl, H_point, width)</span>
<span id="cb3-131"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_L_by_H</span>(hcl)</span>
<span id="cb3-132"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_L_plane_by_H</span>(C_L_plane_by_H, hcl)</span>
<span id="cb3-133"></span>
<span id="cb3-134"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># H L curve</span></span>
<span id="cb3-135">H_L_curve_by_C <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_H_L_curve_by_C</span>(hcl)</span>
<span id="cb3-136"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_L_by_C</span>(hcl, H_point)</span>
<span id="cb3-137"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_L_curve_by_C</span>(H_L_curve_by_C, hcl, H_point)</span>
<span id="cb3-138"></span>
<span id="cb3-139"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># H C plane by L</span></span>
<span id="cb3-140">H_C_plane_by_L <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_H_C_plane_by_L</span>(hcl)</span>
<span id="cb3-141"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_x_y_by_L</span>(hcl, H_point)</span>
<span id="cb3-142"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_C_plane_by_L</span>(H_C_plane_by_L, hcl)</span>
<span id="cb3-143"></span>
<span id="cb3-144"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># C tangent plane</span></span>
<span id="cb3-145"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_parallel_perpendicular_by_L</span>(hcl)</span>
<span id="cb3-146"></span>
<span id="cb3-147"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_perpendicular_L_by_parallel</span>(hcl)</span>
<span id="cb3-148"></span>
<span id="cb3-149"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_parallel_L_by_perpendicular</span>(hcl)</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/hcl_info.jpeg" class="img-fluid figure-img"></p>
<figcaption>HCL: Info</figcaption>
</figure>
</div>
<p>This first set of graphs plots the C-L plane split by Hue values with both the perimeter and where it fits in the color space. We see these nice circles as the perimeter is cut moving along Hue values.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/hcl_c_l_plane.jpeg" class="img-fluid figure-img"></p>
<figcaption>HCL: C-L Plane by H cuts</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/hcl_c_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>HCL: C-L by H cuts</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>The next set shows H-L Curve split by different Chroma values. We’re also getting nice circles, unlike the xyL section.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/hcl_h_l_curve.jpeg" class="img-fluid figure-img"></p>
<figcaption>HCL: H-L Curve by C cuts</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/hcl_h_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>HCL: H-L by C cuts</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>The following graph breaks the trend of nice circles. Here we see teardrop shapes instead. The next few images pull this apart a little more.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/hcl_h_c_plane.jpeg" class="img-fluid figure-img"></p>
<figcaption>HCL: H-C Plane by L cuts</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/hcl_h_c.jpeg" class="img-fluid figure-img"></p>
<figcaption>HCL: H-C by L cuts</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Here we see the teardrop shapes in more detail. Because we created our “sphere” following polar coordinates, it doesn’t turn out as we might expect. This shape’s height is a function of what a sphere should be but augmented by the distance between Hue values increasing when Chroma increases. Notice that the center Chroma value is at 26. Not in the middle of the circular part, like at 30-ish.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/hcl_par_per.jpeg" class="img-fluid figure-img"></p>
<figcaption>HCL: Parallel-Perpendicular Distances by L cuts</figcaption>
</figure>
</div>
<p>We also get a squished version for the image on the left. There are fewer cuts because the shape doesn’t reach out as far as the image on the right.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/hcl_per_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>HCL: Perpendicular Distance-L by Parallel Distance cuts</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/hcl_par_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>HCL: Parallel Distance-L by Perpendicular Distance cuts</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>It is a little unwieldy to compare the different main sections apart, so we’ll add them together in the next one.</p>
<br>
<hr>
<center>
<h2 class="anchored">
Compare Perimeters
</h2>
</center>
<hr>
<p>For the following images, the two sets we previously created are stuck together and then graphed to highlight the differences well.</p>
<div class="cell">
<details class="code-fold">
<summary>[Compare Code]</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##-------</span></span>
<span id="cb4-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compare</span></span>
<span id="cb4-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##-------</span></span>
<span id="cb4-4">compare <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(xyl[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'H'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>, </span>
<span id="cb4-5">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'H_cut'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C_cut'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L_cut'</span>, </span>
<span id="cb4-6">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'perpendicular_from_C_L'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'parallel_along_C_L'</span>, </span>
<span id="cb4-7">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'perpendicular_from_C_L_cut'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'parallel_along_C_L_cut'</span>,</span>
<span id="cb4-8">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'row_value'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'col_value'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'color_value'</span>)],</span>
<span id="cb4-9">                 hcl[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'H'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>, </span>
<span id="cb4-10">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'H_cut'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C_cut'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L_cut'</span>, </span>
<span id="cb4-11">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'perpendicular_from_C_L'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'parallel_along_C_L'</span>, </span>
<span id="cb4-12">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'perpendicular_from_C_L_cut'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'parallel_along_C_L_cut'</span>,</span>
<span id="cb4-13">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'row_value'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'col_value'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'color_value'</span>)]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">setting =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'XYL'</span>, n_color), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HCL'</span>, n_color))) </span>
<span id="cb4-15"></span>
<span id="cb4-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># C L plane</span></span>
<span id="cb4-17">graph_C_L_by_H_comparison <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(color_points) {</span>
<span id="cb4-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(C, L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> setting)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> H_cut, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_discrete</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-23">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>)</span>
<span id="cb4-24">}</span>
<span id="cb4-25"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_L_by_H_comparison</span>(compare)</span>
<span id="cb4-26"></span>
<span id="cb4-27"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># H L curve</span></span>
<span id="cb4-28">graph_H_L_by_C_comparison <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(color_points, H_point) {</span>
<span id="cb4-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points, </span>
<span id="cb4-30">         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>((H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> setting)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-31">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-32">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_reverse</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'H'</span>,</span>
<span id="cb4-33">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_H_center</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H_point =</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-34">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> C_cut, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-35">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-36">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_discrete</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-37">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>)</span>
<span id="cb4-38">}</span>
<span id="cb4-39"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_L_by_C_comparison</span>(compare, H_point)</span>
<span id="cb4-40"></span>
<span id="cb4-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># H C plane</span></span>
<span id="cb4-42">graph_x_y_by_L_comparison <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(color_points, H_point) {</span>
<span id="cb4-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> setting)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-44">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slope =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tan</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">67.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>), </span>
<span id="cb4-45">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tan</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>), </span>
<span id="cb4-46">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tan</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">22.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>),</span>
<span id="cb4-47">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100000</span>,</span>
<span id="cb4-48">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tan</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">22.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>), </span>
<span id="cb4-49">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tan</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>), </span>
<span id="cb4-50">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tan</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">67.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)), </span>
<span id="cb4-51">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-52">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-53">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slope =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tan</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>), </span>
<span id="cb4-54">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb4-55">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-56">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-57">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> L_cut, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-58">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-59">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_discrete</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-60">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>,</span>
<span id="cb4-61">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-62">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-63">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb4-64">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())</span>
<span id="cb4-65">}</span>
<span id="cb4-66"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_x_y_by_L_comparison</span>(compare, H_point)</span>
<span id="cb4-67"></span>
<span id="cb4-68"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># C tangent plane</span></span>
<span id="cb4-69">graph_parallel_perpendicular_by_L_comparison <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(color_points) {</span>
<span id="cb4-70">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points, </span>
<span id="cb4-71">         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> parallel_along_C_L,</span>
<span id="cb4-72">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> perpendicular_from_C_L,</span>
<span id="cb4-73">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> setting)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-74">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-75">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance Perpendicular to C-L Plane"</span>,</span>
<span id="cb4-76">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> abs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-77">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance Parallel to C-L Plane"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-78">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> L_cut, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-79">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-80">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_discrete</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-81">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>)</span>
<span id="cb4-82">}</span>
<span id="cb4-83"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_parallel_perpendicular_by_L_comparison</span>(compare)</span>
<span id="cb4-84"></span>
<span id="cb4-85">graph_perpendicular_L_by_parallel_comparison <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(color_points) {</span>
<span id="cb4-86">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points, </span>
<span id="cb4-87">         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> perpendicular_from_C_L,</span>
<span id="cb4-88">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> L,</span>
<span id="cb4-89">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> setting)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-90">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-91">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance Perpendicular to C-L Plane"</span>, </span>
<span id="cb4-92">            <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> abs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-93">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> abs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-94">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> parallel_along_C_L_cut, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-95">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-96">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_discrete</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-97">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>)</span>
<span id="cb4-98">}</span>
<span id="cb4-99"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_perpendicular_L_by_parallel_comparison</span>(compare)</span>
<span id="cb4-100"></span>
<span id="cb4-101">graph_parallel_L_by_perpendicular_comparison <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(color_points) {</span>
<span id="cb4-102">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points, </span>
<span id="cb4-103">         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> parallel_along_C_L,</span>
<span id="cb4-104">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> L,</span>
<span id="cb4-105">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> setting)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-106">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">alpha =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-107">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">labs</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance Parallel to C-L Plane"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-108">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_wrap</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span> perpendicular_from_C_L_cut, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">nrow =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb4-109">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labeller =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">as_labeller</span>(label_perpendicular_from_C_L_cut)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-110">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-111">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_discrete</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">""</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-112">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">legend.position =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"bottom"</span>)</span>
<span id="cb4-113">}</span>
<span id="cb4-114"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_parallel_L_by_perpendicular_comparison</span>(compare)</span>
<span id="cb4-115"></span>
<span id="cb4-116">compare <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> compare <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-117">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(setting) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-118">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> </span>
<span id="cb4-119">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-120">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ceiling</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n_color))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-121">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(col_value, L) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-122">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(setting, col_value) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-123">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>())</span>
<span id="cb4-124"></span>
<span id="cb4-125"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> compare,</span>
<span id="cb4-126">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> col_value,</span>
<span id="cb4-127">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> row_value,</span>
<span id="cb4-128">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-129">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_tile</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-130">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-131">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-132">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-133">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>setting)</span>
<span id="cb4-134"></span>
<span id="cb4-135">compare <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> compare <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-136">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(setting) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-137">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> </span>
<span id="cb4-138">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-139">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ceiling</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n_color))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-140">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(col_value, C) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-141">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(setting, col_value) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-142">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>())</span>
<span id="cb4-143"></span>
<span id="cb4-144"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> compare,</span>
<span id="cb4-145">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> col_value,</span>
<span id="cb4-146">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> row_value,</span>
<span id="cb4-147">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-148">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_tile</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-149">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-150">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-151">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-152">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>setting)</span></code></pre></div>
</details>
</div>
<p>This section will have graphs with points from the xyL function in blue and HCL in orange. In the left image, we see the lop-sidedness of the xyL points with the circles of the HCL ones. Also, we can easily see that the XYL points stretch out to farther Hue values. Then we have the ovals for xyL and circles for HCL.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/compare_c_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Comparison: C-L by L cuts</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/compare_h_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Comparison: H-L by C cuts</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Then we can see the circles for xyL and teardrops for HCL.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/compare_h_c.jpeg" class="img-fluid figure-img"></p>
<figcaption>Comparison: H-C by L cuts</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/compare_par_per.jpeg" class="img-fluid figure-img"></p>
<figcaption>Comparison: Parallel-Perpendicular by L cuts</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Finally, we get a comparison that confirms the HCL function results in squeezing the perimeter, not stretching it vertically.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/compare_per_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Comparison: Perpendicular-L by Parallel cuts</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/compare_par_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Comparison: Parallel-L by Perpendicular cuts</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Graphing the perimeters is nice to see what’s going on mathematically in the space, but the main result is in the end colors. So the last images of this main section show the direct colors of the samples.</p>
<p>The first comparison has the samples sorted by Hue for the columns, then within each column, sorted by Luminance. I can’t tell a huge difference, but the Hue values for xyL seem to stretch slightly more than HCL, and HCL has a little more gray.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/compare_samples.jpeg" class="img-fluid figure-img"></p>
<figcaption>Comparison: Samples H by L</figcaption>
</figure>
</div>
<p>The second comparison has the samples sorted by Hue (like the first comparison), then sorted by Chroma. To me, this looks very different for having the same colors in the same columns. The HCL square is a little grayer at the bottom.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/compare_samples2.jpeg" class="img-fluid figure-img"></p>
<figcaption>Comparison: Samples H by C</figcaption>
</figure>
</div>
<p>For the final two main sections, we’ll change only the Chroma value. First, we’ll move everything closer to the center.</p>
<br>
<hr>
<center>
<h2 class="anchored">
Lower Chroma Value
</h2>
</center>
<hr>
<p>We’ll start by changing the base Chroma value from 26 to 16. Everything else is the same.</p>
<div class="cell">
<details class="code-fold">
<summary>[Lower Chroma Value Code]</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Try lower value of C ----</span></span>
<span id="cb5-2">C_point <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">16</span></span>
<span id="cb5-3"></span>
<span id="cb5-4">xyl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_xyl_data</span>(H_point, C_point, L_point, width, n_color)</span>
<span id="cb5-5"></span>
<span id="cb5-6">hcl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_hcl_data</span>(H_point, C_point, L_point, width, n_color)</span>
<span id="cb5-7"></span>
<span id="cb5-8">compare <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(xyl[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'H'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>, </span>
<span id="cb5-9">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'H_cut'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C_cut'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L_cut'</span>, </span>
<span id="cb5-10">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'perpendicular_from_C_L'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'parallel_along_C_L'</span>, </span>
<span id="cb5-11">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'perpendicular_from_C_L_cut'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'parallel_along_C_L_cut'</span>,</span>
<span id="cb5-12">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'row_value'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'col_value'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'color_value'</span>)],</span>
<span id="cb5-13">                 hcl[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'H'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>, </span>
<span id="cb5-14">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'H_cut'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C_cut'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L_cut'</span>, </span>
<span id="cb5-15">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'perpendicular_from_C_L'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'parallel_along_C_L'</span>, </span>
<span id="cb5-16">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'perpendicular_from_C_L_cut'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'parallel_along_C_L_cut'</span>,</span>
<span id="cb5-17">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'row_value'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'col_value'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'color_value'</span>)]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">setting =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'XYL'</span>, n_color), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HCL'</span>, n_color))) </span>
<span id="cb5-19"></span>
<span id="cb5-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># C L plane</span></span>
<span id="cb5-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_L_by_H_comparison</span>(compare)</span>
<span id="cb5-22"></span>
<span id="cb5-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># H L curve</span></span>
<span id="cb5-24"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_L_by_C_comparison</span>(compare, H_point)</span>
<span id="cb5-25"></span>
<span id="cb5-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># H C plane</span></span>
<span id="cb5-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_x_y_by_L_comparison</span>(compare, H_point)</span>
<span id="cb5-28"></span>
<span id="cb5-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># C tangent plane</span></span>
<span id="cb5-30"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_parallel_perpendicular_by_L_comparison</span>(compare)</span>
<span id="cb5-31"></span>
<span id="cb5-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_perpendicular_L_by_parallel_comparison</span>(compare)</span>
<span id="cb5-33"></span>
<span id="cb5-34"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_parallel_L_by_perpendicular_comparison</span>(compare)</span>
<span id="cb5-35"></span>
<span id="cb5-36">compare <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> compare <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(setting) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> </span>
<span id="cb5-39">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ceiling</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n_color))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(col_value, L) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(setting, col_value) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>())</span>
<span id="cb5-44"></span>
<span id="cb5-45"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> compare,</span>
<span id="cb5-46">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> col_value,</span>
<span id="cb5-47">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> row_value,</span>
<span id="cb5-48">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_tile</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>setting)</span>
<span id="cb5-54"></span>
<span id="cb5-55">compare <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> compare <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(setting) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> </span>
<span id="cb5-58">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ceiling</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n_color))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-60">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(col_value, C) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-61">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(setting, col_value) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-62">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>())</span>
<span id="cb5-63"></span>
<span id="cb5-64"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> compare,</span>
<span id="cb5-65">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> col_value,</span>
<span id="cb5-66">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> row_value,</span>
<span id="cb5-67">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-68">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_tile</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-70">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-71">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>setting)</span></code></pre></div>
</details>
</div>
<p>From these graphs, we can see everything is exaggerated. For example, the first two images have similar circles for HCL, but xyL is breaking apart and getting stretched.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/C_lower_c_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Lower C: C-L by L cuts</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/C_lower_h_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Lower C: H-L by C cuts</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Then we see the circles for xyL, but HCL has a very tight teardrop shape.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/C_lower_h_c.jpeg" class="img-fluid figure-img"></p>
<figcaption>Lower C: H-C by L cuts</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/C_lower_par_per.jpeg" class="img-fluid figure-img"></p>
<figcaption>Lower C: Parallel-Perpendicular by L cuts</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>The same trend continues with the exaggeration for HCL.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/C_lower_per_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Lower C: Perpendicular-L by Parallel cuts</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/C_lower_par_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Lower C: Parallel-L by Perpendicular cuts</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>Finally, we can compare the sampled colors directly.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/C_lower_samples.jpeg" class="img-fluid figure-img"></p>
<figcaption>Lower C: Samples H by L</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/C_lower_samples2.jpeg" class="img-fluid figure-img"></p>
<figcaption>Lower C: Samples H by C</figcaption>
</figure>
</div>
</div>
</div>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
Higher Chroma Value
</h2>
</center>
<hr>
<p>For the last main section, we’ll set Chroma to 75.</p>
<div class="cell">
<details class="code-fold">
<summary>[Higher Chroma Value Code]</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">## Try higher value of C ----</span></span>
<span id="cb6-2">C_point <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span></span>
<span id="cb6-3"> </span>
<span id="cb6-4">xyl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_xyl_data</span>(H_point, C_point, L_point, width, n_color)</span>
<span id="cb6-5"></span>
<span id="cb6-6">hcl <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_hcl_data</span>(H_point, C_point, L_point, width, n_color)</span>
<span id="cb6-7"></span>
<span id="cb6-8">compare <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rbind</span>(xyl[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'H'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>, </span>
<span id="cb6-9">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'H_cut'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C_cut'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L_cut'</span>, </span>
<span id="cb6-10">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'perpendicular_from_C_L'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'parallel_along_C_L'</span>, </span>
<span id="cb6-11">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'perpendicular_from_C_L_cut'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'parallel_along_C_L_cut'</span>,</span>
<span id="cb6-12">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'row_value'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'col_value'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'color_value'</span>)],</span>
<span id="cb6-13">                 hcl[, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'H'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'x'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'y'</span>, </span>
<span id="cb6-14">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'H_cut'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'C_cut'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'L_cut'</span>, </span>
<span id="cb6-15">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'perpendicular_from_C_L'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'parallel_along_C_L'</span>, </span>
<span id="cb6-16">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'perpendicular_from_C_L_cut'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'parallel_along_C_L_cut'</span>,</span>
<span id="cb6-17">                         <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'row_value'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'col_value'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'color_value'</span>)]) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">setting =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'XYL'</span>, n_color), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rep</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'HCL'</span>, n_color))) </span>
<span id="cb6-19"></span>
<span id="cb6-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># C L plane</span></span>
<span id="cb6-21"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_L_by_H_comparison</span>(compare)</span>
<span id="cb6-22"></span>
<span id="cb6-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># H L curve</span></span>
<span id="cb6-24"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_L_by_C_comparison</span>(compare, H_point)</span>
<span id="cb6-25"></span>
<span id="cb6-26"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># H C plane</span></span>
<span id="cb6-27"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_x_y_by_L_comparison</span>(compare, H_point)</span>
<span id="cb6-28"></span>
<span id="cb6-29"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># C tangent plane</span></span>
<span id="cb6-30"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_parallel_perpendicular_by_L_comparison</span>(compare)</span>
<span id="cb6-31"></span>
<span id="cb6-32"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_perpendicular_L_by_parallel_comparison</span>(compare)</span>
<span id="cb6-33"></span>
<span id="cb6-34"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_parallel_L_by_perpendicular_comparison</span>(compare)</span>
<span id="cb6-35"></span>
<span id="cb6-36">compare <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> compare <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(setting) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-38">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> </span>
<span id="cb6-39">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ceiling</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n_color))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(col_value, L) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-42">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(setting, col_value) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>())</span>
<span id="cb6-44"></span>
<span id="cb6-45"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> compare,</span>
<span id="cb6-46">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> col_value,</span>
<span id="cb6-47">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> row_value,</span>
<span id="cb6-48">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_tile</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-50">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-52">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-53">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>setting)</span>
<span id="cb6-54"></span>
<span id="cb6-55">compare <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> compare <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-56">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(setting) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-57">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>((<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> </span>
<span id="cb6-58">            <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-59">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ceiling</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n_color))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-60">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">arrange</span>(col_value, C) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-61">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">group_by</span>(setting, col_value) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-62">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>())</span>
<span id="cb6-63"></span>
<span id="cb6-64"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> compare,</span>
<span id="cb6-65">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> col_value,</span>
<span id="cb6-66">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> row_value,</span>
<span id="cb6-67">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-68">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_tile</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-69">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-70">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-71">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-72">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">facet_grid</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">~</span>setting)</span></code></pre></div>
</details>
</div>
<p>This time, the results have a different shape. Now, HCL stretches out farther than xyL (but still in a circle).</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/C_higher_c_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Higher C: C-L by L cuts</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/C_higher_h_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Higher C: H-L by C cuts</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>The graphs from above show the stretching well. Instead of the teardrop shape, we now have ovals. At some point in increasing the Chroma value, the HCL function surpasses xyL.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/C_higher_h_c.jpeg" class="img-fluid figure-img"></p>
<figcaption>Higher C: H-C by L cuts</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/C_higher_par_per.jpeg" class="img-fluid figure-img"></p>
<figcaption>Higher C: Parallel-Perpendicular by L cuts</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>We see the same trend continue here.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/C_higher_per_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Higher C: Perpendicular-L by Parallel cuts</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/C_higher_par_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Higher C: Parallel-L by Perpendicular cuts</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>And finally, we can compare the examples again.</p>
<div>

</div>
<div class="quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/C_higher_samples.jpeg" class="img-fluid figure-img"></p>
<figcaption>Higher C: Samples H by L</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/C_higher_samples2.jpeg" class="img-fluid figure-img"></p>
<figcaption>Higher C: Samples H by C</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>I think at the end of the post, I’m supposed to say one is better than the other, but I think they’re just different. It really depends on what you’re looking for in selecting colors. Looking at the colors is the best way to do that, but the other graphs help explain what is happening and determine the next steps.</p>




<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>If you understand the difference between polar and Cartesian coordinates pretty well, this blog post will be obvious to you. But I’m bad at math and needed to see a lot of graphs to understand what was happening. So I figured I’d throw this in a blog post.↩︎</p></li>
</ol>
</section></div> ]]></description>
  <category>R</category>
  <category>Generative Art</category>
  <guid>https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/</guid>
  <pubDate>Tue, 10 Aug 2021 04:00:00 GMT</pubDate>
  <media:content url="https://www.williamtylerbradley.com/posts/2021-08-10-choosing-nearby-colors-part-2/hcl_par_per.jpeg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>Choosing Nearby Colors Part 1</title>
  <link>https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/</link>
  <description><![CDATA[ 





<p>This blog post talks about selecting colors nearby to a chosen one. This color selection process is needed for a generative art project I’m programming. For some background, I’m using the HCL color space. I’m not going to go into a lot of details on HCL for this post. You only need to HCL specifies unique colors by <strong>H</strong>ue, <strong>C</strong>hroma, and <strong>L</strong>uminance using polar coordinates. Hue, degrees around the circle, determines the location on the color wheel (like red, blue, green). Chroma, the distance from the circle’s center, specifies how much color is involved ranging from gray in the center to intense shades at the edges. Luminance is the brightness and ranges from 0 for black and 100 for white along the z-axis. Playing around hclwizard color picker <a href="http://hclwizard.org:3000/hclcolorpicker/">(here)</a> will help your understanding of how the parameters work. Lastly, this color space is perceptually uniform, so moving one unit distance in any direction gives colors that look about the same difference. More details can be found <a href="https://en.wikipedia.org/wiki/HCL_color_space">here</a> and <a href="https://en.wikipedia.org/wiki/CIELUV#Cylindrical_representation_.28CIELCH.29">here</a>.</p>
<br>
<hr>
<center>
<h2 class="anchored">
Now for the R code
</h2>
</center>
<hr>
<p>These libraries set up data manipulation, combining graphs, and using the HCL color space.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##---------</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Libraries</span></span>
<span id="cb1-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##---------</span></span>
<span id="cb1-4"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(tidyverse)</span>
<span id="cb1-5"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(patchwork)</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">library</span>(colorspace)</span></code></pre></div>
</div>
<p>We’ll set up some code to get a green base color based on H, C, and L. We’ll also create a data set called <code>color_points</code>. This will only have one observation for right now, but we will add in more rows later. It’ll serve as a placeholder for functions that graph different shapes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##------------</span></span>
<span id="cb2-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pick a color</span></span>
<span id="cb2-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##------------</span></span>
<span id="cb2-4">H_point <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">112</span></span>
<span id="cb2-5">C_point <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">60</span></span>
<span id="cb2-6">L_point <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">68</span></span>
<span id="cb2-7"></span>
<span id="cb2-8">color_hex <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(H_point, </span>
<span id="cb2-9">                 C_point,</span>
<span id="cb2-10">                 L_point,</span>
<span id="cb2-11">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixup =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb2-12"></span>
<span id="cb2-13">color_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>),</span>
<span id="cb2-14">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>),</span>
<span id="cb2-15">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> L_point,</span>
<span id="cb2-16">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H =</span> H_point,</span>
<span id="cb2-17">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C =</span> C_point,</span>
<span id="cb2-18">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L =</span> L_point,</span>
<span id="cb2-19">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_value =</span> color_hex,</span>
<span id="cb2-20">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perpendicular_from_C_L =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb2-21">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">parallel_along_C_L =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb2-22">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_value =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb2-23">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_value =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)</span></code></pre></div>
</div>
<p>Let’s see where this base color exists in the HCL color space and create some helper functions.</p>
<p>We’ll start with looking at the Chroma-Luminance plane (C-L Plane). We want to graph slicing the HCL color space in half from top to bottom along the line H = 112. (<code>H_point</code> = 112)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##--------------------------------</span></span>
<span id="cb3-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># See color in H, C, L color space </span></span>
<span id="cb3-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##--------------------------------</span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># C-L Plane ----</span></span>
<span id="cb3-5">get_C_L_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(H_point) {</span>
<span id="cb3-6">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H =</span> H_point,</span>
<span id="cb3-7">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),</span>
<span id="cb3-8">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(H, C, L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixup =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb3-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(color_value))</span>
<span id="cb3-11">}</span>
<span id="cb3-12">C_L_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_C_L_plane</span>(H_point)</span>
<span id="cb3-13"></span>
<span id="cb3-14">graph_C_L_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(C_L_plane, color_points, color_hex) {</span>
<span id="cb3-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-16">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> C_L_plane,</span>
<span id="cb3-17">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(C, L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color_value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points,</span>
<span id="cb3-19">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(C, L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> abs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-23">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> C_point,</span>
<span id="cb3-24">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> L_point),</span>
<span id="cb3-25">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>,</span>
<span id="cb3-26">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_hex,</span>
<span id="cb3-27">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,</span>
<span id="cb3-28">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb3-29">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb3-30">}</span>
<span id="cb3-31"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_L_plane</span>(C_L_plane, color_points, color_hex)</span></code></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/c_l_plane.jpeg" class="img-fluid figure-img"></p>
<figcaption>Base Color: C-L Plane</figcaption>
</figure>
</div>
<p>We can see as the Luminance increases, the shades move from darker to lighter, and as Chroma moves out from 0, the color is more intense. The <code>get_C_L_plane</code> function returns a data set with points on that plane. For this blog post, functions that start with “get” return points we’re going to graph while functions that start with “graph” display them appropriately. This plane actually extends to the left, where the H value would be the current H + 180. I’m not graphing that section because this project will keep values close to the base color without changing the Hue too much.</p>
<p>From here down, I’ll hide some of the code similar to previous sections to shorten the post. You can click on <span style="color: #C29CB7 ">[texts]</span> to show code if you want to see it.</p>
<p>Next, we can see the color falls with all the other colors for the same Chroma value. I think about Chroma values as tree rings. So, this image takes the HCL color space, drills out the center for lower Chroma values, then has you stand in the middle facing the Hue value, pulling the shape away from behind you and laying it flat.</p>
<div class="cell">
<details class="code-fold">
<summary>[H-L Curve Code]</summary>
<div class="sourceCode cell-code" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># H-L Curve ----</span></span>
<span id="cb4-2">get_H_L_curve <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(C_point) {</span>
<span id="cb4-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb4-4">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C =</span> C_point,</span>
<span id="cb4-5">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(H, C, L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixup =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb4-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(color_value))</span>
<span id="cb4-8">}</span>
<span id="cb4-9">H_L_curve <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_H_L_curve</span>(C_point)</span>
<span id="cb4-10"></span>
<span id="cb4-11">label_H_center <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(H_point, ...) {</span>
<span id="cb4-12">  <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(x) {(x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>}</span>
<span id="cb4-13">}</span>
<span id="cb4-14"></span>
<span id="cb4-15">graph_H_L_curve <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(H_L_curve, color_points, color_hex, H_point) {</span>
<span id="cb4-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-17">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> H_L_curve,</span>
<span id="cb4-18">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>((H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, L, </span>
<span id="cb4-19">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color_value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points,</span>
<span id="cb4-21">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>((H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, L, </span>
<span id="cb4-22">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-23">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-24">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-25">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Because we rotated points to not drop over edge</span></span>
<span id="cb4-26">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> L_point),</span>
<span id="cb4-27">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>,</span>
<span id="cb4-28">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_hex,</span>
<span id="cb4-29">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,</span>
<span id="cb4-30">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-31">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_reverse</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'H'</span>, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Like you're standing on the inside</span></span>
<span id="cb4-32">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">label_H_center</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H_point =</span> H_point),</span>
<span id="cb4-33">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb4-34">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb4-35">}</span>
<span id="cb4-36"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_L_curve</span>(H_L_curve, color_points, color_hex, H_point)</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/h_l_curve.jpeg" class="img-fluid figure-img"></p>
<figcaption>Base Color: H-L Curve</figcaption>
</figure>
</div>
<p>You can see the odd shape of the HCL color space where the different Hues don’t stretch their Chroma values out at different Luminance values. This is the only graph that shows a flattened curve. Everything else displays a sharp slice. For all the H-L curve graphs, the Hue value is rotated to the center.</p>
<p>Now we can look at cutting horizontally through the HCL color space where L = 68. (<code>L_point</code> = 68)</p>
<div class="cell">
<details class="code-fold">
<summary>[H-C Plane Code]</summary>
<div class="sourceCode cell-code" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># H-C plane ----</span></span>
<span id="cb5-2">get_H_C_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(L_point){</span>
<span id="cb5-3">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>),</span>
<span id="cb5-4">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),</span>
<span id="cb5-5">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L =</span> L_point) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(H, C, L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixup =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb5-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(color_value))</span>
<span id="cb5-8">}</span>
<span id="cb5-9">H_C_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_H_C_plane</span>(L_point)</span>
<span id="cb5-10"></span>
<span id="cb5-11">graph_H_C_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(H_C_plane, color_points, color_hex) {</span>
<span id="cb5-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-13">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> H_C_plane,</span>
<span id="cb5-14">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(H, C, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color_value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points,</span>
<span id="cb5-16">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(H, C, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-17">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>),</span>
<span id="cb5-20">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">minor_breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">315</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb5-21">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'45'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'90'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'135'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'180'</span>, </span>
<span id="cb5-22">                                  <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'225'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'270'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'315'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'0|360'</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-23">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-24">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> H_point,</span>
<span id="cb5-25">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> C_point),</span>
<span id="cb5-26">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>,</span>
<span id="cb5-27">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_hex,</span>
<span id="cb5-28">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,</span>
<span id="cb5-29">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb5-30">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_polar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">270</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>,</span>
<span id="cb5-31">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb5-32">}</span>
<span id="cb5-33"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_C_plane</span>(H_C_plane, color_points, color_hex)</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/h_c_plane.jpeg" class="img-fluid figure-img"></p>
<figcaption>Base Color: H-C Plane</figcaption>
</figure>
</div>
<p>We can see the different colors as Hue moves around a circle and their increased intensity as Chroma moves out to the edges. The shape is not circular because the HCL color space isn’t.</p>
<p>There is one more graph to see. We looked at cutting the HCL color space along the Hue, Chroma, and Luminance values, but the Chroma image was a flattened curve. So instead, we can cut a plane at the Chroma value but tangent to the circle a constant Chroma value creates. The following image sets up the explanation, and then we’ll see the actual plane.</p>
<div class="cell">
<details class="code-fold">
<summary>[C Tangent Plane Setup Code]</summary>
<div class="sourceCode cell-code" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># C tangent plane ----</span></span>
<span id="cb6-2">C_circle <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>),</span>
<span id="cb6-3">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C =</span> C_point,</span>
<span id="cb6-4">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)</span>
<span id="cb6-5">C_tangent_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> C_point, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plane perpendicular to H at C</span></span>
<span id="cb6-6">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perpendicular_from_C_L =</span> </span>
<span id="cb6-7">                         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> C_point<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> C_point<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)),</span>
<span id="cb6-8">                       <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-9">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x_rotate =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rotate</span></span>
<span id="cb6-10">           perpendicular_from_C_L <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>),</span>
<span id="cb6-11">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y_rotate =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb6-12">           perpendicular_from_C_L <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x_rotate,</span>
<span id="cb6-14">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y_rotate) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x_rotate, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>y_rotate)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H =</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">atan2</span>(y, x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>pi) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>,</span>
<span id="cb6-17">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb6-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_value =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)</span>
<span id="cb6-19"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> H_C_plane,</span>
<span id="cb6-20">       <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(H, C, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color_value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-23">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>),</span>
<span id="cb6-25">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">minor_breaks =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">315</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,</span>
<span id="cb6-26">                     <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'45'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'90'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'135'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'180'</span>, </span>
<span id="cb6-27">                                <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'225'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'270'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'315'</span>, <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'0|360'</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-28">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_y_continuous</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">limits =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_path</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> C_circle) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_segment</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> H_point,</span>
<span id="cb6-31">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb6-32">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xend =</span> H_point,</span>
<span id="cb6-33">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">yend =</span> C_point,</span>
<span id="cb6-34">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> C_tangent_plane, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> H_point,</span>
<span id="cb6-37">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> C_point,</span>
<span id="cb6-38">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>,</span>
<span id="cb6-39">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_hex,</span>
<span id="cb6-40">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb6-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_polar</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">start =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">270</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>,</span>
<span id="cb6-42">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">direction =</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/c_tangent_plane_setup.jpeg" class="img-fluid figure-img"></p>
<figcaption>C Tangent Plane setup</figcaption>
</figure>
</div>
<p>Chroma and Luminance move in straight lines, but Hue is circular. The image shows this with the white circle where Chroma and Luminance are constant, but Hue moves around the circle. This means looking at graphs of shapes can be distorted when graphing them flat. So we might want to see what happens as we move away from our specific color in a straight line perpendicular to the C-L Plane. That’s the black line. We’re going to cut the HCL space from top to bottom along this line.</p>
<div class="cell">
<details class="code-fold">
<summary>[C Tangent Plane Code]</summary>
<div class="sourceCode cell-code" id="cb7" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1">get_C_tangent_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(H_point, C_point) {</span>
<span id="cb7-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">expand_grid</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> C_point, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Plane perpendicular to H at C</span></span>
<span id="cb7-3">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perpendicular_from_C_L =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>),</span>
<span id="cb7-4">              <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x_rotate =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>  <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rotate</span></span>
<span id="cb7-6">             perpendicular_from_C_L <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>),</span>
<span id="cb7-7">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y_rotate =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb7-8">             perpendicular_from_C_L <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x_rotate,</span>
<span id="cb7-10">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y_rotate) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-11">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x_rotate, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>y_rotate)  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-12">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H =</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">atan2</span>(y, x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>pi) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>,</span>
<span id="cb7-13">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(H, C, L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixup =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb7-15">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(color_value))</span>
<span id="cb7-16">}</span>
<span id="cb7-17">C_tangent_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_C_tangent_plane</span>(H_point, C_point)</span>
<span id="cb7-18"></span>
<span id="cb7-19">graph_C_tangent_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(C_tangent_plane, color_points, color_hex) {</span>
<span id="cb7-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> C_tangent_plane,</span>
<span id="cb7-22">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(perpendicular_from_C_L, L, </span>
<span id="cb7-23">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color_value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-24">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points,</span>
<span id="cb7-25">               <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(perpendicular_from_C_L, L, </span>
<span id="cb7-26">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-27">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-28">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-29">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_reverse</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"Distance Perpendicular to C-L Plane"</span>,</span>
<span id="cb7-30">                    <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">labels =</span> abs) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-31">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb7-32">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> L_point),</span>
<span id="cb7-33">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'black'</span>,</span>
<span id="cb7-34">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_hex,</span>
<span id="cb7-35">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">shape =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">21</span>,</span>
<span id="cb7-36">               <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb7-37">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>()</span>
<span id="cb7-38">}</span>
<span id="cb7-39"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_tangent_plane</span>(C_tangent_plane, color_points, color_hex)</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/c_tangent_plane.jpeg" class="img-fluid figure-img"></p>
<figcaption>Base Color: Plane Perpendicular to C-L Plane</figcaption>
</figure>
</div>
<p>This shows the plane perpendicular to the C-L Plane at C = 60. A horizontal line drawn at the point on this image matches where the black intersects the H-C plane in the previous graph. This image isn’t super helpful here, but it will be when we check shapes later.</p>
<br>
<hr>
<center>
<h2 class="anchored">
Nearby points in a sphere
</h2>
</center>
<hr>
<p>Let’s start with drawing random points inside a sphere with a width of 5 centered on our base color.</p>
<p>The code below draws random points in a unit sphere, stretches it to be the right size, then moves it to our base color. After that, the code converts it to HCL coordinates, converts these to a color, then creates some nice variables to use for plotting later.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##------</span></span>
<span id="cb8-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Sphere</span></span>
<span id="cb8-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##------</span></span>
<span id="cb8-4">radius <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb8-5">n_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb8-6"></span>
<span id="cb8-7">color_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n_points),</span>
<span id="cb8-8">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n_points),</span>
<span id="cb8-9">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n_points),</span>
<span id="cb8-10">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">U =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n_points)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-11">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normalize =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> z<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> U <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normalize,</span>
<span id="cb8-13">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> U <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normalize,</span>
<span id="cb8-14">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> U <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normalize) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-15">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>U, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>normalize) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># have random points in a sphere here</span></span>
<span id="cb8-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> radius, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># stretch</span></span>
<span id="cb8-17">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> radius,</span>
<span id="cb8-18">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> radius) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-19">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># move</span></span>
<span id="cb8-20">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>),</span>
<span id="cb8-21">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> L_point) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H =</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">atan2</span>(y, x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>pi) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>,</span>
<span id="cb8-23">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb8-24">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L =</span> z) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(H, C, L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixup =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perpendicular_from_C_L =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb8-27">           y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>),</span>
<span id="cb8-28">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">parallel_along_C_L =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> </span>
<span id="cb8-29">           y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>(), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()),</span>
<span id="cb8-31">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ceiling</span>(row_value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n_points))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb8-32">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_value =</span> (row_value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n_points)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</div>
<p>Here we see the values, base color, and sample points.</p>
<div class="cell">
<details class="code-fold">
<summary>[Sphere Info Code]</summary>
<div class="sourceCode cell-code" id="cb9" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1">graph_info <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(H_point, C_point, L_point) {</span>
<span id="cb9-2">  color_hex <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(H_point, </span>
<span id="cb9-3">                   C_point,</span>
<span id="cb9-4">                   L_point,</span>
<span id="cb9-5">                   <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixup =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb9-6">  </span>
<span id="cb9-7">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_rect</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">xmax =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,</span>
<span id="cb9-9">                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymin =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ymax =</span> .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> color_hex, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_hex) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-10">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_text</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb9-11">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1.5</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">75</span>, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>),</span>
<span id="cb9-12">                                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"HEX Value:"</span>, color_hex), </span>
<span id="cb9-13">                                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"H Value:"</span>, H_point),</span>
<span id="cb9-14">                                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"C Value:"</span>, C_point),</span>
<span id="cb9-15">                                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">paste</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"L Value:"</span>, L_point))),</span>
<span id="cb9-16">              <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">label =</span> label), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">hjust =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">size =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-17">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>()</span>
<span id="cb9-19">}</span>
<span id="cb9-20"></span>
<span id="cb9-21">graph_sample <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(color_points) {</span>
<span id="cb9-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points,</span>
<span id="cb9-23">         <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> row_value,</span>
<span id="cb9-24">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> col_value,</span>
<span id="cb9-25">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-26">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_tile</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-27">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-28">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb9-29">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme_void</span>()</span>
<span id="cb9-30">}</span>
<span id="cb9-31"></span>
<span id="cb9-32">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_info</span>(H_point, C_point, L_point)</span>
<span id="cb9-33">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_sample</span>(color_points)</span>
<span id="cb9-34">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/sphere_info.jpeg" class="img-fluid figure-img"></p>
<figcaption>Sphere: Base Color and Sample Points</figcaption>
</figure>
</div>
<p>We can reuse the previous functions to graph the planes with our sphere in white to get the outline shape by using the new points as the <code>color_points</code> parameter. Then we can just graph the new points to see how they look. For example, in the following image, the left side has the previous C-L Plane image with points from the sphere blocked out in white. However, the right side has those same points with the correct color.</p>
<div class="cell">
<details class="code-fold">
<summary>[C-L Plane Code]</summary>
<div class="sourceCode cell-code" id="cb10" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1">graph_C_L <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(color_points) {</span>
<span id="cb10-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(C, L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> color_value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-3">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb10-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb10-8">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb10-9">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())</span>
<span id="cb10-10">}</span>
<span id="cb10-11"></span>
<span id="cb10-12">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_L_plane</span>(C_L_plane, color_points, color_hex)</span>
<span id="cb10-13">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_L</span>(color_points)</span>
<span id="cb10-14">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/sphere_c_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Sphere: C-L Plane</figcaption>
</figure>
</div>
<p>Now, we can continue with the others, starting with the H-L Curve. It’s hard to tell in this image, but the shape isn’t a perfect circle. It’s slightly off because the Hue values curve through the sphere, then that intersection is flattened in the graph. This distortion is more evident for different values.</p>
<div class="cell">
<details class="code-fold">
<summary>[H-L Curve Code]</summary>
<div class="sourceCode cell-code" id="cb11" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1">graph_H_L <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(color_points, H_point) {</span>
<span id="cb11-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>((H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>, L, </span>
<span id="cb11-3">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> color_value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_reverse</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb11-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb11-10">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb11-11">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())</span>
<span id="cb11-12">}</span>
<span id="cb11-13"></span>
<span id="cb11-14">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_L_curve</span>(H_L_curve, color_points, color_hex, H_point)</span>
<span id="cb11-15">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_L</span>(color_points, H_point)</span>
<span id="cb11-16">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/sphere_h_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Sphere: H-L Curve”</figcaption>
</figure>
</div>
<p>The next shape is a perfect circle because the plane perpendicular to the C-L Plane is already flat.</p>
<div class="cell">
<details class="code-fold">
<summary>[C Tangent Plane Code]</summary>
<div class="sourceCode cell-code" id="cb12" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1">graph_perpendicular_from_C_L <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(color_points) {</span>
<span id="cb12-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(perpendicular_from_C_L, L, </span>
<span id="cb12-3">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> color_value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-5">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-6">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>()  <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-7">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_x_reverse</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-8">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb12-9">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb12-10">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb12-11">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())</span>
<span id="cb12-12">}</span>
<span id="cb12-13"></span>
<span id="cb12-14">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_tangent_plane</span>(C_tangent_plane, color_points, color_hex)</span>
<span id="cb12-15">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_perpendicular_from_C_L</span>(color_points)</span>
<span id="cb12-16">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/sphere_p_c_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Sphere: Plane Perpendicular to C-L Plane</figcaption>
</figure>
</div>
<p>The last image is of the H-C Plane and the sphere based on x-y coordinates. The black line on the right-side is at H = 112.</p>
<div class="cell">
<details class="code-fold">
<summary>[H-C Plane Code]</summary>
<div class="sourceCode cell-code" id="cb13" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1">graph_x_y <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(color_points, H_point) {</span>
<span id="cb13-2">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ggplot</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">data =</span> color_points, <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">aes</span>(x, y, </span>
<span id="cb13-3">                                  <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col =</span> color_value, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fill =</span> color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-4">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slope =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tan</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">67.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>), </span>
<span id="cb13-5">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tan</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>), </span>
<span id="cb13-6">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tan</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">22.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>),</span>
<span id="cb13-7">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, </span>
<span id="cb13-8">                          <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100000</span>,</span>
<span id="cb13-9">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tan</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">22.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>), </span>
<span id="cb13-10">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tan</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>), </span>
<span id="cb13-11">                          <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tan</span>(<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">67.5</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)), </span>
<span id="cb13-12">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb13-13">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"white"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-14">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_abline</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">slope =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">tan</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>), </span>
<span id="cb13-15">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">intercept =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,</span>
<span id="cb13-16">                <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color =</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"black"</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-17">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">geom_point</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_color_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">scale_fill_identity</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-20">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">coord_equal</span>() <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span></span>
<span id="cb13-21">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">theme</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.line=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb13-22">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.text.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.ticks=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb13-23">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.x=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">axis.title.y=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(),</span>
<span id="cb13-24">          <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.major=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>(), <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">panel.grid.minor=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">element_blank</span>())</span>
<span id="cb13-25">}</span>
<span id="cb13-26"></span>
<span id="cb13-27">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_C_plane</span>(H_C_plane, color_points, color_hex)</span>
<span id="cb13-28">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_x_y</span>(color_points, H_point)</span>
<span id="cb13-29">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/sphere_h_c.jpeg" class="img-fluid figure-img"></p>
<figcaption>Sphere: H-C Plane</figcaption>
</figure>
</div>
<p>Now to expand this technique out a little more, we can stretch the sphere in different ways.</p>
<br>
<hr>
<center>
<h2 class="anchored">
Nearby points in an ellipse
</h2>
</center>
<hr>
<p>The following code starts and ends with the same lines as the previous code for points in a sphere. There’s are just two changes: stretching the sphere based on different amounts and rotating the points to line up the axes correctly. The <code>radius</code> parameter gets broken into three: <code>H_radius</code>, <code>C_radius</code>, and <code>L_radius.</code> The <code>C_radius</code> and <code>L_radius</code> stretch the sphere along those directions from the point. The <code>H_radius</code> is a slight misnomer because it’s stretching perpendicular to the C-L Plane, which is similar to how Hue changes but doesn’t exactly match the curve.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##-------</span></span>
<span id="cb14-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Ellipse</span></span>
<span id="cb14-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##-------</span></span>
<span id="cb14-4">H_radius <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.5</span></span>
<span id="cb14-5">C_radius <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb14-6">L_radius <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb14-7"></span>
<span id="cb14-8">color_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n_points),</span>
<span id="cb14-9">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n_points),</span>
<span id="cb14-10">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n_points),</span>
<span id="cb14-11">                           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">U =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n_points)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-12">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normalize =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> z<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-13">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> U <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normalize,</span>
<span id="cb14-14">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> U <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normalize,</span>
<span id="cb14-15">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> U <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normalize) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-16">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>U, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>normalize) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># have random points in a sphere here</span></span>
<span id="cb14-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> C_radius, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># stretch</span></span>
<span id="cb14-18">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> H_radius,</span>
<span id="cb14-19">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> L_radius) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-20">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x_turn =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> </span>
<span id="cb14-21">           y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rotate</span></span>
<span id="cb14-22">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y_turn =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb14-23">           y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-24">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x_turn,</span>
<span id="cb14-25">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y_turn) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-26">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x_turn, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>y_turn) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># move</span></span>
<span id="cb14-28">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>),</span>
<span id="cb14-29">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> L_point) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H =</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">atan2</span>(y, x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>pi) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>,</span>
<span id="cb14-31">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb14-32">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L =</span> z) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-33">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(L <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> L <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> C <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(H, C, L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixup =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-35">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perpendicular_from_C_L =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb14-36">           y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>),</span>
<span id="cb14-37">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">parallel_along_C_L =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> </span>
<span id="cb14-38">           y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-39">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>(), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()),</span>
<span id="cb14-40">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ceiling</span>(row_value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n_points))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb14-41">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_value =</span> (row_value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n_points)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>[Ellipse Info Code]</summary>
<div class="sourceCode cell-code" id="cb15" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_info</span>(H_point, C_point, L_point)</span>
<span id="cb15-2">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_sample</span>(color_points)</span>
<span id="cb15-3">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/ellipse_info.jpeg" class="img-fluid figure-img"></p>
<figcaption>Ellipse: Base Color and Sample Points</figcaption>
</figure>
</div>
<p>In this section’s images, we can see how the sphere gets stretched. If you’re standing in the center of the HCL color space and face the point, the sphere was extended to your left and right by the <code>H_radius</code> amount, to and away from you by <code>C_radius</code>, and vertically by <code>L_radius.</code></p>
<div class="cell">
<details class="code-fold">
<summary>[C-L Plane Code]</summary>
<div class="sourceCode cell-code" id="cb16" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_L_plane</span>(C_L_plane, color_points, color_hex)</span>
<span id="cb16-2">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_L</span>(color_points)</span>
<span id="cb16-3">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/ellipse_c_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Ellipse: C-L Plane</figcaption>
</figure>
</div>
<p>In the previous image, we can see the ellipse is <code>2 * L_radius</code> tall and <code>2 * C_radius</code> wide. In the following image, the ellipse is also <code>2 * L_radius</code> tall. It changed horizontally but not by <code>2 * H_radius</code>. This image displays the <code>C_point</code> radius circles as H changes through the HCL color space, so the distance of stretching is a function of the arc length of those circles. The next image has a width of <code>2 * H_radius</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>[H-L Curve Code]</summary>
<div class="sourceCode cell-code" id="cb17" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_L_curve</span>(H_L_curve, color_points, color_hex, H_point)</span>
<span id="cb17-2">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_L</span>(color_points, H_point)</span>
<span id="cb17-3">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/ellipse_h_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Ellipse: H-L Curve</figcaption>
</figure>
</div>
<div class="cell">
<details class="code-fold">
<summary>[C Tangent Plane Code]</summary>
<div class="sourceCode cell-code" id="cb18" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_tangent_plane</span>(C_tangent_plane, color_points, color_hex)</span>
<span id="cb18-2">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_perpendicular_from_C_L</span>(color_points)</span>
<span id="cb18-3">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/ellipse_p_c_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Ellipse: Plane Perpendicular to C-L Plane</figcaption>
</figure>
</div>
<p>Finally, we see the H-C plane with an ellipse with one axis <code>2 * C_radius</code> long and the other of <code>2 * H_radius</code>. It’s pointing to the center, so which axis appears as height and width would change as H turns.</p>
<div class="cell">
<details class="code-fold">
<summary>[H-C Plane Code]</summary>
<div class="sourceCode cell-code" id="cb19" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_C_plane</span>(H_C_plane, color_points, color_hex)</span>
<span id="cb19-2">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_x_y</span>(color_points, H_point)</span>
<span id="cb19-3">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/ellipse_h_c.jpeg" class="img-fluid figure-img"></p>
<figcaption>Ellipse: H-C Plane</figcaption>
</figure>
</div>
<p>While we’re transforming the original sphere, we can add in tilting.</p>
<br>
<hr>
<center>
<h2 class="anchored">
Nearby points in a tilted ellipse
</h2>
</center>
<hr>
<p>I’m focusing on the Hue value for this project, so we’ll always tilt along the C-L Plane. Points with Hue = <code>H_point</code> will keep the same Hue as we rock the top and bottom either closer or farther from the center. Other points will change their Hue because they’ll move parallel to the C-L Plane and Hue is at an angle to this plane. We’ll change the Chroma and Luminance values for all points except the base color as we tilt.</p>
<p>The following code is the same as the previous one but adds tilting the ellipse by <code>tilt_theta</code>, the new parameter for the degree of tilt. In addition, the radius parameters have changed to map to the axis that is tilted, <code>theta_radius</code>, the other radius on the C-L Plane, <code>other_C_L_radius</code>, and the one perpendicular to the other two, <code>perpendicular_C_L_radius</code> (which fixes the <code>H_radius</code> misnomer).</p>
<p>A little code also finds the <code>tilt_theta</code> that points the ellipse towards the farthest point on the C-L Plane. This helps stretch the ellipse without hitting an edge (but any theta can be used).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##--------------</span></span>
<span id="cb20-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Tilted Ellipse</span></span>
<span id="cb20-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##--------------</span></span>
<span id="cb20-4">theta_radius <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb20-5">other_C_L_radius <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb20-6">perpendicular_C_L_radius <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb20-7"></span>
<span id="cb20-8"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Try rotating to point major axis to max chroma value</span></span>
<span id="cb20-9">max_chromas <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max_chroma</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">h =</span> H_point, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">l =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>))</span>
<span id="cb20-10">tilt_theta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">atan2</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">seq</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>, .<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>)[<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(max_chromas) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> max_chromas] <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> L_point,</span>
<span id="cb20-11">                     <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>(max_chromas) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> C_point)</span>
<span id="cb20-12"></span>
<span id="cb20-13">color_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n_points),</span>
<span id="cb20-14">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n_points),</span>
<span id="cb20-15">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n_points),</span>
<span id="cb20-16">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">U =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n_points)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-17">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normalize =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> z<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-18">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> U <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normalize,</span>
<span id="cb20-19">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> U <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normalize,</span>
<span id="cb20-20">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> U <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normalize) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-21">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>U, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>normalize) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># have random points in a sphere here</span></span>
<span id="cb20-22">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> theta_radius, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># stretch</span></span>
<span id="cb20-23">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> other_C_L_radius,</span>
<span id="cb20-24">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> perpendicular_C_L_radius) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-25">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z_tilt =</span> z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(tilt_theta) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(tilt_theta), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># tilt</span></span>
<span id="cb20-26">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x_tilt =</span> z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(tilt_theta) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(tilt_theta)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-27">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x_tilt,</span>
<span id="cb20-28">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> z_tilt) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-29">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x_tilt, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>z_tilt) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-30">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x_turn =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> </span>
<span id="cb20-31">           y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rotate</span></span>
<span id="cb20-32">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y_turn =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb20-33">           y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-34">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x_turn,</span>
<span id="cb20-35">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y_turn) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-36">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x_turn, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>y_turn) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-37">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># move</span></span>
<span id="cb20-38">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>),</span>
<span id="cb20-39">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> L_point) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-40">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H =</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">atan2</span>(y, x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>pi) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>,</span>
<span id="cb20-41">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb20-42">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L =</span> z) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-43">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(L <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> L <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> C <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-44">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(H, C, L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixup =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-45">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perpendicular_from_C_L =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb20-46">           y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>),</span>
<span id="cb20-47">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">parallel_along_C_L =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> </span>
<span id="cb20-48">           y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-49">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>(), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()),</span>
<span id="cb20-50">         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ceiling</span>(row_value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n_points))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb20-51">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_value =</span> (row_value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n_points)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span></code></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>[Tilted Ellipse Info Code]</summary>
<div class="sourceCode cell-code" id="cb21" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_info</span>(H_point, C_point, L_point)</span>
<span id="cb21-2">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_sample</span>(color_points)</span>
<span id="cb21-3">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/tilted_ellipse_info.jpeg" class="img-fluid figure-img"></p>
<figcaption>Tilted Ellipse: Base Color and Sample Points</figcaption>
</figure>
</div>
<p>The following image shows the tilt the best. We can see that it now points to the tip of the triangle.</p>
<div class="cell">
<details class="code-fold">
<summary>[C-L Plane Code]</summary>
<div class="sourceCode cell-code" id="cb22" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_L_plane</span>(C_L_plane, color_points, color_hex)</span>
<span id="cb22-2">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_L</span>(color_points)</span>
<span id="cb22-3">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/tilted_ellipse_c_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Tilted Ellipse: C-L Plane</figcaption>
</figure>
</div>
<p>The right side isn’t quite symmetric across a horizontal line in the middle in the following image. The top is a little thinner than the bottom, so it’s more of an egg shape. That happens because the H values curve through the ellipse and flatten into this image. Different H values are obtained for different C values, and C and L are correlated in this shape. So in this image, as L changes, C also changes, which affects the H values reached by the edges. This graph won’t always result in an egg shape, but it does in this case.</p>
<div class="cell">
<details class="code-fold">
<summary>[H-L Curve Code]</summary>
<div class="sourceCode cell-code" id="cb23" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_L_curve</span>(H_L_curve, color_points, color_hex, H_point)</span>
<span id="cb23-2">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_L</span>(color_points, H_point)</span>
<span id="cb23-3">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/tilted_ellipse_h_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Tilted Ellipse: H-L Curve</figcaption>
</figure>
</div>
<p>The next one is symmetric across a horizontal line in the middle. Checking this feature is one of the main reasons for this graph.</p>
<div class="cell">
<details class="code-fold">
<summary>[C Tangent Plane Code]</summary>
<div class="sourceCode cell-code" id="cb24" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_tangent_plane</span>(C_tangent_plane, color_points, color_hex)</span>
<span id="cb24-2">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_perpendicular_from_C_L</span>(color_points)</span>
<span id="cb24-3">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/tilted_ellipse_p_c_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Tilted Ellipse: Plane Perpendicular to C-L Plane</figcaption>
</figure>
</div>
<p>Finally, we see the H-C Plane. The length along the C-L Plane line is a function of the radii and tilt amount, but the perpendicular length is just <code>perpendicular_C_L_radius</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>[H-C Plane Code]</summary>
<div class="sourceCode cell-code" id="cb25" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_C_plane</span>(H_C_plane, color_points, color_hex)</span>
<span id="cb25-2">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_x_y</span>(color_points, H_point)</span>
<span id="cb25-3">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/tilted_ellipse_h_c.jpeg" class="img-fluid figure-img"></p>
<figcaption>Tilted Ellipse: H-C Plane</figcaption>
</figure>
</div>
<p>So far, this setup has a lot of flexibility but is also fragile. So, we’ll bulk up the sampling function.</p>
<br>
<hr>
<center>
<h2 class="anchored">
Clean up the final function
</h2>
</center>
<hr>
<p>There are a couple of ways to get points that don’t have actual values, such as outside useable Chroma values or Luminance values outside [0, 100]. To handle this, we’ll add in a feature that over samples points, only keeps the ones that have a color, then samples down to the desired amount. The new <code>oversample</code> parameter adds in the extra points. Of course, this could be down in a while loop, but this is fast enough and normally works.</p>
<p>We might also want to limit the Hue values. For example, if we only want red colors without going into purple or orange, we can block samples too far away based on their H values, even if our <code>perpendicular_C_L_radius</code> is too large. We’ll just crop any points out that go past those bounds.</p>
<p>Finally, the HCL color space is oddly shaped, so it’s possible to sample points distributed unevenly along either side of the <code>H_point</code> value. That could shift the overall average Hue. To prevent that, I’m adding a catch that if the point couldn’t exist on the other side of the Hue values, then discard it. That’ll make the final regions trimmed out of the ellipse to be symmetric across <code>H_point</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##--------</span></span>
<span id="cb26-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Clean up</span></span>
<span id="cb26-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##--------</span></span>
<span id="cb26-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sampling, hitting edges</span></span>
<span id="cb26-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># within h bounds, this also catches C on the other side</span></span>
<span id="cb26-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># symmetric on H</span></span>
<span id="cb26-7"></span>
<span id="cb26-8">H_bound <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># up to 90</span></span>
<span id="cb26-9">get_color_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(n_points, oversample,</span>
<span id="cb26-10">                             H_point, C_point, L_point,</span>
<span id="cb26-11">                             theta_radius, other_C_L_radius, </span>
<span id="cb26-12">                             perpendicular_C_L_radius,</span>
<span id="cb26-13">                             tilt_theta, H_bound) {</span>
<span id="cb26-14">  <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n_points <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> oversample), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># over sample in case some points fail</span></span>
<span id="cb26-15">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n_points <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> oversample),</span>
<span id="cb26-16">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n_points <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> oversample),</span>
<span id="cb26-17">             <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">U =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">n =</span> n_points <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> oversample)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-18">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">normalize =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> z<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-19">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> U <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normalize,</span>
<span id="cb26-20">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> U <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normalize,</span>
<span id="cb26-21">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> U <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> normalize) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-22">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>U, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>normalize) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># have random points in a sphere here</span></span>
<span id="cb26-23">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> theta_radius, <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># stretch</span></span>
<span id="cb26-24">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> other_C_L_radius,</span>
<span id="cb26-25">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> perpendicular_C_L_radius) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-26">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z_tilt =</span> z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(tilt_theta) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(tilt_theta), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># tilt</span></span>
<span id="cb26-27">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x_tilt =</span> z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(tilt_theta) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(tilt_theta)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-28">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x_tilt,</span>
<span id="cb26-29">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> z_tilt) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-30">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x_tilt, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>z_tilt) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-31">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x_turn =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># rotate</span></span>
<span id="cb26-32">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y_turn =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-33">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x_turn,</span>
<span id="cb26-34">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y_turn) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-35">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>x_turn, <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>y_turn) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-36">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">x =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>), <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># move</span></span>
<span id="cb26-37">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">y =</span> y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> C_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>),</span>
<span id="cb26-38">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">z =</span> z <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> L_point) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-39">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H =</span> (<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">atan2</span>(y, x) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span>pi) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">360</span>,</span>
<span id="cb26-40">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">C =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(x<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> y<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>),</span>
<span id="cb26-41">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">L =</span> z) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-42">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(L <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> L <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&amp;</span> C <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;=</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-43">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">color_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(H, C, L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixup =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-44">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(color_value)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># check if exists</span></span>
<span id="cb26-45">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">H_diff =</span> (<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> </span>
<span id="cb26-46">             <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sign</span>(H <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_point)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># H diff, check if crosses 360</span></span>
<span id="cb26-47">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">abs</span>(H_diff) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;=</span> H_bound) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># check in H bound</span></span>
<span id="cb26-48">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">filter</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">is.na</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> H_diff, C, L, <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixup =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># symmetric</span></span>
<span id="cb26-49">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">select</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">!</span>H_diff) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-50">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample_n</span>(n_points) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># sample down to desired amount</span></span>
<span id="cb26-51">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perpendicular_from_C_L =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> </span>
<span id="cb26-52">             y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>),</span>
<span id="cb26-53">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">parallel_along_C_L =</span> x <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span> </span>
<span id="cb26-54">             y <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>H_point <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span>)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-55">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sample</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">row_number</span>(), <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">n</span>()),</span>
<span id="cb26-56">           <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">col_value =</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ceiling</span>(row_value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n_points))) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%&gt;%</span></span>
<span id="cb26-57">    <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">mutate</span>(<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">row_value =</span> (row_value <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sqrt</span>(n_points)) <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>)</span>
<span id="cb26-58">}</span>
<span id="cb26-59"></span>
<span id="cb26-60">color_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_color_points</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb26-61">                                 H_point, C_point, L_point,</span>
<span id="cb26-62">                                 theta_radius, other_C_L_radius, </span>
<span id="cb26-63">                                 perpendicular_C_L_radius,</span>
<span id="cb26-64">                                 tilt_theta, H_bound)</span></code></pre></div>
</div>
<br>
<hr>
<center>
<h2 class="anchored">
Compare previous samples
</h2>
</center>
<hr>
<p>Now we can try this function with the previous values to confirm how it works.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##-------</span></span>
<span id="cb27-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Compare</span></span>
<span id="cb27-3"><span class="do" style="color: #5E5E5E;
background-color: null;
font-style: italic;">##-------</span></span>
<span id="cb27-4">H_bound <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span></span>
<span id="cb27-5">color_points_sphere <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_color_points</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb27-6">                                        H_point, C_point, L_point,</span>
<span id="cb27-7">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theta_radius =</span> radius, </span>
<span id="cb27-8">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">other_C_L_radius =</span> radius, </span>
<span id="cb27-9">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perpendicular_C_L_radius =</span> radius,</span>
<span id="cb27-10">                                        <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tilt_theta =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, H_bound)</span>
<span id="cb27-11">color_points_ellipse <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_color_points</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb27-12">                                         H_point, C_point, L_point,</span>
<span id="cb27-13">                                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">theta_radius =</span> C_radius, </span>
<span id="cb27-14">                                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">other_C_L_radius =</span> H_radius, </span>
<span id="cb27-15">                                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">perpendicular_C_L_radius =</span> L_radius,</span>
<span id="cb27-16">                                         <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">tilt_theta =</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>, H_bound)</span>
<span id="cb27-17">color_points_tilted_ellipse <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_color_points</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb27-18">                                                H_point, C_point, L_point,</span>
<span id="cb27-19">                                                theta_radius, </span>
<span id="cb27-20">                                                other_C_L_radius, </span>
<span id="cb27-21">                                                perpendicular_C_L_radius,</span>
<span id="cb27-22">                                                tilt_theta, H_bound)</span>
<span id="cb27-23"></span>
<span id="cb27-24">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_sample</span>(color_points_sphere)</span>
<span id="cb27-25">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_sample</span>(color_points_ellipse)</span>
<span id="cb27-26">p3 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_sample</span>(color_points_tilted_ellipse)</span>
<span id="cb27-27">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p3</span></code></pre></div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/compare_info.jpeg" class="img-fluid figure-img"></p>
<figcaption>Compare: Sample Points</figcaption>
</figure>
</div>
<p>Here, we can see the differences in samples based on the different parameters. By changing the parameters, we can get a variety of color sampling, even when starting with the same base point. The rest of the graphs can be created for comparing the outputs, but they aren’t that interesting since they’re just repeats of the previous image.</p>
<br>
<hr>
<center>
<h2 class="anchored">
Trying some other parameters
</h2>
</center>
<hr>
<p>Now that we have all our functions set up let’s try them out on two more examples. The first one will be on an ellipse that hits the edge.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#--------------------</span></span>
<span id="cb28-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Try some other ones</span></span>
<span id="cb28-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">#--------------------</span></span>
<span id="cb28-4"></span>
<span id="cb28-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Outside Edge ----</span></span>
<span id="cb28-6">H_point <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">63</span></span>
<span id="cb28-7">C_point <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">93</span></span>
<span id="cb28-8">L_point <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">81</span></span>
<span id="cb28-9"></span>
<span id="cb28-10">color_hex <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(H_point, </span>
<span id="cb28-11">                 C_point,</span>
<span id="cb28-12">                 L_point,</span>
<span id="cb28-13">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixup =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb28-14"></span>
<span id="cb28-15">C_L_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_C_L_plane</span>(H_point)</span>
<span id="cb28-16">H_L_curve <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_H_L_curve</span>(C_point)</span>
<span id="cb28-17">C_tangent_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_C_tangent_plane</span>(H_point, C_point)</span>
<span id="cb28-18">H_C_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_H_C_plane</span>(L_point)</span>
<span id="cb28-19"></span>
<span id="cb28-20">theta_radius <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span></span>
<span id="cb28-21">other_C_L_radius <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span></span>
<span id="cb28-22">perpendicular_C_L_radius <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb28-23"></span>
<span id="cb28-24">tilt_theta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span></span>
<span id="cb28-25">H_bound <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span></span>
<span id="cb28-26"></span>
<span id="cb28-27">color_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_color_points</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb28-28">                                 H_point, C_point, L_point,</span>
<span id="cb28-29">                                 theta_radius, other_C_L_radius, </span>
<span id="cb28-30">                                 perpendicular_C_L_radius,</span>
<span id="cb28-31">                                 tilt_theta, H_bound)</span></code></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>[Outside Edge Info Code]</summary>
<div class="sourceCode cell-code" id="cb29" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_info</span>(H_point, C_point, L_point)</span>
<span id="cb29-2">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_sample</span>(color_points)</span>
<span id="cb29-3">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/outside_edge_info.jpeg" class="img-fluid figure-img"></p>
<figcaption>Outside Edge: Base Color and Sample Points</figcaption>
</figure>
</div>
<p>The following image shows that the ellipse should go outside the bounds, but there aren’t any color values for those points. So, the ellipse is clipped off by that bound. However, the square on the right in the previous image is filled in completely. If we started with a sample of the size we wanted at the end, the clipped points would be missing. The previous image worked because the original set of points was bigger, clipped, then sampled to the desired amount.</p>
<div class="cell">
<details class="code-fold">
<summary>[C-L Plane Code]</summary>
<div class="sourceCode cell-code" id="cb30" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_L_plane</span>(C_L_plane, color_points, color_hex)</span>
<span id="cb30-2">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_L</span>(color_points)</span>
<span id="cb30-3">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/outside_edge_c_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Outside Edge: C-L Plane</figcaption>
</figure>
</div>
<p>The next few images are the same kind that we have seen previously.</p>
<div class="cell">
<details class="code-fold">
<summary>[H-L Curve Code]</summary>
<div class="sourceCode cell-code" id="cb31" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_L_curve</span>(H_L_curve, color_points, color_hex, H_point)</span>
<span id="cb31-2">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_L</span>(color_points, H_point)</span>
<span id="cb31-3">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/outside_edge_h_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Outside Edge: H-L Curve</figcaption>
</figure>
</div>
<div class="cell">
<details class="code-fold">
<summary>[C Tangent Plane Code]</summary>
<div class="sourceCode cell-code" id="cb32" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_tangent_plane</span>(C_tangent_plane, color_points, color_hex)</span>
<span id="cb32-2">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_perpendicular_from_C_L</span>(color_points)</span>
<span id="cb32-3">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/outside_edge_p_c_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Outside Edge: Plane Perpendicular to C-L Plane</figcaption>
</figure>
</div>
<div class="cell">
<details class="code-fold">
<summary>[H-C Plane Code]</summary>
<div class="sourceCode cell-code" id="cb33" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_C_plane</span>(H_C_plane, color_points, color_hex)</span>
<span id="cb33-2">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_x_y</span>(color_points, H_point)</span>
<span id="cb33-3">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/outside_edge_h_c.jpeg" class="img-fluid figure-img"></p>
<figcaption>Outside Edge: H-C Plane</figcaption>
</figure>
</div>
<p>One important detail to catch in the above image is the sharp end on the top right. This clipping occurs because we check that the image is symmetric across Hue = <code>H_point</code>. If we didn’t have that check, the right side would stretch up farther to match the boundary of the H-C Plane on the left side.</p>
<p>Finally, we can end this post with one more example. For this one, we’ll place the ellipse near the inside of the HCL color space.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Inside Edge ----</span></span>
<span id="cb34-2">H_point <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">319</span></span>
<span id="cb34-3">C_point <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span></span>
<span id="cb34-4">L_point <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">50</span></span>
<span id="cb34-5"></span>
<span id="cb34-6">color_hex <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">hcl</span>(H_point, </span>
<span id="cb34-7">                 C_point,</span>
<span id="cb34-8">                 L_point,</span>
<span id="cb34-9">                 <span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">fixup =</span> <span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">FALSE</span>)</span>
<span id="cb34-10"></span>
<span id="cb34-11">C_L_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_C_L_plane</span>(H_point)</span>
<span id="cb34-12">H_L_curve <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_H_L_curve</span>(C_point)</span>
<span id="cb34-13">C_tangent_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_C_tangent_plane</span>(H_point, C_point)</span>
<span id="cb34-14">H_C_plane <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_H_C_plane</span>(L_point)</span>
<span id="cb34-15"></span>
<span id="cb34-16">theta_radius <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">40</span></span>
<span id="cb34-17">other_C_L_radius <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span></span>
<span id="cb34-18">perpendicular_C_L_radius <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">20</span></span>
<span id="cb34-19"></span>
<span id="cb34-20">tilt_theta <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span> <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> pi<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">180</span></span>
<span id="cb34-21">H_bound <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span></span>
<span id="cb34-22"></span>
<span id="cb34-23">color_points <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">get_color_points</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">250</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">^</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>,</span>
<span id="cb34-24">                                 H_point, C_point, L_point,</span>
<span id="cb34-25">                                 theta_radius, other_C_L_radius, </span>
<span id="cb34-26">                                 perpendicular_C_L_radius,</span>
<span id="cb34-27">                                 tilt_theta, H_bound)</span></code></pre></div>
</div>
<div class="cell">
<details class="code-fold">
<summary>[Inside Edge Info Code]</summary>
<div class="sourceCode cell-code" id="cb35" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_info</span>(H_point, C_point, L_point)</span>
<span id="cb35-2">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_sample</span>(color_points)</span>
<span id="cb35-3">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/inside_edge_info.jpeg" class="img-fluid figure-img"></p>
<figcaption>Inside Edge: Base Color and Sample Points</figcaption>
</figure>
</div>
<div class="cell">
<details class="code-fold">
<summary>[C-L Plane Code]</summary>
<div class="sourceCode cell-code" id="cb36" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_L_plane</span>(C_L_plane, color_points, color_hex)</span>
<span id="cb36-2">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_L</span>(color_points)</span>
<span id="cb36-3">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/inside_edge_c_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Inside Edge: C-L Plane</figcaption>
</figure>
</div>
<p>The H-L Curve is very different from previous ones because of how close to the center the <code>C_point</code> is. Values close to the center span a larger region of Hue values than compared to points farther away to the outside, which creates a new shape.</p>
<div class="cell">
<details class="code-fold">
<summary>[H-L Curve Code]</summary>
<div class="sourceCode cell-code" id="cb37" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_L_curve</span>(H_L_curve, color_points, color_hex, H_point)</span>
<span id="cb37-2">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_L</span>(color_points, H_point)</span>
<span id="cb37-3">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/inside_edge_h_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Inside Edge: H-L Curve</figcaption>
</figure>
</div>
<div class="cell">
<details class="code-fold">
<summary>[C Tangent Plane Code]</summary>
<div class="sourceCode cell-code" id="cb38" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_C_tangent_plane</span>(C_tangent_plane, color_points, color_hex)</span>
<span id="cb38-2">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_perpendicular_from_C_L</span>(color_points)</span>
<span id="cb38-3">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/inside_edge_p_c_l.jpeg" class="img-fluid figure-img"></p>
<figcaption>Inside Edge: Plane Perpendicular to C-L Plane</figcaption>
</figure>
</div>
<p>For the final image, we can see that the H_bound cuts up the ellipse. The boundary prevents the ellipse from stretching across the HCL color space’s middle.</p>
<div class="cell">
<details class="code-fold">
<summary>[H-C Plane Code]</summary>
<div class="sourceCode cell-code" id="cb39" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1">p1 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_H_C_plane</span>(H_C_plane, color_points, color_hex)</span>
<span id="cb39-2">p2 <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">graph_x_y</span>(color_points, H_point)</span>
<span id="cb39-3">p1 <span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> p2</span></code></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/inside_edge_h_c.jpeg" class="img-fluid figure-img"></p>
<figcaption>Inside Edge: H-C Plane</figcaption>
</figure>
</div>
<hr>
<p>There are a few options to continue this work further. This code uses the <code>tidyverse</code> with many <code>mutate</code> steps, but it can be done squished together or done with matrix multiplication/other more efficient techniques. There are also different parameterizations, such as the two foci for an ellipse. There could also be options for other clipping or not including some of the current clipping (like keeping symmetric across <code>H_point</code>).</p>



 ]]></description>
  <category>R</category>
  <category>Generative Art</category>
  <guid>https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/</guid>
  <pubDate>Mon, 09 Aug 2021 04:00:00 GMT</pubDate>
  <media:content url="https://www.williamtylerbradley.com/posts/2021-08-09-choosing-nearby-colors-part-1/h_c_plane.jpeg" medium="image" type="image/jpeg"/>
</item>
<item>
  <title>SQL Server’s Machine Learning Services Presentation</title>
  <link>https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/</link>
  <description><![CDATA[ 





<p>This post is a write-up on a presentation I gave last year. You can check out the project on Github <a href="https://github.com/WilliamTylerBradley/sql_server_mls_presentation">here</a> or go <a href="https://williamtylerbradley.github.io/sql_server_mls_presentation/sql_server_mls_presentation.html">here</a> and press ‘s’ to get speaker notes.</p>
<div id="slide_1" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_1.png" class="img-fluid"></p>
</div>
<p>I initially gave this presentation in November 2020 for the Asheville SQL Meetup. It covers the basics of SQL Server’s Machine Learning Services. Hopefully, it provides enough information to help people decide if this tech is a good solution for them.</p>
</div>
<div id="slide_2" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_2.png" class="img-fluid"></p>
</div>
<p>This presentation covers some background on Machine Learning Services, like what it is and why you would want to use it. There’s a demo section that showcases three different ways to use R in production with SQL Server. Finally, there’s a section for some tips and tricks that helped me when I set up and use this tech.</p>
</div>
<div id="slide_3" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_3.png" class="img-fluid"></p>
</div>
<p>The first section is just on the background.</p>
</div>
<div id="slide_4" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_4.png" class="img-fluid"></p>
</div>
<p>Machine Learning Services is a SQL Server feature that allows you to bring analytics into the database by running the analytics programming language in-database. It first started in 2016 with R and later added Python support. Some old documentation will call it R services because that was the name before adding Python. This is not a standalone server. It’s a regular SQL Server with added features. There is another option for a standalone server. That might be a better choice for your needs, but we’ll not cover that in this presentation.</p>
</div>
<div id="slide_5" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_5.png" class="img-fluid"></p>
</div>
<p>If you’re wondering if this would be a good addition to your tech stack, here are some excellent use cases: forecasting next month’s revenue, customer churn to predict when types of customers are mostly like to leave, and finding potential fraud in claims data. Basically, anything that is a best guess or probability. It’s not for pulling data or summaries. You can do that, but it won’t be better than using SQL typically. You can do some predictive modeling with just SQL, but usually, using R or Python has more features and is easier to use. Also, for this presentation, when I say ‘model’, I’m talking about a predictive or statistical model, not a data model that’s commonly used in SQL settings.</p>
</div>
<div id="slide_6" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_6.png" class="img-fluid"></p>
</div>
<p>Speeding up predictive model processing is the main reason to add this tech. By bringing the analysis to the data, you don’t have to move large data sets out of SQL Server to get the results you need. This can cut out a huge amount of time and processing power. You get to utilize SQL for the data prep and R or Python for the analysis. This brings you the best of both worlds. SQL tends to be a lot more stable and optimized for data prep, while R and Python can handle the large machine learning models that would too difficult to code in SQL. Also, Machine Learning Services outputs within SQL Server, which is easily used for reporting or an ETL.</p>
</div>
<div id="slide_7" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_7.png" class="img-fluid"></p>
</div>
<p>This setup also allows you to have clean analytics projects in production. There’s no need for large wonky code sets to get everything glued together. You can use all the standard SQL objects, like stored procedures and jobs. So, you don’t need another tool for scheduling or error reporting. There is less pipeline work since you’re not moving data in and out of SQL Server. So there are fewer ETLs, permissions issues, and other places for things to break.</p>
<p>I think the addition of ‘fewer things to break’ for this work is an important selling point. If you’re adding in tech, then you’re also adding in more options for failure. That’s made up for to get the predictive modeling capabilities but reducing all the other code helps put this option ahead of other predictive modeling tools. There are a variety of setups, but you can pick a specific one for your team or organization. The flexibility is nice, so this tool works for most companies. Then when you get a setup for your team, you can set standards, so everything follows a pattern for documentation and code.</p>
</div>
<div id="slide_8" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_8.png" class="img-fluid"></p>
</div>
<p>This tech is a great setup because it can ease collaboration between data scientists and DBAs. It utilizes SQL permissions. So no one needs to learn a new setup for that, and it can fit nicely into your current structure. It has Microsoft-approved security. You’re not bringing in unvalidated software on your server. And it has options for resource controls. If you’re worried about data science work taking over everything, you can put up gates to prevent that. As a side note, I’ve never needed to use this feature. Most resource-intensive data science work happens during development, not running them in production, and I build the models in a different environment.</p>
</div>
<div id="slide_9" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_9.png" class="img-fluid"></p>
</div>
<p>The real-time analysis can be too slow. We’ll compare different options during the demo section, so you’ll see the fast ones. If you can wait a few seconds to return results or run everything in a batch the night before you need them, you’re good to go. If machine learning services are too slow, then SQL Server is probably too slow.</p>
<p>The big data operations can be too small. This is more of a limitation of SQL Server again. Depending on your data size, this might not be big enough, but then SQL Server is probably not the right tool anyways.</p>
<p>This doesn’t work as well with Power BI and other interfaces as you might expect, especially for interactivity. If you can’t run a stored procedure or run all the options before pulling out the data, you’ll have a lot of limitations here.</p>
</div>
<div id="slide_10" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_10.png" class="img-fluid"></p>
</div>
<p>When you’re planning out setting this up, there are a few things to figure out. You should have some idea of the roles you want involved. Machine learning services gives teams a whole spectrum of responsibilities that can be used to set expectations and tasks between DBAs and data scientist. So, you can have a setup with a ton of DBA involvement or very little work, depending on what you want at your company. You’ll want to know about the use cases you’ll have. In the demo section, we’ll walk through a few options. Determining which setup is best for your team is pretty much determined by your use cases. The number of people involved can also play a factor. You can easily interfere with other people’s work if you’re not careful, so some setups are better with larger teams. Overall, there is a lot of flexibility but no strong consensus on how to use this tech.</p>
</div>
<div id="slide_11" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_11.png" class="img-fluid"></p>
</div>
<p>Now for the demo section.</p>
</div>
<div id="slide_12" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_12.png" class="img-fluid"></p>
</div>
<p>You need to have SQL Server installed first. I’m using the 2017 Developer Edition. You’ll go through normal installation for most of this. (https://www.microsoft.com/en-us/sql-server/sql-server-2017 - ‘Free download’ link near the bottom)</p>
</div>
<div id="slide_13" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_13.png" class="img-fluid"></p>
</div>
<p>The main catch is making sure to check the boxes for Machine Learning Services (In-Database). You can pick R, Python, or both.</p>
<p>Do not pick Machine Learning Server (Standalone). That’s a different product.</p>
</div>
<div id="slide_14" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_14.png" class="img-fluid"></p>
</div>
<p>You’ll go through a few more options and restarts. You can test that it’s working with a little ‘Hello World’ script.</p>
</div>
<div id="slide_15" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_15.png" class="img-fluid"></p>
</div>
<p>The primary function you’ll use is sp_execute_external_script. It’s the way to access an external language. There are a bunch of parameters. The specific language (R or Python). The actual script to run. The input data set. The output data that gets returned. And a lot of other options too.</p>
</div>
<div id="slide_16" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_16.png" class="img-fluid"></p>
</div>
<p>For a big disclaimer. I’ll run some code that creates predictive models, but I’m taking a lot of shortcuts. I’m not working through choosing a model, testing, and checking. I’m just getting a small model setup for the demo. The SQL objects and functions are fine to use. That’s the main focus of this presentation and can be adapted very easily for your company.</p>
</div>
<div id="slide_17" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_17.png" class="img-fluid"></p>
</div>
<p>– run 1_set_up_checks.sql</p>
<p><br> <br> <br> <br> <br> <br> <br> <br> <br></p>
</div>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/* EXEC sp_configure  'external scripts enabled', 1</span></span>
<span id="cb1-2"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">RECONFIGURE WITH OVERRIDE */</span></span>
<span id="cb1-3"></span>
<span id="cb1-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- EXECUTE sp_configure  'external scripts enabled'</span></span>
<span id="cb1-5"></span>
<span id="cb1-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">EXEC</span> sp_execute_external_script  @language <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'R'</span>,</span>
<span id="cb1-7"><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">@script = N'</span></span>
<span id="cb1-8">OutputDataSet <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> InputDataSet;</span>
<span id="cb1-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">',</span></span>
<span id="cb1-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">@input_data_1 = N'</span>SELECT <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">AS</span> hello<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb1-11"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">WITH RESULT SETS (([hello] int not null));</span></span>
<span id="cb1-12"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">GO</span></span>
<span id="cb1-13"></span>
<span id="cb1-14"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">-- Check Version</span></span>
<span id="cb1-15"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">EXECUTE sp_execute_external_script @language = N'</span>R<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb1-16"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    , @script = N'</span>print(version)<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">';</span></span>
<span id="cb1-17"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">GO</span></span>
<span id="cb1-18"></span>
<span id="cb1-19"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">-- R Packages</span></span>
<span id="cb1-20"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">EXEC sp_execute_external_script @language = N'</span>R<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb1-21"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    , @script = N'</span></span>
<span id="cb1-22">OutputDataSet <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&lt;-</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">data</span>.frame(installed.<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">packages</span>()[,c(<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">"Package"</span>, <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">"Version"</span>, <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">"Depends"</span>, <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">"License"</span>, <span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">"LibPath"</span>)]);<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb1-23"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">WITH result sets((</span></span>
<span id="cb1-24"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            Package NVARCHAR(255)</span></span>
<span id="cb1-25"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            , Version NVARCHAR(100)</span></span>
<span id="cb1-26"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            , Depends NVARCHAR(4000)</span></span>
<span id="cb1-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            , License NVARCHAR(1000)</span></span>
<span id="cb1-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            , LibPath NVARCHAR(2000)</span></span>
<span id="cb1-29"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            ));</span></span></code></pre></div>
<p>This shows that everything looks good.</p>
<p>– run 2_create_mtcars.sql</p>
<div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb2-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- mtcars database</span></span>
<span id="cb2-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">CREATE</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">TABLE</span> dbo.mtcars(</span>
<span id="cb2-3">    mpg <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">decimal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NOT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NULL</span>,</span>
<span id="cb2-4">    cyl <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NOT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NULL</span>,</span>
<span id="cb2-5">    disp <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">decimal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NOT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NULL</span>,</span>
<span id="cb2-6">    hp <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NOT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NULL</span>,</span>
<span id="cb2-7">    drat <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">decimal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NOT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NULL</span>,</span>
<span id="cb2-8">    wt <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">decimal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NOT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NULL</span>,</span>
<span id="cb2-9">    qsec <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">decimal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NOT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NULL</span>,</span>
<span id="cb2-10">    vs <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NOT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NULL</span>,</span>
<span id="cb2-11">    am <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NOT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NULL</span>,</span>
<span id="cb2-12">    gear <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NOT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NULL</span>,</span>
<span id="cb2-13">    carb <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NOT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NULL</span></span>
<span id="cb2-14">);</span>
<span id="cb2-15"></span>
<span id="cb2-16"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">INSERT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">INTO</span> dbo.mtcars</span>
<span id="cb2-17"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">EXEC</span> sp_execute_external_script @language <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'R'</span></span>
<span id="cb2-18">    , @script <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'MTCars &lt;- mtcars;'</span></span>
<span id="cb2-19">    , @input_data_1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span></span>
<span id="cb2-20">    , @output_data_1_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'MTCars'</span>;</span>
<span id="cb2-21"></span>
<span id="cb2-22"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">SELECT</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">FROM</span> dbo.mtcars;</span>
<span id="cb2-23"></span>
<span id="cb2-24"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--DROP TABLE dbo.mtcars;</span></span></code></pre></div>
<p>This builds out a test data set for us to use.</p>
<p>– run 3_mtcars_sql.sql</p>
<div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb3-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- Input data set</span></span>
<span id="cb3-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">SELECT</span> mpg, cyl, hp, wt <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">FROM</span> dbo.mtcars;</span>
<span id="cb3-3"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- 1974 Motor Trends</span></span>
<span id="cb3-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- miles per gallon</span></span>
<span id="cb3-5"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- number of cylinders</span></span>
<span id="cb3-6"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- horse power</span></span>
<span id="cb3-7"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- weight (1000 lbs)</span></span>
<span id="cb3-8"></span>
<span id="cb3-9"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- Build the model -----------------------------------------------------------------------</span></span>
<span id="cb3-10"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">EXEC</span> sp_execute_external_script</span>
<span id="cb3-11">    @language <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'R'</span></span>
<span id="cb3-12">    , @script <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cars_model &lt;- lm(mpg ~ cyl + hp + wt, data = mtcars_data);</span></span>
<span id="cb3-13"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        trained_model &lt;- data.frame(model = as.raw(serialize(cars_model, connection=NULL)));'</span></span>
<span id="cb3-14">    , @input_data_1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'SELECT mpg, cyl, hp, wt FROM dbo.mtcars'</span></span>
<span id="cb3-15">    , @input_data_1_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mtcars_data'</span></span>
<span id="cb3-16">    , @output_data_1_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'trained_model'</span></span>
<span id="cb3-17">    <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">WITH</span> RESULT SETS ((model VARBINARY(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>)))</span>
<span id="cb3-18"></span>
<span id="cb3-19"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">CREATE</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">TABLE</span> predictive_models (</span>
<span id="cb3-20">    model_name <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">varchar</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">null</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">default</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'default model'</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">primary</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">key</span>,</span>
<span id="cb3-21">    model varbinary(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">not</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">null</span></span>
<span id="cb3-22">);</span>
<span id="cb3-23"></span>
<span id="cb3-24"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">INSERT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">INTO</span> predictive_models(model)</span>
<span id="cb3-25"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">EXEC</span> sp_execute_external_script</span>
<span id="cb3-26">    @language <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'R'</span></span>
<span id="cb3-27">    , @script <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'cars_model &lt;- lm(mpg ~ cyl + hp + wt, data = mtcars_data);</span></span>
<span id="cb3-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">        trained_model &lt;- data.frame(model = as.raw(serialize(cars_model, connection=NULL)));'</span></span>
<span id="cb3-29">    , @input_data_1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'SELECT mpg, cyl, hp, wt FROM MTCars'</span></span>
<span id="cb3-30">    , @input_data_1_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mtcars_data'</span></span>
<span id="cb3-31">    , @output_data_1_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'trained_model'</span>;</span>
<span id="cb3-32"></span>
<span id="cb3-33"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">SELECT</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">FROM</span> [<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">master</span>].[dbo].[predictive_models];</span>
<span id="cb3-34"></span>
<span id="cb3-35"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">UPDATE</span> predictive_models</span>
<span id="cb3-36"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">SET</span> model_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lm_'</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> format(getdate(), <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'dd-MM-yy'</span>)</span>
<span id="cb3-37"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">WHERE</span> model_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'default model'</span></span>
<span id="cb3-38"></span>
<span id="cb3-39"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">SELECT</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">FROM</span> [<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">master</span>].[dbo].[predictive_models];</span>
<span id="cb3-40"></span>
<span id="cb3-41"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--DROP TABLE dbo.predictive_models;</span></span>
<span id="cb3-42"></span>
<span id="cb3-43"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- Run model ---------------------------------------------------------------------------</span></span>
<span id="cb3-44"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">DECLARE</span> @selected_lmmodel varbinary(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> </span>
<span id="cb3-45">    (<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">SELECT</span> model <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">FROM</span> dbo.predictive_models <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">WHERE</span> model_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lm_17-11-20'</span>);</span>
<span id="cb3-46"></span>
<span id="cb3-47"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">EXEC</span> sp_execute_external_script</span>
<span id="cb3-48">    @language <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'R'</span></span>
<span id="cb3-49">    , @script <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb3-50"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            current_model &lt;- unserialize(as.raw(lmmodel));</span></span>
<span id="cb3-51"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            new &lt;- data.frame(mtcars_data);</span></span>
<span id="cb3-52"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            predicted.am &lt;- predict(current_model, new);</span></span>
<span id="cb3-53"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            str(predicted.am);</span></span>
<span id="cb3-54"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            OutputDataSet &lt;- cbind(new, predicted.am);</span></span>
<span id="cb3-55"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            '</span></span>
<span id="cb3-56">    , @input_data_1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'SELECT cyl, hp, wt FROM dbo.mtcars'</span></span>
<span id="cb3-57">    , @input_data_1_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mtcars_data'</span></span>
<span id="cb3-58">    , @params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'@lmmodel varbinary(max)'</span></span>
<span id="cb3-59">    , @lmmodel <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> @selected_lmmodel</span>
<span id="cb3-60"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">WITH</span> RESULT SETS ((cyl <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">INT</span>, hp <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">INT</span>, wt <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">DECIMAL</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), predicted_mpg <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">DECIMAL</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)));</span></code></pre></div>
<p>This builds a model, saves it to a new table, and scores data with the new model. You can add more models to this table or update the existing ones. This is the most basic setup. Everything’s pretty much kept in SQL Server with basic functionalities.</p>
<div id="slide_18" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_18.png" class="img-fluid"></p>
</div>
<p>There is an option for Native Scoring. This doesn’t use the overhead of R and Python but uses another format. The trade-off is there is a smaller list of possible models, but these are the most common. You’ll use RevoScaleR or revoscalepy, depending on if you’re using R or Python. The main function here is PREDICT. So look for that in the code. (Open Neural Network Exchange (ONNX))</p>
</div>
<div id="slide_19" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_19.png" class="img-fluid"></p>
</div>
<p>– run 4_mtcars_nativescoring.sql</p>
<p><br> <br> <br> <br> <br> <br> <br> <br> <br></p>
</div>
<div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb4-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- Input data set</span></span>
<span id="cb4-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">SELECT</span> mpg, cyl, hp, wt <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">FROM</span> dbo.mtcars;</span>
<span id="cb4-3"></span>
<span id="cb4-4"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- Build the model -----------------------------------------------------------------------</span></span>
<span id="cb4-5"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">DECLARE</span> @model varbinary(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>);</span>
<span id="cb4-6"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">EXECUTE</span> sp_execute_external_script</span>
<span id="cb4-7">  @language <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'R'</span></span>
<span id="cb4-8">  , @script <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb4-9"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    cars_model &lt;- rxLinMod(mpg ~ cyl + hp + wt, data = mtcars_data)</span></span>
<span id="cb4-10"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">    model &lt;- rxSerializeModel(cars_model, realtimeScoringOnly = TRUE)'</span></span>
<span id="cb4-11">  , @input_data_1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'SELECT mpg, cyl, hp, wt FROM dbo.mtcars'</span></span>
<span id="cb4-12">  , @input_data_1_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mtcars_data'</span></span>
<span id="cb4-13">  , @params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'@model varbinary(max) OUTPUT'</span></span>
<span id="cb4-14">  , @model <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> @model OUTPUT</span>
<span id="cb4-15">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">INSERT</span> [dbo].[predictive_models]([model_name], [model])</span>
<span id="cb4-16">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">VALUES</span>(<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'native_scoring'</span>, @model) ;</span>
<span id="cb4-17"></span>
<span id="cb4-18"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">SELECT</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">FROM</span> [<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">master</span>].[dbo].[predictive_models];</span>
<span id="cb4-19"></span>
<span id="cb4-20"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--DROP TABLE dbo.predictive_models;</span></span>
<span id="cb4-21"></span>
<span id="cb4-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- Run model ---------------------------------------------------------------------------</span></span>
<span id="cb4-23"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">DECLARE</span> @model varbinary(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb4-24">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">SELECT</span> model</span>
<span id="cb4-25">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">FROM</span> [<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">master</span>].[dbo].[predictive_models]</span>
<span id="cb4-26">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">WHERE</span> model_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'native_scoring'</span>);</span>
<span id="cb4-27"></span>
<span id="cb4-28"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">SELECT</span> d.<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>, p.<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb4-29">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">FROM</span> PREDICT(MODEL <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> @model, <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">DATA</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dbo.mtcars <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">as</span> d)</span>
<span id="cb4-30">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">WITH</span>(mpg_Pred <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">float</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">as</span> p;</span>
<span id="cb4-31"></span>
<span id="cb4-32"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--DROP TABLE dbo.predictive_models;</span></span></code></pre></div>
<p>This builds the model, adds it to the table, and scores some data. You can see it is very similar to the other setup.</p>
<div id="slide_20" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_20.png" class="img-fluid"></p>
</div>
<p>The last way to run a model in production I’ll talk about is using an R package. R packages are a pretty common mechanism to wrap up a lot of R code. You’ll see them for almost everything. This provides the most separation between R and SQL by wrapping up most of the R code in the package then using SQL to pass data to it. You can make changes to the package to change the model instead of changing any SQL code. You’ll just need to use an ALTER statement to update it. This is probably the cleanest route for when a lot of R code needs to run.</p>
</div>
<div id="slide_21" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_21.png" class="img-fluid"></p>
</div>
<p>When you’re creating a model to use in a package, there might be some versioning issues. Using these settings might resolve them.</p>
</div>
<div id="slide_22" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_22.png" class="img-fluid"></p>
</div>
<p>– run 5_mtcars_rpackage.sql</p>
<p><br> <br> <br> <br> <br> <br> <br> <br> <br></p>
</div>
<div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb5-1"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">CREATE</span> EXTERNAL <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">LIBRARY</span> mtcarsmodel</span>
<span id="cb5-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">FROM</span> (CONTENT <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mtcarsmodel_0.1.0.zip'</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">WITH</span> (LANGUAGE <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'R'</span>); <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--pull from GitHub</span></span>
<span id="cb5-3"></span>
<span id="cb5-4"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">EXEC</span> sp_execute_external_script @language <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'R'</span></span>
<span id="cb5-5">    , @script <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb5-6"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">OutputDataSet &lt;- data.frame(installed.packages()[,c("Package", "Version", "Depends", "License", "LibPath")]);'</span></span>
<span id="cb5-7"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">WITH</span> result sets((</span>
<span id="cb5-8">            <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">Package</span> <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">NVARCHAR</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">255</span>)</span>
<span id="cb5-9">            , Version <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">NVARCHAR</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">100</span>)</span>
<span id="cb5-10">            , Depends <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">NVARCHAR</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">4000</span>)</span>
<span id="cb5-11">            , License <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">NVARCHAR</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span>)</span>
<span id="cb5-12">            , LibPath <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">NVARCHAR</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2000</span>)</span>
<span id="cb5-13">            ));</span>
<span id="cb5-14"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- !!! </span><span class="al" style="color: #AD0000;
background-color: null;
font-style: inherit;">NOTE</span><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"> THE DIFFERENT LIBPATH !!! ---</span></span>
<span id="cb5-15"></span>
<span id="cb5-16"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- DROP EXTERNAL LIBRARY mtcarsmodel;</span></span>
<span id="cb5-17"></span>
<span id="cb5-18"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">EXEC</span> sp_execute_external_script </span>
<span id="cb5-19"><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">@language =N'R', </span></span>
<span id="cb5-20"><span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">@script=N'library(mtcarsmodel)';</span></span>
<span id="cb5-21"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- Note the warning message about R 4.0.0</span></span>
<span id="cb5-22"></span>
<span id="cb5-23"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- Run model ---------------------------------------------------------------------------</span></span>
<span id="cb5-24"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">EXEC</span> sp_execute_external_script</span>
<span id="cb5-25">    @language <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'R'</span></span>
<span id="cb5-26">    , @script <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb5-27"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            library(mtcarsmodel)</span></span>
<span id="cb5-28"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            OutputDataSet &lt;- mtcarsmodel::predict_mtcars(mtcars_data);'</span></span>
<span id="cb5-29">    , @input_data_1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'SELECT cyl, hp, wt FROM dbo.mtcars'</span></span>
<span id="cb5-30">    , @input_data_1_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mtcars_data'</span></span>
<span id="cb5-31"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">WITH</span> RESULT SETS ((cyl <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">INT</span>, hp <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">INT</span>, wt <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">DECIMAL</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), predicted_mpg <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">DECIMAL</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>)));</span></code></pre></div>
<p>–(Make sure to have the package pulled from GitHub and saved in as a zipfile.)</p>
<p>This code uploads an R package that contains a pre-built model. It then uses machine learning services to score data with that package.</p>
<div id="slide_23" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_23.png" class="img-fluid"></p>
</div>
<p>– run 6_mt_cars_big.sql</p>
<p><br> <br> <br> <br> <br> <br> <br> <br> <br></p>
</div>
<div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb6-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- mtcars big table</span></span>
<span id="cb6-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">CREATE</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">TABLE</span> dbo.mtcars_big(</span>
<span id="cb6-3">    mpg <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">decimal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NOT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NULL</span>,</span>
<span id="cb6-4">    cyl <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NOT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NULL</span>,</span>
<span id="cb6-5">    disp <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">decimal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NOT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NULL</span>,</span>
<span id="cb6-6">    hp <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NOT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NULL</span>,</span>
<span id="cb6-7">    drat <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">decimal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NOT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NULL</span>,</span>
<span id="cb6-8">    wt <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">decimal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NOT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NULL</span>,</span>
<span id="cb6-9">    qsec <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">decimal</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NOT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NULL</span>,</span>
<span id="cb6-10">    vs <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NOT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NULL</span>,</span>
<span id="cb6-11">    am <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NOT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NULL</span>,</span>
<span id="cb6-12">    gear <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NOT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NULL</span>,</span>
<span id="cb6-13">    carb <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">int</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NOT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">NULL</span></span>
<span id="cb6-14">);</span>
<span id="cb6-15"></span>
<span id="cb6-16"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">INSERT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">INTO</span> dbo.mtcars_big</span>
<span id="cb6-17"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">EXEC</span> sp_execute_external_script @language <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'R'</span></span>
<span id="cb6-18">    , @script <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'MTCars &lt;- mtcars[sample(1:nrow(mtcars), 1000000, replace = TRUE), ];'</span></span>
<span id="cb6-19">    , @input_data_1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">''</span></span>
<span id="cb6-20">    , @output_data_1_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'MTCars'</span>;</span>
<span id="cb6-21"></span>
<span id="cb6-22"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--DROP TABLE dbo.mtcars_big;</span></span>
<span id="cb6-23"></span>
<span id="cb6-24"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">CREATE</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">TABLE</span> #mtcars_big_predictions (</span>
<span id="cb6-25">    cyl <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">INT</span>, </span>
<span id="cb6-26">    hp <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">INT</span>, </span>
<span id="cb6-27">    wt <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">DECIMAL</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">10</span>, <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>), </span>
<span id="cb6-28">    mpg_Pred <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">FLOAT</span>)</span>
<span id="cb6-29"></span>
<span id="cb6-30"></span>
<span id="cb6-31"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/* SQL */</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-------------------------------------------------------------------------------------------      </span></span>
<span id="cb6-32"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">DECLARE</span> @lmmodel varbinary(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> </span>
<span id="cb6-33">    (<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">SELECT</span> model <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">FROM</span> dbo.predictive_models <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">WHERE</span> model_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'lm_17-11-20'</span>); <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- MAKE SURE TO CHANGE THE MODEL NAME</span></span>
<span id="cb6-34"></span>
<span id="cb6-35"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">INSERT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">INTO</span> #mtcars_big_predictions</span>
<span id="cb6-36"></span>
<span id="cb6-37"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">EXEC</span> sp_execute_external_script</span>
<span id="cb6-38">    @language <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'R'</span></span>
<span id="cb6-39">    , @script <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb6-40"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            current_model &lt;- unserialize(as.raw(lmmodel));</span></span>
<span id="cb6-41"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            new &lt;- data.frame(mtcars_data);</span></span>
<span id="cb6-42"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            predicted.am &lt;- predict(current_model, new, type = "response");</span></span>
<span id="cb6-43"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            str(predicted.am);</span></span>
<span id="cb6-44"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            OutputDataSet &lt;- cbind(new, predicted.am);</span></span>
<span id="cb6-45"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            '</span></span>
<span id="cb6-46">    , @input_data_1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'SELECT cyl, hp, wt FROM dbo.mtcars_big'</span></span>
<span id="cb6-47">    , @input_data_1_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mtcars_data'</span></span>
<span id="cb6-48">    , @params <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'@lmmodel varbinary(max)'</span></span>
<span id="cb6-49">    , @lmmodel <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> @lmmodel;</span>
<span id="cb6-50"></span>
<span id="cb6-51"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- Seconds: 16</span></span>
<span id="cb6-52"></span>
<span id="cb6-53"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- check results </span></span>
<span id="cb6-54"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">SELECT</span> TOP <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">FROM</span> #mtcars_big_predictions;</span>
<span id="cb6-55"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">TRUNCATE</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">TABLE</span> #mtcars_big_predictions;</span>
<span id="cb6-56"></span>
<span id="cb6-57"></span>
<span id="cb6-58"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/* Native Scoring */</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-------------------------------------------------------------------------------------------</span></span>
<span id="cb6-59"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">DECLARE</span> @model varbinary(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">max</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (</span>
<span id="cb6-60">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">SELECT</span> model</span>
<span id="cb6-61">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">FROM</span> [<span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">master</span>].[dbo].[predictive_models]</span>
<span id="cb6-62">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">WHERE</span> model_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> <span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'native_scoring'</span>);</span>
<span id="cb6-63"></span>
<span id="cb6-64"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">INSERT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">INTO</span> #mtcars_big_predictions</span>
<span id="cb6-65"></span>
<span id="cb6-66"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">SELECT</span> d.cyl, d.hp, d.wt, p.<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span></span>
<span id="cb6-67">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">FROM</span> PREDICT(MODEL <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> @model, <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">DATA</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> dbo.mtcars_big <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">as</span> d)</span>
<span id="cb6-68">  <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">WITH</span>(mpg_Pred <span class="dt" style="color: #AD0000;
background-color: null;
font-style: inherit;">float</span>) <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">as</span> p;</span>
<span id="cb6-69"></span>
<span id="cb6-70"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- Seconds: 8</span></span>
<span id="cb6-71"></span>
<span id="cb6-72"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- check results </span></span>
<span id="cb6-73"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">SELECT</span> TOP <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">FROM</span> #mtcars_big_predictions;</span>
<span id="cb6-74"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">TRUNCATE</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">TABLE</span> #mtcars_big_predictions;</span>
<span id="cb6-75"></span>
<span id="cb6-76"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/* R Package */</span> <span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">---------------------------------------------------------------------------------------------</span></span>
<span id="cb6-77"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">INSERT</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">INTO</span> #mtcars_big_predictions</span>
<span id="cb6-78"></span>
<span id="cb6-79"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">EXEC</span> sp_execute_external_script</span>
<span id="cb6-80">    @language <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'R'</span></span>
<span id="cb6-81">    , @script <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'</span></span>
<span id="cb6-82"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            library(mtcarsmodel)</span></span>
<span id="cb6-83"><span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">            OutputDataSet &lt;- mtcarsmodel::predict_mtcars(mtcars_data);'</span></span>
<span id="cb6-84">    , @input_data_1 <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'SELECT cyl, hp, wt FROM dbo.mtcars_big'</span></span>
<span id="cb6-85">    , @input_data_1_name <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> N<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">'mtcars_data'</span>;</span>
<span id="cb6-86"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">--WITH RESULT SETS ((cyl INT, hp INT, wt DECIMAL(10, 2), predicted_mpg DECIMAL(10, 2)));</span></span>
<span id="cb6-87"></span>
<span id="cb6-88"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- Seconds: 14</span></span>
<span id="cb6-89"></span>
<span id="cb6-90"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- check results </span></span>
<span id="cb6-91"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">SELECT</span> TOP <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1000</span> <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">FROM</span> #mtcars_big_predictions;</span>
<span id="cb6-92"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">TRUNCATE</span> <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">TABLE</span> #mtcars_big_predictions;</span>
<span id="cb6-93"></span>
<span id="cb6-94"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- DROP TABLE dbo.mtcars_big;</span></span>
<span id="cb6-95"></span>
<span id="cb6-96"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-- Try this with clearing cache</span></span></code></pre></div>
<p>This code builds out a bigger data set to see run time comparisons. It’s good for a lot of batch analytics, and the native scoring is the best.</p>
<div id="slide_24" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_24.png" class="img-fluid"></p>
</div>
<p>Now for the tips and tricks section.</p>
</div>
<div id="slide_25" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_25.png" class="img-fluid"></p>
</div>
<p>Small catches and errors will definitely be the most painful part. You’ll hit a lot of minor mistakes the first time you try to get something working. Here are a few to watch out for in your work. R and Python are case-sensitive. So the input data names have to match exactly, unlike SQL. Input/output formats can trouble. This includes the number of columns, names, and data types. R, Python, and SQL Server have slightly different data types. So, you might hit a weird issue, especially with conversions. Error messaging can be cloudy at best. You’ll get a lot of weird messages that are either a downstream effect of the real problem or are just some esoteric response. You can get this if there’s something wrong in the R code, but you’ll get the final issue as a SQL problem.</p>
<p>There is also a whole world of versioning that we won’t get to in this presentation. You’ll need to look into upgrading versions of Machine Learning Services. Probably choose something using miniCran, R Open, and the checkpoint package. Finally, you’ll need to figure out any dependencies for the packages of predictive models you might have. The tech on the last bullet point can help you out here.</p>
</div>
<div id="slide_26" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_26.png" class="img-fluid"></p>
</div>
<p>A lot of documentation and blog posts are hit or miss because they deal with outdated practices or features that don’t work with your setup. If you search around enough, you will find some help eventually though.</p>
<p>You can use all the standard SQL objects/tools. Everything can be wrapped up in a stored procedure, which can be very nice. You can save and update models in a temporal table to compare model performance over time. And you can use a separate for all models or a different database for each project to keep data pulls, reference tables, and outputs altogether.</p>
</div>
<div id="slide_27" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_27.png" class="img-fluid"></p>
</div>
<p>Make sure to write documentation as you go. Then at the end, delete the setup and restart following the documentation. You’ll probably want to delete and restart several times. There will be little catches you’ll need to remember later, and having them written down will save you.</p>
<p>I like to script everything. I find it easier for reproducibility and to pass off stuff to coworkers. If you mainly have an R shop, the sqlmlutils package will be helpful. If you’re mainly SQL, you can use standard SQL code for everything. At my job, everything gets passed off to another developer for putting models on our production server. I’ve got scripts that pick up the R packages, place them in the right spot, and test everything.</p>
</div>
<div id="slide_28" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_28.png" class="img-fluid"></p>
</div>
<p>Lastly, sometimes in development Machine Learning Services will stop working. The main place to check is restarting the launchpad. This will fix it most of the time. There’s nothing really special about this slide. Just to know to do this because you’ll almost definitely run into this issue.</p>
</div>
<div id="slide_29" style="clear: both;">
<div class="presentation_slide">
<p><img src="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_29.png" class="img-fluid"></p>
</div>
</div>



 ]]></description>
  <category>R</category>
  <category>SQL</category>
  <category>Presentations</category>
  <guid>https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/</guid>
  <pubDate>Mon, 28 Jun 2021 04:00:00 GMT</pubDate>
  <media:content url="https://www.williamtylerbradley.com/posts/2021-06-28-sql-server-machine-learning-services-presentation/slide_1.png" medium="image" type="image/png" height="105" width="144"/>
</item>
<item>
  <title>GENUARY 2021</title>
  <link>https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/</link>
  <description><![CDATA[ 





<p>This post goes through my experience of using R for <a href="https://genuary2021.github.io/">GENUARY 2021</a>. GENUARY is a set of daily prompts for generative art. It was a challenge, but I got a lot of it.</p>
<p>The three main takeaways from my experience are:</p>
<ol type="1">
<li><p>Having a ‘times-up-step-away-from-the-keyboard’ attitude was vital for getting me through this project. Unfortunately, several works ended up unfinished for what I wanted, and there are probably bugs left in the code. Normally I hate that, but time-based stopping surprisingly set up a good attitude the next day. Having a plan to avoid burn-out is a necessity (like GENUARY warns).</p></li>
<li><p>Going wide instead of deep was great for the first GENUARY. I tried as many new packages, programming techniques, and art styles as I could. I’ll mark the packages on at least the first day throughout this post. The R community’s numerous packages and blogposts are incredibly helpful.</p></li>
<li><p><code>ggplot2</code> is amazing to use. This package saves an incredible amount of time. I have an advantage from previous experience, but it is so easy to wrap up a lot of data prep into something nice.</p></li>
</ol>
<p>You can check out the code <a href="https://github.com/WilliamTylerBradley/genuary2021">here</a>.</p>
<section id="jan.1-triple-nested-loop" class="level1">
<h1>JAN.1 // TRIPLE NESTED LOOP</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>I started out avoiding for loops (spoiler alert: used on day three). So for this one, I created a double nested tibble to get three layers. The first layer lists coefficients and standard deviations to generate data for a regression. The number of observations and then the raw data are the final two layers. The code runs through linear models for each data set. The output graphs the number of observations on the y axis, the estimated coefficient on x, and the summary statistic for sigma as the size. Color also maps to x. The effect isn’t a complicated picture, but I do like the bubbling up action. I used <code>dplyr</code>, <code>purrr</code>, <code>tidyr</code>, and <code>ggplot2</code>.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_01.png" class="img-fluid figure-img"></p>
<figcaption>JAN_01</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.2-rule-30-elementary-cellular-automaton" class="level1">
<h1>JAN.2 Rule 30 (elementary cellular automaton)</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>I used <code>data.table</code> for data manipulation. The rules increase the dataset by adding new columns and using shift (lead/lag) to get the input subsets. The outcome was supposed to emphasize that each cell depends on three other cells, but I ran out of time before I got anywhere.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_02.png" class="img-fluid figure-img"></p>
<figcaption>JAN_02</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.3-make-something-human." class="level1">
<h1>JAN.3 Make something human.</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>The <code>gganatogram</code> package produces the human diagrams. <code>viridis</code> helps with color and <code>gridExtra</code> for layout. The output is accidentally oddly shaped.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_03.png" class="img-fluid figure-img"></p>
<figcaption>JAN_03</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.4-small-areas-of-symmetry." class="level1">
<h1>JAN.4 Small areas of symmetry.</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>Blackwork cross stitch serves as the basis here. The small patterns are hardcoded, and I’ll probably try generating them randomly one day.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_04.png" class="img-fluid figure-img"></p>
<figcaption>JAN_04</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.5-do-some-code-golf-how-little-code-can-you-write-to-make-something-interesting-share-the-sketch-and-its-code-together-if-you-can." class="level1">
<h1>JAN.5 Do some code golf! How little code can you write to make something interesting? Share the sketch and its code together if you can.</h1>
<blockquote class="twitter-tweet blockquote">
<p lang="en" dir="ltr">
For today’s <a href="https://twitter.com/hashtag/genuary?src=hash&amp;ref_src=twsrc%5Etfw">#genuary</a> <a href="https://twitter.com/hashtag/genuary2021?src=hash&amp;ref_src=twsrc%5Etfw">#genuary2021</a> prompt, I tried to use <a href="https://twitter.com/hashtag/rstats?src=hash&amp;ref_src=twsrc%5Etfw">#rstats</a> to recreate Georg Nees' Schotter. My goal was to get something close to the original, have the code fit in a tweet, and give base R a good shot before using other packages. Here’s what I got:
</p>
— Tyler (<span class="citation" data-cites="w_tyler_bradley">@w_tyler_bradley</span>) <a href="https://twitter.com/w_tyler_bradley/status/1346675381772955650?ref_src=twsrc%5Etfw">January 6, 2021</a>
</blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1">f<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">function</span>(i){l<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">ceiling</span>(i<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>);u<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>(l<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">-1</span>);</span>
<span id="cb1-2">t<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span>(<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">3</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">7</span>)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">45</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">runif</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>u,u))<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0174</span>;</span>
<span id="cb1-3">m<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">rnorm</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>,<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,l<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">90</span>);s<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span>.<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">707</span>;</span>
<span id="cb1-4">x<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(s<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">cos</span>(t)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>m[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>i<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">%%</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">12</span>,<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>);</span>
<span id="cb1-5">y<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">c</span>(s<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">sin</span>(t)<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span>m[<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span>]<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span>l,<span class="cn" style="color: #8f5902;
background-color: null;
font-style: inherit;">NA</span>);</span>
<span id="cb1-6"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">data.frame</span>(x,y)}</span>
<span id="cb1-7">df<span class="ot" style="color: #003B4F;
background-color: null;
font-style: inherit;">=</span><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">do.call</span>(rbind,<span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">lapply</span>(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">288</span>,f));</span>
<span id="cb1-8"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">plot</span>(<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">25</span>,<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">30</span><span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">:</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>,<span class="st" style="color: #20794D;
background-color: null;
font-style: inherit;">"n"</span>,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">ax=</span>F,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">an=</span>F,<span class="at" style="color: #657422;
background-color: null;
font-style: inherit;">as=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>);</span>
<span id="cb1-9"><span class="fu" style="color: #4758AB;
background-color: null;
font-style: inherit;">polygon</span>(df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>x,df<span class="sc" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">$</span>y)</span></code></pre></div>
</div>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_05_tweet.png" class="img-fluid figure-img"></p>
<figcaption>JAN_05</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.6-triangle-subdivision." class="level1">
<h1>JAN.6 Triangle subdivision.</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>A function subdivides the triangles but keeps the same pattern of either lightening or darkening the base color. The <code>colorspace</code> package provides the color manipulation capabilities.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_06.png" class="img-fluid figure-img"></p>
<figcaption>JAN_06</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.7-generate-some-rules-then-follow-them-by-hand-on-paper." class="level1">
<h1>JAN.7 Generate some rules, then follow them by hand on paper.</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>I didn’t do this one. I took time off because of my birthday and to keep up with the (unrelated) coup attempt.</p>
</div>
<div>
<center>
<code>NA</code>
</center>
</div>
</div>
</section>
<section id="jan.8-curve-only." class="level1">
<h1>JAN.8 Curve only.</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>Pursuit curves set up this work. Several trails of points chase after one point moving around in a circle. The <code>deSolve</code> package handles most of the math.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_08.png" class="img-fluid figure-img"></p>
<figcaption>JAN_08</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.9-interference-patterns." class="level1">
<h1>JAN.9 Interference patterns.</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p><code>ggforce</code> provides the geom for circles. I’m not sure I really get inference patterns and I feel like this was a swing and a miss from me.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_09.png" class="img-fluid figure-img"></p>
<figcaption>JAN_09</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.10-tree" class="level1">
<h1>JAN.10 // TREE</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>Code using <code>ape</code>, <code>phytools</code>, and <code>stringr</code> create and draw a random phylogenetic tree. Where parenthesizes and dashes fall in a string determine the tree’s structure.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_10.png" class="img-fluid figure-img"></p>
<figcaption>JAN_10</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.11-use-something-other-than-a-computer-as-an-autonomous-process-or-use-a-non-computer-random-source." class="level1">
<h1>JAN.11 Use something other than a computer as an autonomous process (or use a non-computer random source).</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p><a href="https://blog.cloudflare.com/lavarand-in-production-the-nitty-gritty-technical-details/">Cloudflare’s use of lava lamps for randomness</a> inspired this work. I picked a gif of a lava lamp and convert it to binary using the <code>magick</code> package.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_11.gif" class="img-fluid figure-img"></p>
<figcaption>JAN_11</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.12-use-an-api-e.g.-the-weather.-heres-a-huge-list-of-free-public-apis." class="level1">
<h1>JAN.12 Use an API (e.g.&nbsp;the weather). Here’s <a href="https://github.com/public-apis/public-apis">a huge list of free public APIs</a>.</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>I use <code>tidycensus</code>, <code>tidyverse</code>, <code>sf</code>, and <code>ggridges</code> to pull population by county, group by state/territory, average over longitude to create ridges, and center them. I tried this out in Joy Division’s Unknown Pleasures style, but it was too busy for me.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_12.png" class="img-fluid figure-img"></p>
<figcaption>JAN_12</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.13-do-not-repeat." class="level1">
<h1>JAN.13 Do not repeat.</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>I avoided repeating by basing the work on prime numbers using the <code>primes</code> package. I also used the built-in <code>as.roman()</code> function to convert numbers to Roman numerals.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_13.png" class="img-fluid figure-img"></p>
<figcaption>JAN_13</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.14-subdivision" class="level1">
<h1>JAN.14 // SUBDIVISION</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>I really struggled on this one. There are supposed to be four images colored by <code>tvthemes</code>, one for each of the Avatar: The Last Airbender nations. I couldn’t get it to work with any shape that wasn’t a square. I think the real issue is that <code>sf</code> just wasn’t built for what I was trying to do.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_14.png" class="img-fluid figure-img"></p>
<figcaption>JAN_14</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.15-let-someone-else-decide-the-general-rules-of-your-piece." class="level1">
<h1>JAN.15 Let someone else decide the general rules of your piece.</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>The rules are from the snakes and ladders board game. The code generates a random board, simulates through several players, and graphs the results. I got to use a while loop since the game doesn’t end until falling precisely on the 100th square.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_15.png" class="img-fluid figure-img"></p>
<figcaption>JAN_15</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.16-circles-only" class="level1">
<h1>JAN.16 Circles only</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>A phyllotaxis arrangement places the circles for this work. This is one of the most simple outputs but still one of my favorites. The 100 small circles repeat in the 16 sets, but sizes change based on their order modulo 16. Within each set, the locations are all the same.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_16.png" class="img-fluid figure-img"></p>
<figcaption>JAN_16</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.17-draw-a-line-pick-a-new-color-move-a-bit." class="level1">
<h1>JAN.17 Draw a line, pick a new color, move a bit.</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>The endpoints of the lines are points on two bounded random walks. I used <code>grid</code> to draw and move separately. The <code>colorspace</code> mixes colors from the endpoint locations. The <code>ragg</code> package helps with drawing over a million lines.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_17.png" class="img-fluid figure-img"></p>
<figcaption>JAN_17</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.18-one-process-grows-another-process-prunes." class="level1">
<h1>JAN.18 One process grows, another process prunes.</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>This work samplings points from several normal distributions using <code>MASS</code> for growth. Then samples from smaller normal distributions, find the closest point from the first set, and removes them. The <code>anti_join()</code> function made the pruning very easy. <code>hexbin</code> graphs the final dataset.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_18.png" class="img-fluid figure-img"></p>
<figcaption>JAN_18</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.19-increase-the-randomness-along-the-y-axis." class="level1">
<h1>JAN.19 Increase the randomness along the Y-axis.</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>I had a lot of problems with this one too. It was supposed to be based on multi-level modeling, but I couldn’t get it working and ran out of time. This one ended up as samples from t-distributions with decreasing degrees of freedom. The top one is a Cauchy distribution.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_19.png" class="img-fluid figure-img"></p>
<figcaption>JAN_19</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.20-no-loops." class="level1">
<h1>JAN.20 No loops.</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>I wanted something that looked like the code would have loops but then not actually use any. That’s not too difficult with R. The patterns are various hypotrochoids on a grid background.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_20.png" class="img-fluid figure-img"></p>
<figcaption>JAN_20</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.21-function-fx-drawx-f1-x-4-f2-x-4-f3-x-4" class="level1">
<h1>JAN.21 function f(x) { DRAW(x); f(1 * x / 4); f(2 * x / 4); f(3 * x / 4); }</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>The recursive code starts with veins growing out of the middle towards the edges of a triangle. They increase in number based on one parameter and decrease in length based on the other. If you look really closely, some lines are drawn over points instead of having all the lines drawn then points. That is done using <code>grid</code>.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_21.png" class="img-fluid figure-img"></p>
<figcaption>JAN_21</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.22-draw-a-line.-wrong-answers-only." class="level1">
<h1>JAN.22 Draw a line. Wrong answers only.</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>This isn’t a line. It’s a circle, a great circle. The additional <code>rnaturalearth</code>, <code>rnaturalearthdata</code>, and <code>geosphere</code> packages provide the data and functions. I had a lot of issues getting randomly drawn maps to look good. So there is only one. I like that it fell on New Zealand, where R originated.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_22.png" class="img-fluid figure-img"></p>
<figcaption>JAN_22</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.23-264653-2a9d8f-e9c46a-f4a261-e76f51-no-gradients.-optionally-you-can-use-a-black-or-white-background." class="level1">
<h1>JAN.23 #264653 #2a9d8f #e9c46a #f4a261 #e76f51, no gradients. Optionally, you can use a black or white background.</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>The Copperajah Pokemon is the foundation here. The colors match the prompt, and the Pokemon’s design provides the shapes. They repeat on grids based on primes numbers, but I don’t think that showed nicely.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_23.png" class="img-fluid figure-img"></p>
<figcaption>JAN_23</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.24-500-lines." class="level1">
<h1>JAN.24 500 lines.</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>This is supposed to be a drawing of my family’s dog. It’s just the head. The eyes, nose, and ears are the darker sections. I use the <code>png</code> package to read in the image and determine the path using <code>TSP</code> to solve the traveling salesman problem. The sampling of points could be a lot better, especially on the edges. Although, I’m not sure 500 lines will cut it here.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_24.png" class="img-fluid figure-img"></p>
<figcaption>JAN_24</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.25-make-a-grid-of-permutations-of-something." class="level1">
<h1>JAN.25 Make a grid of permutations of something.</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>Permutations of quadratic bézier curves provide the grid. The endpoints of each curve are separated one unit horizontally. The interior control points permute around pentagons centered on the endpoints. The change along the x-axis adjusts the first control point while the y-axis has the second. Then, additional bézier curves are created between sets on the same line to connect them nicely.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_25.png" class="img-fluid figure-img"></p>
<figcaption>JAN_25</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.26-2d-perspective." class="level1">
<h1>JAN.26 2D Perspective.</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>A Hilbert curve is given a few glitches and bent to give a 2D perspective illusion. The Hilbert curve code uses look-up tables for the rules with <code>data.table</code>.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_26.png" class="img-fluid figure-img"></p>
<figcaption>JAN_26</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.27-monochrome-gradients-without-lines." class="level1">
<h1>JAN.27 Monochrome gradients without lines.</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>The output is not monochrome because the prompt didn’t specify that at the beginning of the month. I had the tab open and never hit refresh. So I didn’t know about the update until after I finished. I like the colors from <code>katiejolly/nationalparkcolors</code> and decided to keep them. The shapes are Poisson disk sampled using <code>coolbutuseless/poissoned</code> and outlined using Voronoi diagrams from <code>ggvoronoi</code>. There are multiple layers with decreasing alpha values.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_27.png" class="img-fluid figure-img"></p>
<figcaption>JAN_27</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.28-use-sound." class="level1">
<h1>JAN.28 Use sound.</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>I used Spotify data with the <code>charlie86/spotifyr</code> package for the sound requirement. Each of the lines is a different top 50 song with parameters from their data. The <code>moldach/vapoRwave</code> package provides the colors.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_28.png" class="img-fluid figure-img"></p>
<figcaption>JAN_28</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.29-any-shape-none-can-touch." class="level1">
<h1>JAN.29 Any shape, none can touch.</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p><code>ggrepel</code> made this a pretty easy prompt. I copied the text from the Introduction to R section on the <a href="https://www.r-project.org/about.html">R website</a> for the shapes. Their locations are sampled from the R logo. The R logo image is read in and manipulated using <code>imager</code>.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_29.png" class="img-fluid figure-img"></p>
<figcaption>JAN_29</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="jan.30-replicate-a-natural-concept-e.g.-gravity-flocking-path-following." class="level1">
<h1>JAN.30 Replicate a natural concept (e.g.&nbsp;gravity, flocking, path following).</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>I finally got to use <code>rayshader</code>. This gif is supposed to replicate tides. The terrain comes from sampling font with <code>extrafont</code> combined with noise from <code>ambient</code>.</p>
</div>
<div>
<center>
<a href="https://github.com/WilliamTylerBradley/genuary2021/blob/main/JAN_30.gif">Too big to fit. So click here.</a>
</center>
</div>
</div>
</section>
<section id="jan.31-10-search-for-enos-oblique-strategies-20-obtain-one-30-that-is-your-prompt-for-today" class="level1">
<h1>JAN.31 10 SEARCH FOR “ENO’S OBLIQUE STRATEGIES” 20 OBTAIN ONE 30 THAT IS YOUR PROMPT FOR TODAY</h1>
<div style="display: grid; grid-template-columns: 1fr 1fr; align-items: center; grid-column-gap: 10px; align-items: start;">
<div>
<p>I got <a href="http://stoney.sb.org/eno/oblique.html" target="blank">‘Emphasize repetitions’</a>. This work is motivated by the repetitive act of knitting. The shading is normal error on top of an arima model that zig-zags up the y-axis.</p>
</div>
<div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_31.png" class="img-fluid figure-img"></p>
<figcaption>JAN_31</figcaption>
</figure>
</div>
</div>
</div>


</section>

 ]]></description>
  <category>R</category>
  <category>Generative Art</category>
  <guid>https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/</guid>
  <pubDate>Sun, 31 Jan 2021 05:00:00 GMT</pubDate>
  <media:content url="https://www.williamtylerbradley.com/posts/2021-01-31-genuary-2021/JAN_01.png" medium="image" type="image/png" height="230" width="144"/>
</item>
</channel>
</rss>
